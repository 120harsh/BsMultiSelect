{"version":3,"sources":["../src/BsMultiSelect.js"],"names":[],"mappings":"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","file":"BsMultiSelect.js","sourcesContent":["import $ from 'jquery'\r\nimport Popper from 'popper.js'\r\n\r\nimport {MultiSelect} from './MultiSelect'\r\nimport {LabelAdapter} from './LabelAdapter';\r\nimport {RtlAdapter} from './RtlAdapter';\r\nimport {addToJQueryPrototype} from './AddToJQueryPrototype'\r\n\r\nimport {OptionsAdapterJson, OptionsAdapterElement} from './OptionsAdapters';\r\n\r\n\r\nimport {pickContentGenerator} from './PickContentGenerator';\r\nimport {choiceContentGenerator} from './ChoiceContentGenerator';\r\nimport {staticContentGenerator} from './StaticContentGenerator';\r\n\r\nimport {bsAppearance, adjustBsOptionAdapterConfiguration, getLabelElement} from './BsAppearance';\r\nimport {ValidityApi} from './ValidityApi'\r\n\r\nimport {createCss, extendCss} from './ToolsStyling';\r\nimport {extendOverriding, extendIfUndefined, sync, ObservableValue, ObservableLambda} from './ToolsJs';\r\n\r\nimport {adjustLegacyConfiguration as adjustLegacySettings} from './BsMultiSelectDepricatedParameters'\r\n\r\nimport {css, cssPatch} from './BsCss'\r\n\r\n\r\nfunction extendConfigurtion(configuration, defaults){\r\n    let cfgCss = configuration.css;\r\n    let cfgCssPatch = configuration.cssPatch;\r\n    configuration.css = null;\r\n    configuration.cssPatch = null;\r\n    extendIfUndefined(configuration, defaults); \r\n    var defCss = createCss(defaults.css, cfgCss); // replace classes, merge styles\r\n    if (defaults.cssPatch instanceof Boolean || typeof defaults.cssPatch ===\"boolean\" \r\n        || cfgCssPatch instanceof Boolean || typeof cfgCssPatch===\"boolean\" \r\n    )\r\n    throw new Error(\"BsMultiSelect: 'cssPatch' was used instead of 'useCssPatch'\") // often type of error\r\n    var defCssPatch = createCss(defaults.cssPatch, cfgCssPatch); // ? classes, merge styles\r\n    configuration.css = defCss;\r\n    configuration.cssPatch = defCssPatch;\r\n}\r\n\r\n(\r\n    (window, $, Popper) => {\r\n        var defaults = {\r\n            useCssPatch : true,\r\n            containerClass : \"dashboardcode-bsmultiselect\",\r\n            css: css,\r\n            cssPatch: cssPatch,\r\n            placeholder: '',\r\n            staticContentGenerator : staticContentGenerator,\r\n            getLabelElement: getLabelElement,\r\n            pickContentGenerator: pickContentGenerator,\r\n            choiceContentGenerator : choiceContentGenerator,\r\n\r\n            buildConfiguration: null,\r\n            setSelected: (option, value) => {option.selected = value; },\r\n            required: null, /* means look on select[required] or false */\r\n            optionsAdapter: null,\r\n            options: null,\r\n            getDisabled: null,\r\n            getSize: null,\r\n            getValidity: null\r\n        };\r\n\r\n        // Create our shared stylesheet:\r\n        // const sheet = new CSSStyleSheet();\r\n        // sheet.replaceSync('#target {color: darkseagreen}');\r\n        // document.adoptedStyleSheets = [sheet];\r\n\r\n        function createPlugin(element, settings, onDispose){\r\n\r\n            if (typeof Popper === 'undefined') {\r\n                throw new Error(\"BsMultiSelect: Popper.js (https://popper.js.org) is required\")\r\n            }\r\n    \r\n            let configuration = {};\r\n            let init = null;\r\n            if (settings instanceof Function){\r\n                extendConfigurtion(configuration, defaults);\r\n                init = settings(element, configuration);\r\n            }\r\n            else\r\n            { \r\n                if (settings){\r\n                    adjustLegacySettings(settings);            \r\n                    extendOverriding(configuration, settings); // settings used per jQuery intialization, configuration per element\r\n                }\r\n                extendConfigurtion(configuration, defaults);\r\n            }\r\n            \r\n            if (configuration.buildConfiguration)\r\n                init = configuration.buildConfiguration(element, configuration);\r\n            var css = configuration.css;\r\n\r\n            var useCssPatch = configuration.useCssPatch;\r\n            var putRtlToContainer=false; \r\n            if (useCssPatch)\r\n                extendCss(css, configuration.cssPatch); \r\n            if (configuration.isRtl===undefined || configuration.isRtl===null)\r\n                configuration.isRtl = RtlAdapter(element);\r\n            else if (configuration.isRtl===true)\r\n                putRtlToContainer=true;\r\n\r\n            let staticContent = configuration.staticContentGenerator(\r\n                element, name=>window.document.createElement(name), configuration.containerClass, putRtlToContainer, css\r\n            );\r\n            \r\n            if (configuration.required === null)\r\n                    configuration.required = staticContent.required;\r\n\r\n            var trigger = function(eventName){\r\n                $(element).trigger(eventName);\r\n            }\r\n\r\n            let optionsAdapter = configuration.optionsAdapter;\r\n            let lazyDefinedEvent;\r\n            if (!optionsAdapter)\r\n            {\r\n                if (configuration.options){\r\n                    optionsAdapter = OptionsAdapterJson(\r\n                        configuration.options,\r\n                        configuration.getDisabled,\r\n                        configuration.getSize,\r\n                        configuration.getValidity,\r\n                        ()=>{\r\n                            lazyDefinedEvent()\r\n                            trigger('dashboardcode.multiselect:change')\r\n                        }\r\n                    );\r\n                } \r\n                else  \r\n                {\r\n                    adjustBsOptionAdapterConfiguration(\r\n                        configuration,\r\n                        staticContent.selectElement\r\n                    )\r\n                    optionsAdapter = OptionsAdapterElement(\r\n                        staticContent.selectElement, \r\n                        configuration.getDisabled, \r\n                        configuration.getSize, \r\n                        configuration.getValidity, \r\n                        ()=>{\r\n                            lazyDefinedEvent()\r\n                            trigger('change')\r\n                            trigger('dashboardcode.multiselect:change')\r\n                        }\r\n                    );\r\n                }\r\n            }\r\n\r\n            var getCount =()=>{\r\n                var count = 0;\r\n                var options = optionsAdapter.getOptions();\r\n                for (var i=0; i < options.length; i++) {\r\n                    if (options[i].selected) count++;\r\n                }\r\n                return count;\r\n            }\r\n            var isValueMissingObservable = ObservableLambda(()=>configuration.required && getCount()===0);\r\n            var validityApiObservable = ObservableValue(!isValueMissingObservable.getValue())\r\n            lazyDefinedEvent = () => isValueMissingObservable.call();\r\n            \r\n\r\n            //if (useCssPatch)\r\n            //    pushIsValidClassToPicks(staticContent, css);\r\n\r\n            let labelAdapter = LabelAdapter(configuration.labelElement, staticContent.createInputId);\r\n\r\n            if (!configuration.placeholder)\r\n            {\r\n                configuration.placeholder = $(element).data(\"bsmultiselect-placeholder\");\r\n                if (!configuration.placeholder)\r\n                    configuration.placeholder = $(element).data(\"placeholder\");\r\n            }\r\n            \r\n            var valueMissingMessage = \"Please select an item in the list\";\r\n            if (configuration.valueMissingMessage)\r\n                valueMissingMessage = configuration.valueMissingMessage;\r\n\r\n            \r\n            var validityApi = ValidityApi(\r\n                staticContent.filterInputElement, \r\n                isValueMissingObservable, \r\n                valueMissingMessage,\r\n                (isValid)=>validityApiObservable.setValue(isValid));\r\n\r\n            //var setSelected = configuration.setSelected;\r\n            // if (configuration.required){\r\n            //     var preSetSelected = configuration.setSelected;\r\n            //     var setValidityForRequired = ()=>{\r\n            //         if (configuration.getCount()===0) {\r\n            //             staticContent.filterInputElement.setCustomValidity(\"Please select an item in the list\");\r\n            //         } else {\r\n            //             staticContent.filterInputElement.setCustomValidity(\"\");\r\n            //         }\r\n            //     }\r\n            //     setValidityForRequired();\r\n            //     setSelected = (option, value)=>{\r\n            //         var success = preSetSelected(option, value);\r\n            //         //console.log(\"setSelected success\" + success);\r\n            //         if (success!==false)\r\n            //         { \r\n            //             setValidityForRequired()\r\n            //         }\r\n            //         return success;\r\n            //     }\r\n            // } \r\n\r\n\r\n            \r\n            // var setSelectedWithChangedEvent =  (option, value) => {\r\n            //     var success = setSelected(option, value);\r\n            //     if (success!==false)\r\n            //         changed();\r\n            //     return success;\r\n            // }\r\n\r\n            var multiSelect = new MultiSelect(\r\n                optionsAdapter,\r\n                configuration.setSelected,\r\n                staticContent,\r\n                (pickElement) => configuration.pickContentGenerator(pickElement, css),\r\n                (choiceElement) => configuration.choiceContentGenerator(choiceElement, css),\r\n                labelAdapter,\r\n                configuration.placeholder,\r\n                configuration.isRtl,\r\n                css,\r\n                Popper,\r\n                window);\r\n            \r\n            multiSelect.onDispose = ()=> sync(isValueMissingObservable.detachAll, validityApiObservable.detachAll, onDispose);\r\n            \r\n            multiSelect.validity = validityApi;\r\n            \r\n            bsAppearance(\r\n                multiSelect, staticContent,  optionsAdapter,\r\n                validityApiObservable,\r\n                useCssPatch, \r\n                //wasUpdatedObservable, validationObservable, getManualValidationObservable, update, \r\n                css);\r\n            \r\n            if (init && init instanceof Function)\r\n                init(multiSelect);\r\n            \r\n            multiSelect.init();\r\n\r\n            return multiSelect;\r\n        }\r\n        addToJQueryPrototype('BsMultiSelect', createPlugin, defaults, $);\r\n    }\r\n)(window, $, Popper)\r\n"]}