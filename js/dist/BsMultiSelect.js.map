{"version":3,"sources":["../src/BsMultiSelect.js"],"names":[],"mappings":"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","file":"BsMultiSelect.js","sourcesContent":["import {MultiSelect} from './MultiSelect'\r\nimport {PluginManager, staticDomDefaults} from './PluginManager'\r\n\r\nimport {composeSync, def} from './ToolsJs';\r\n\r\nimport {pickContentGenerator as defPickContentGenerator} from './PickContentGenerator';\r\nimport {choiceContentGenerator as defChoiceContentGenerator} from './ChoiceContentGenerator';\r\n\r\nimport {StaticDomFactory} from './StaticDomFactory';\r\n\r\nimport {PicksDom} from './PicksDom';\r\nimport {ChoicesDom} from './ChoicesDom';\r\nimport {PopupAspect as DefaultPopupAspect} from './PopupAspect';\r\n\r\nimport {ComponentAspect} from './ComponentAspect';\r\nimport {DataSourceAspect} from './DataSourceAspect';\r\n\r\nimport {DoublyLinkedCollection} from './ToolsJs'\r\n\r\nimport {FilterListAspect, ChoicesGetNextAspect, ChoicesEnumerableAspect } from './FilterListAspect'\r\nimport {ChoicesElementAspect, ChoiceFactoryAspect, ChoicesAspect } from './ChoicesAspect'\r\n\r\n\r\nimport {OptionToggleAspect, OptionAspect} from './OptionAspect.js'\r\nimport {Choices} from './Choices'\r\nimport {ChoicesHover} from './ChoicesHover'\r\nimport {Picks} from './Picks'\r\n\r\nexport function BsMultiSelect(element, environment, configuration, onInit){\r\n    var {Popper, window, plugins} = environment;\r\n    var trigger = (eventName)=> environment.trigger(element, eventName);\r\n    if (typeof Popper === 'undefined') {\r\n        throw new Error(\"BsMultiSelect: Popper.js (https://popper.js.org) is required\")\r\n    }\r\n\r\n    let { containerClass, css, \r\n          options, getDisabled,  \r\n          getSelected, setSelected, \r\n          getIsOptionDisabled, common } = configuration;\r\n    \r\n    if (!common) \r\n        common = {}\r\n\r\n    let dataSourceAspect = DataSourceAspect(options, getSelected, setSelected, getIsOptionDisabled); \r\n    let componentAspect  = ComponentAspect(getDisabled, trigger);\r\n    common.getDisabled = componentAspect.getDisabled;\r\n          \r\n    let PopupAspect = def(configuration.staticContentGenerator, DefaultPopupAspect); // TODO: rename configuration.staticContentGenerator\r\n    let createElement =  name=>window.document.createElement(name);\r\n    \r\n    let choicesDom = ChoicesDom(createElement, css);\r\n    let staticDomFactory = StaticDomFactory(createElement, choicesDom.choicesElement);\r\n    staticDomDefaults(plugins, staticDomFactory); // manipulates with staticDomFactory.staticDomGenerator\r\n   \r\n    let {staticDom, staticManager} = staticDomFactory.staticDomGenerator(element, containerClass)\r\n    // TODO get picksDom  from staticDomFactory\r\n    let picksDom  = PicksDom(staticDom.picksElement, staticDom.disposablePicksElement, createElement, css);\r\n    let popupAspect = PopupAspect(choicesDom.choicesElement, picksDom.filterInputElement, Popper);\r\n\r\n    let collection = DoublyLinkedCollection(\r\n        (choice)=>choice.itemPrev, \r\n        (choice, v)=>choice.itemPrev=v, \r\n        (choice)=>choice.itemNext, \r\n        (choice, v)=>choice.itemNext=v, \r\n    );\r\n\r\n    \r\n\r\n    let choicesGetNextAspect = ChoicesGetNextAspect(\r\n        ()=>collection.getHead(),\r\n        (choice)=>choice.itemNext\r\n    )\r\n\r\n    let choicesEnumerableAspect = ChoicesEnumerableAspect(\r\n        choicesGetNextAspect\r\n    )\r\n\r\n    let filterListAspect = FilterListAspect(choicesGetNextAspect, choicesEnumerableAspect); \r\n\r\n    // TODO move to fully index collection\r\n    let choices = Choices(\r\n        collection,\r\n        ()=>filterListAspect.filterListFacade_reset(), \r\n        (c)=>filterListAspect.filterListFacade_remove(c),\r\n        (c)=>filterListAspect.addFilterFacade(c), \r\n        (c)=>filterListAspect.insertFilterFacade(c));\r\n    \r\n    let choicesHover = ChoicesHover((down, hoveredChoice)=>filterListAspect.navigate(down, hoveredChoice));\r\n\r\n    let picks = Picks();\r\n\r\n    let optionAspect = OptionAspect(dataSourceAspect)\r\n    let optionToggleAspect = OptionToggleAspect(optionAspect)\r\n\r\n    let choiceContentGenerator = def(configuration.choiceContentGenerator, defChoiceContentGenerator);\r\n\r\n    let choicesElementAspect = ChoicesElementAspect( choicesDom, (choiceElement, toggle) => choiceContentGenerator(choiceElement, common, css, toggle), componentAspect, optionToggleAspect)\r\n    let choiceFactoryAspect =  ChoiceFactoryAspect(choicesElementAspect, choicesGetNextAspect);\r\n    let choicesAspect = ChoicesAspect(window.document, optionAspect, dataSourceAspect, choices, choiceFactoryAspect);\r\n\r\n    let pluginData = {environment, trigger, configuration, dataSourceAspect, componentAspect, \r\n        staticDom, picksDom, choicesDom, popupAspect, staticManager, \r\n        choicesGetNextAspect, choicesEnumerableAspect, filterListAspect, choices, choicesHover, picks,\r\n        optionAspect, optionToggleAspect,\r\n        choicesElementAspect, choiceFactoryAspect, choicesAspect,\r\n        common\r\n    } \r\n    \r\n    \r\n    \r\n    // TODO: replace common with something new? \r\n    let pluginManager = PluginManager(plugins, pluginData);\r\n\r\n    let pickContentGenerator = def(configuration.pickContentGenerator, defPickContentGenerator);\r\n \r\n\r\n    var multiSelect = new MultiSelect(\r\n        dataSourceAspect,\r\n        componentAspect,\r\n        picksDom,\r\n        choicesDom,\r\n        staticManager,\r\n        popupAspect,        \r\n        (pickElement) => pickContentGenerator(pickElement, common, css),\r\n        //choicesGetNextAspect,\r\n        filterListAspect,\r\n        choices, \r\n        choicesHover,\r\n        picks,\r\n        optionAspect,\r\n        optionToggleAspect,\r\n        //choicesElementAspect, choiceFactoryAspect, \r\n        choicesAspect,\r\n        window\r\n    );\r\n\r\n    pluginManager.afterConstructor(multiSelect);\r\n\r\n    multiSelect.dispose = composeSync(pluginManager.dispose, multiSelect.dispose.bind(multiSelect), staticManager.dispose, popupAspect.dispose, picksDom.dispose );\r\n    \r\n    onInit?.(multiSelect);\r\n   \r\n    multiSelect.init();\r\n    multiSelect.load();\r\n    return multiSelect;\r\n}"]}