{"version":3,"sources":["../src/BsMultiSelect.js"],"names":[],"mappings":"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","file":"BsMultiSelect.js","sourcesContent":["import {MultiSelect} from './MultiSelect'\r\nimport {PluginManager} from './PluginManager'\r\n\r\nimport {getDataGuardedWithPrefix, closestByTagName /*, getIsRtl*/} from './ToolsDom';\r\n\r\nimport {createCss, extendCss} from './ToolsStyling';\r\nimport {extendOverriding, extendIfUndefined, composeSync, def , isBoolean, isObject} from './ToolsJs';\r\n\r\nimport {adjustLegacySettings} from './BsMultiSelectDepricatedParameters'\r\n\r\nimport {pickContentGenerator as defPickContentGenerator} from './PickContentGenerator';\r\nimport {choiceContentGenerator as defChoiceContentGenerator} from './ChoiceContentGenerator';\r\nimport {staticContentGenerator  as defStaticContentGenerator} from './StaticContentGenerator';\r\nimport {css} from './BsCss'\r\n\r\nexport const defaults = {\r\n    useCssPatch : true,\r\n    containerClass : \"dashboardcode-bsmultiselect\",\r\n    css: css,\r\n}\r\n\r\nexport function initiateDefaults(constructors){\r\n    for(let i = 0; i<constructors.length; i++){\r\n        constructors[i].setDefaults?.(defaults)\r\n    }\r\n}\r\n\r\nexport function BsMultiSelect(element, environment, settings){\r\n    var {Popper, window, plugins} = environment;\r\n    var trigger = (eventName)=> environment.trigger(element, eventName);\r\n    if (typeof Popper === 'undefined') {\r\n        throw new Error(\"BsMultiSelect: Popper.js (https://popper.js.org) is required\")\r\n    }\r\n\r\n    let configuration = {};\r\n    if (isObject(settings)){\r\n        adjustLegacySettings(settings);            \r\n        extendOverriding(configuration, settings); // settings used per jQuery intialization, configuration per element\r\n    }\r\n    \r\n    let cfgCss = configuration.css;\r\n    configuration.css = null;\r\n    let cfgCssPatch = configuration.cssPatch;\r\n    configuration.cssPatch = null;\r\n    extendIfUndefined(configuration, defaults); // copy 1st level of properties\r\n\r\n    var defCss = createCss(defaults.css, cfgCss); // replace classes, merge styles\r\n    configuration.css = defCss;\r\n\r\n    if (isBoolean(defaults.cssPatch) || isBoolean(cfgCssPatch))\r\n        throw new Error(\"BsMultiSelect: 'cssPatch' was used instead of 'useCssPatch'\") // often type of error\r\n    var defCssPatch = createCss(defaults.cssPatch, cfgCssPatch); // replace classes, merge styles\r\n    configuration.cssPatch = defCssPatch;\r\n\r\n    let init = null;\r\n    if ( settings instanceof Function) \r\n        init = settings(element, configuration);\r\n    else if (configuration.buildConfiguration)\r\n        init = configuration.buildConfiguration(element, configuration);\r\n    \r\n    let { css, cssPatch, useCssPatch,\r\n          containerClass, \r\n          getSelected, setSelected, placeholder, \r\n          common,\r\n          options, getDisabled,\r\n          getIsOptionDisabled\r\n        } = configuration;\r\n\r\n    // TODO move to plugin\r\n    if (useCssPatch){\r\n        extendCss(css, cssPatch); \r\n    }\r\n    \r\n    let staticContentGenerator = def(configuration.staticContentGenerator, defStaticContentGenerator);\r\n    let pickContentGenerator = def(configuration.pickContentGenerator, defPickContentGenerator);\r\n    let choiceContentGenerator = def(configuration.choiceContentGenerator, defChoiceContentGenerator);\r\n\r\n    let staticContent = staticContentGenerator(\r\n        element, name=>window.document.createElement(name), containerClass, css\r\n    );\r\n\r\n    if (!common){\r\n        common = {}\r\n    }\r\n    let pluginData = {window, configuration, staticContent, common} // TODO replace common with staticContent (but staticContent should be splitted)\r\n    let pluginManager = PluginManager(plugins, pluginData);\r\n\r\n    let onChange;\r\n    let getOptions;\r\n    \r\n    if (options){\r\n        if (!getDisabled)\r\n            getDisabled = () => false;\r\n        getOptions = () => options;\r\n        onChange = () => {\r\n            trigger('dashboardcode.multiselect:change')\r\n        }\r\n        \r\n        if (!getIsOptionDisabled)\r\n            getIsOptionDisabled = option => (option.disabled===undefined) ? false : option.disabled;\r\n    } \r\n    else  \r\n    {\r\n        let selectElement = staticContent.selectElement;\r\n        if(!getDisabled){\r\n            var fieldsetElement = closestByTagName(selectElement, 'FIELDSET');\r\n            if (fieldsetElement) {\r\n                getDisabled = () => selectElement.disabled || fieldsetElement.disabled;\r\n            } else {\r\n                getDisabled = () => selectElement.disabled;\r\n            }\r\n        } \r\n\r\n        getOptions = () => selectElement.options; \r\n        onChange = () => {\r\n            trigger('change')\r\n            trigger('dashboardcode.multiselect:change')\r\n        }\r\n\r\n        if (!getIsOptionDisabled)\r\n            getIsOptionDisabled = option => option.disabled;\r\n    }\r\n\r\n    if (!placeholder){\r\n        placeholder = getDataGuardedWithPrefix(element,\"bsmultiselect\",\"placeholder\");\r\n    }\r\n    if (!getSelected){\r\n        getSelected = (option) => option.selected;\r\n    }\r\n    if (!setSelected){\r\n        setSelected = (option, value) => {option.selected = value};\r\n        // NOTE: adding this break Chrome's form reset functionality\r\n        // if (value) option.setAttribute('selected','');\r\n        // else  option.removeAttribute('selected');\r\n    }\r\n\r\n    common.getDisabled = getDisabled;\r\n\r\n    var multiSelect = new MultiSelect(\r\n        getOptions,\r\n        getDisabled,\r\n        setSelected,\r\n        getSelected,\r\n        getIsOptionDisabled,\r\n        staticContent,\r\n        (pickElement) => pickContentGenerator(pickElement, common, css),\r\n        (choiceElement, toggle) => choiceContentGenerator(choiceElement, common, css, toggle),\r\n        placeholder,\r\n        onChange,\r\n        css,\r\n        Popper,\r\n        window);\r\n\r\n    pluginManager.afterConstructor(multiSelect);\r\n\r\n    multiSelect.Dispose = composeSync(pluginManager.dispose, multiSelect.Dispose.bind(multiSelect));\r\n    \r\n    if (init && init instanceof Function)\r\n        init(multiSelect);\r\n   \r\n    multiSelect.init();\r\n    multiSelect.load();\r\n\r\n    // support browser's \"step backward\" on form restore\r\n    if (staticContent.selectElement && window.document.readyState !=\"complete\"){\r\n        window.setTimeout( function(){multiSelect.UpdateOptionsSelected()});\r\n    }\r\n\r\n    return multiSelect;\r\n}"]}