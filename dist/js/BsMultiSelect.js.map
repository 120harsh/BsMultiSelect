{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/ToolsJs.js","../../js/src/ToolsDom.js","../../js/src/FilterPanel.js","../../js/src/ChoicesPanel.js","../../js/src/PicksPanel.js","../../js/src/MultiSelectInputAspect.js","../../js/src/PlaceholderAspect.js","../../js/src/EventSkipper.js","../../js/src/MultiSelect.js","../../js/src/LabelAdapter.js","../../js/src/AddToJQueryPrototype.js","../../js/src/OptionsAdapters.js","../../js/src/StylingCorrector.js","../../js/src/Styling.js","../../js/src/BsPickContentGenerator.js","../../js/src/BsChoiceContentGenerator.js","../../js/src/ContainerAdapter.js","../../js/src/BsAppearance.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["export function extendIfUndefined(destination, source) {\r\n    for (var property in source)\r\n        if (destination[property] === undefined)\r\n            destination[property] = source[property];\r\n}\r\n\r\nexport function createEmpty(source, value) {\r\n    var destination={};\r\n    for (var property in source)\r\n         destination[property] = value;\r\n    return destination;\r\n}\r\n\r\nfunction forEachRecursion(f, i){\r\n    if (!i)\r\n        return;\r\n    f(i.value); \r\n    forEachRecursion(f, i.prev);\r\n};\r\n\r\nexport function List(){\r\n    var tail = null;\r\n    var count = 0;\r\n    return {\r\n        add(e){\r\n            if (tail){\r\n                tail.next = {value:e , prev:tail};\r\n                tail = tail.next;\r\n            } else \r\n                tail = {value:e}\r\n            count++;\r\n            let node = tail;\r\n            function remove(){\r\n                if (node.prev){\r\n                    (node.prev).next = node.next;\r\n                }\r\n                if (node.next){\r\n                    (node.next).prev = node.prev;\r\n                }\r\n                if (tail == node){\r\n                    tail = node.prev;\r\n                }\r\n                count--;\r\n            }\r\n            return remove;\r\n        },\r\n        forEach(f){\r\n            forEachRecursion(f,tail);\r\n        },\r\n        getTail(){return (tail)?tail.value:null},\r\n        getCount(){return count},\r\n        isEmpty(){return count==0},\r\n        reset(){tail=null;count=0;}\r\n    }\r\n}","export function removeElement(e) {e.parentNode.removeChild(e)}\r\n\r\nexport function findDirectChildByTagName(element, tagName){\r\n    var returnValue = null;\r\n    for (var i = 0; i<element.children.length; i++)\r\n    {\r\n        let tmp = element.children[i];\r\n        if (tmp.tagName==tagName)\r\n        {\r\n            returnValue = tmp;\r\n            break;\r\n        }\r\n    }\r\n    return returnValue;\r\n}\r\n\r\nexport function addClass(element, c){\r\n    element.classList.add(c);\r\n}\r\n\r\nexport function removeClass(element, c){\r\n    element.classList.remove(c);\r\n}\r\n\r\nexport function addClasses(element, classes){\r\n    modifyClasses(classes, e=>addClass(element,e))\r\n}\r\n\r\nexport function removeClasses(element, classes){\r\n    modifyClasses(classes, e=>removeClass(element,e))\r\n}\r\n\r\nexport function setStyles(element, styles){\r\n    for (var property in styles)\r\n        element.style[property] = styles[property];\r\n}\r\n\r\nfunction modifyClasses(classes, modify){\r\n    if (classes){\r\n        if (Array.isArray(classes))\r\n            classes.forEach(e => modify(e))\r\n        else{\r\n            var array = classes.split(\" \");\r\n            array.forEach(e => modify(e))\r\n        }\r\n    }\r\n}\r\n\r\nexport function removeChildren(element){\r\n    var toRemove = element.firstChild;\r\n    while( toRemove ) {\r\n        element.removeChild( toRemove );\r\n        toRemove = element.firstChild;\r\n    }\r\n}\r\n\r\nexport function EventBinder(){\r\n    var list = [];\r\n    return {\r\n        bind(element, eventName, handler){\r\n            element.addEventListener(eventName, handler)\r\n            list.push( {element, eventName, handler} )\r\n        },\r\n        unbind(){\r\n            list.forEach( e=>\r\n            {\r\n                let {element, eventName, handler}=e;\r\n                element.removeEventListener(eventName, handler)\r\n            })\r\n        }\r\n    }\r\n}\r\n","import {setStyles} from './ToolsDom';\r\n\r\nconst filterInputStyle = {border:'0px', height: 'auto', boxShadow:'none', \r\n    padding:'0px', margin:'0px', outline:'none', backgroundColor:'transparent' };\r\n\r\nexport function FilterPanel(\r\n        createElement,\r\n        insertIntoDom,\r\n        onFocusIn,  // show dropdown\r\n        onFocusOut, // hide dropdown\r\n        onKeyDownArrowUp, \r\n        onKeyDownArrowDown,\r\n        onTabForEmpty,  // tab on empty\r\n        onBackspace, // backspace alike\r\n        onEnterOrTabToCompleate, // \"compleate alike\"\r\n        onKeyDownEsc, \r\n        onKeyUpEsc, // \"esc\" alike\r\n        onInput, // filter\r\n        setEmptyLength\r\n    ) {\r\n    \r\n    var filterInputElement = createElement('INPUT'); \r\n    \r\n    filterInputElement.setAttribute(\"type\",\"search\");\r\n    filterInputElement.setAttribute(\"autocomplete\",\"off\");\r\n\r\n    setStyles(filterInputElement, filterInputStyle);\r\n\r\n    insertIntoDom(filterInputElement);\r\n\r\n    var onfilterInputKeyDown = (event) => {\r\n        if ([38, 40, 13 ,27].indexOf(event.which)>=0 \r\n            || (event.which == 9 && filterInputElement.value) ) {\r\n            event.preventDefault(); \r\n            // preventDefault for tab(9) it enables keyup,\r\n            // prevent form default button (13-enter) \r\n            // but doesn't help with bootsrap modal ESC or ENTER (close behaviour);\r\n            // esc(27) there is just in case\r\n        }\r\n        if (event.which == 27 ) {\r\n            onKeyDownEsc(filterInputElement.value?false:true, event); // support BS do not close modal - event.stopPropagation inside\r\n        }\r\n        else if (event.which == 38) {\r\n            onKeyDownArrowUp();\r\n        }\r\n        else if (event.which == 40) {\r\n            onKeyDownArrowDown();\r\n        }\r\n        else if (event.which == 9  /*tab*/) { // no keydown for this\r\n            if (!filterInputElement.value) {\r\n                 onTabForEmpty(); // filter is empty, nothing to reset\r\n            }\r\n        }\r\n        else if (event.which == 8 /*backspace*/) {\r\n            // NOTE: this will process backspace only if there are no text in the input field\r\n            // If user will find this inconvinient, we will need to calculate something like this\r\n            // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n            if (!filterInputElement.value)\r\n            { \r\n                onBackspace();\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n    \r\n    var onFilterInputKeyUp = (event) => {\r\n        if (event.which == 13 || event.which == 9) {\r\n            onEnterOrTabToCompleate();\r\n        }\r\n        else if (event.which == 27) { // escape\r\n            onKeyUpEsc(); // is it always empty (bs x can still it) \r\n        }\r\n    }\r\n    \r\n    // it can be initated by 3PP functionality\r\n    // sample (1) BS functionality - input x button click - clears input\r\n    // sample (2) BS functionality - esc keydown - clears input\r\n    // and there could be difference in processing: (2) should hide the menu, then reset , when (1) should just reset without hiding.\r\n    var onFilterInputInput = () => {\r\n        var filterInputValue = filterInputElement.value;\r\n        onInput(\r\n            filterInputValue, \r\n            ()=> filterInputElement.style.width = filterInputValue.length*1.3 + 2 + \"ch\"\r\n        );\r\n    }\r\n    \r\n    filterInputElement.addEventListener('focusin', onFocusIn);\r\n    filterInputElement.addEventListener('focusout', onFocusOut);\r\n    filterInputElement.addEventListener('keydown', onfilterInputKeyDown);    \r\n    filterInputElement.addEventListener('keyup', onFilterInputKeyUp);\r\n    filterInputElement.addEventListener('input', onFilterInputInput);\r\n\r\n    // function setEmptyLength(){\r\n    //     inputElement.style.width= \"100%\"; //--\"1rem\";\r\n    // }\r\n    //setEmptyLength();\r\n\r\n    function setEmpty(){\r\n        filterInputElement.value ='';\r\n        setEmptyLength();\r\n    };\r\n    \r\n    return {\r\n        filterInputElement,\r\n        isEmpty(){\r\n            return filterInputElement.value ? false:true;\r\n        },\r\n        setEmpty,\r\n        setEmptyLength,\r\n        setFocus(){\r\n            filterInputElement.focus();\r\n        },\r\n        isEventTarget(event){\r\n            return event.target == filterInputElement;\r\n        },\r\n        dispose(){\r\n            filterInputElement.removeEventListener('focusin', onFocusIn);\r\n            filterInputElement.removeEventListener('focusout', onFocusOut);\r\n            filterInputElement.removeEventListener('keydown', onfilterInputKeyDown);\r\n            filterInputElement.removeEventListener('keyup', onFilterInputKeyUp);\r\n            filterInputElement.removeEventListener('input', onFilterInputInput);\r\n        }\r\n    }\r\n}","import {setStyles} from './ToolsDom';\r\n\r\nconst choicesStyle = {listStyleType:'none'}; // remove bullets since this is ul\r\n\r\nexport function ChoicesPanel(createElement, choicesElement, onShow, onHide, eventSkipper, choiceContentGenerator, \r\n        getVisibleMultiSelectDataList, \r\n        resetFilter, updateChoicesLocation, filterPanelSetFocus) {\r\n    \r\n    // prevent heavy understandable styling error\r\n    setStyles(choicesElement, choicesStyle);\r\n    var hoveredMultiSelectData=null;\r\n    var hoveredMultiSelectDataIndex = null;\r\n    var candidateToHoveredMultiSelectData=null;\r\n\r\n    function hideChoices() {\r\n        if (candidateToHoveredMultiSelectData){\r\n            resetCandidateToHoveredMultiSelectData();\r\n        }\r\n        if (choicesElement.style.display != 'none')\r\n        {\r\n            choicesElement.style.display = 'none';\r\n            onHide();\r\n        }\r\n    }\r\n\r\n    function showChoices() {\r\n        if (choicesElement.style.display != 'block')\r\n        {\r\n            eventSkipper.setSkippable();\r\n            choicesElement.style.display = 'block';\r\n            onShow();\r\n        }\r\n    }\r\n\r\n    var hoverInInternal = function(index){\r\n        hoveredMultiSelectDataIndex = index;\r\n        hoveredMultiSelectData = getVisibleMultiSelectDataList()[index];\r\n        hoveredMultiSelectData.ChoiceContent.hoverIn()\r\n    }\r\n\r\n    function resetChoicesHover() {\r\n        if (hoveredMultiSelectData) {\r\n            hoveredMultiSelectData.ChoiceContent.hoverOut()\r\n            hoveredMultiSelectData = null;\r\n            hoveredMultiSelectDataIndex = null;\r\n        }\r\n    }\r\n\r\n    var resetCandidateToHoveredMultiSelectData = function(){\r\n        candidateToHoveredMultiSelectData.choiceElement.removeEventListener('mousemove', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData.choiceElement.removeEventListener('mousedown', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData = null;\r\n    }\r\n\r\n    var processCandidateToHovered = function() {\r\n        if (hoveredMultiSelectData != candidateToHoveredMultiSelectData)\r\n        {\r\n            resetChoicesHover(); \r\n            hoverInInternal(candidateToHoveredMultiSelectData.visibleIndex);\r\n        }\r\n        if(candidateToHoveredMultiSelectData) \r\n            resetCandidateToHoveredMultiSelectData();\r\n    }\r\n\r\n    function toggleHovered(){\r\n        if (hoveredMultiSelectData) {\r\n            hoveredMultiSelectData.toggle();\r\n            resetChoicesHover();\r\n            hideChoices(); // always hide 1st\r\n            resetFilter();\r\n        } \r\n    }\r\n\r\n    function keyDownArrow(down) {\r\n        let visibleMultiSelectDataList = getVisibleMultiSelectDataList();\r\n        let length = visibleMultiSelectDataList.length;\r\n        let newIndex=null;\r\n        if (length > 0) {\r\n            if (down) {\r\n                let i = hoveredMultiSelectDataIndex==null?0:hoveredMultiSelectDataIndex+1;\r\n                while(i<length){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i++;\r\n                }\r\n            } else {\r\n                let i = hoveredMultiSelectDataIndex==null?length-1:hoveredMultiSelectDataIndex-1;\r\n                while(i>=0){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        \r\n        if (newIndex!=null)\r\n        {\r\n            if (hoveredMultiSelectData)\r\n                hoveredMultiSelectData.ChoiceContent.hoverOut()\r\n                // styling.HoverOut(hoveredMultiSelectData.choiceElement);\r\n            updateChoicesLocation();\r\n            showChoices(); \r\n            hoverInInternal(newIndex);\r\n        }\r\n    }\r\n\r\n    var onChoiceElementMouseoverGeneral = function(MultiSelectData, choiceElement)\r\n    {\r\n        if (eventSkipper.isSkippable())\r\n        {\r\n            if(candidateToHoveredMultiSelectData)\r\n                resetCandidateToHoveredMultiSelectData()\r\n\r\n            candidateToHoveredMultiSelectData = MultiSelectData;\r\n            choiceElement.addEventListener('mousemove', processCandidateToHovered);\r\n            choiceElement.addEventListener('mousedown', processCandidateToHovered);\r\n        }\r\n        else\r\n        {\r\n            if (hoveredMultiSelectData!=MultiSelectData)\r\n            {\r\n                // mouseleave is not enough to guarantee remove hover styles in situations\r\n                // when style was setuped without mouse (keyboard arrows)\r\n                // therefore force reset manually\r\n                resetChoicesHover(); \r\n                hoverInInternal(MultiSelectData.visibleIndex);\r\n            }                \r\n        }\r\n    }\r\n\r\n    function insertChoice(MultiSelectData, createSelectedItemGen, setSelected, triggerChange, isSelected/*, isOptionDisabled*/) {\r\n        var choiceElement = createElement('LI');\r\n        \r\n        // in chrome it happens on \"become visible\" so we need to skip it, \r\n        // for IE11 and edge it doesn't happens, but for IE11 and Edge it doesn't happens on small \r\n        // mouse moves inside the item. \r\n        // https://stackoverflow.com/questions/59022563/browser-events-mouseover-doesnt-happen-when-you-make-element-visible-and-mous\r\n        \r\n        var onChoiceElementMouseover = () => onChoiceElementMouseoverGeneral(\r\n            MultiSelectData,\r\n            choiceElement\r\n        )\r\n\r\n        choiceElement.addEventListener('mouseover', onChoiceElementMouseover);\r\n        \r\n        // note 1: mouseleave preferred to mouseout - which fires on each descendant\r\n        // note 2: since I want add aditional info panels to the dropdown put mouseleave on dropdwon would not work\r\n        var onChoiceElementMouseleave = () => {\r\n            if (!eventSkipper.isSkippable()) {\r\n                resetChoicesHover();\r\n            }\r\n        }\r\n\r\n        choiceElement.addEventListener('mouseleave', onChoiceElementMouseleave);\r\n\r\n        choicesElement.appendChild(choiceElement);\r\n\r\n        let choiceContent = choiceContentGenerator(choiceElement, MultiSelectData.option); \r\n        MultiSelectData.choiceElement = choiceElement;\r\n        MultiSelectData.ChoiceContent = choiceContent;\r\n\r\n        MultiSelectData.DisposeChoiceElement = ()=> {\r\n            choiceElement.removeEventListener('mouseover',  onChoiceElementMouseover);\r\n            choiceElement.removeEventListener('mouseleave', onChoiceElementMouseleave);\r\n        }\r\n\r\n        // var setChoiceContentDisabled = (isSelected) => {\r\n        //     choiceContent.disabledStyle(true);\r\n        //     // do not desable if selected! there should be possibility to unselect \"disabled\"\r\n        //     choiceContent.disable(!isSelected);\r\n        // }\r\n        // choiceContent.setChoiceContentDisabled= setChoiceContentDisabled;\r\n        if (MultiSelectData.isOptionDisabled)\r\n            choiceContent.setChoiceContentDisabled(isSelected )\r\n\r\n        choiceContent.onSelected( () => {\r\n            MultiSelectData.toggle();\r\n            filterPanelSetFocus();\r\n        });\r\n        // ------------------------------------------------------------------------------\r\n        \r\n        var createSelectedItem = () => createSelectedItemGen(\r\n            MultiSelectData//,\r\n            //MultiSelectData.isOptionDisabled,\r\n            //() => setChoiceContentDisabled(content, false)\r\n        );\r\n        \r\n        if (isSelected)\r\n        {\r\n            createSelectedItem();\r\n        }\r\n        else\r\n        {\r\n            MultiSelectData.excludedFromSearch =  MultiSelectData.isOptionDisabled;\r\n            if (MultiSelectData.isOptionDisabled)\r\n                MultiSelectData.toggle = () => { }\r\n            else\r\n                MultiSelectData.toggle = () =>  {\r\n                    var confirmed = setSelected(MultiSelectData.option, true);\r\n                    if (confirmed==null || confirmed) {\r\n                        createSelectedItem();\r\n                        triggerChange();\r\n                    }\r\n                }\r\n        }\r\n        // TODO: refactore it\r\n    }\r\n\r\n    var item = {\r\n        hoverInInternal,\r\n        stopAndResetChoicesHover(){\r\n            eventSkipper.setSkippable(); //disable Hover On MouseEnter - filter's changes should remove hover\r\n            resetChoicesHover();\r\n        },\r\n        showChoices,\r\n        hideChoices,\r\n        toggleHovered,\r\n        keyDownArrow,\r\n        insertChoice,\r\n        getIsVisble(){\r\n            return choicesElement.style.display != 'none';\r\n        }\r\n    }\r\n    return item;\r\n}\r\n","import {removeElement, removeChildren, EventBinder} from './ToolsDom'\r\nimport {List} from './ToolsJs'\r\n\r\nexport function PicksPanel (\r\n        createElement,\r\n        picksElement, \r\n        init, \r\n        pickContentGenerator, \r\n        isComponentDisabled,\r\n        //afterRemove,\r\n        onClick, // click to open dropdown\r\n        onPickCreated,\r\n        onPickRemoved,\r\n        processRemoveButtonClick // click to remove button\r\n) \r\n{\r\n    var list = List();\r\n\r\n    var pickFilterElement = createElement('LI'); // detached\r\n    picksElement.appendChild(pickFilterElement); // located filter in selectionsPanel\r\n    init(pickFilterElement);\r\n\r\n    function createPick(multiSelectData, option) {\r\n        var pickElement = createElement('LI');\r\n        var item = {pickElement}\r\n        var removeFromList = list.add(item);\r\n\r\n        var removeSelectedItem = () => {\r\n            onPickRemoved(\r\n                multiSelectData, \r\n                ()=>{\r\n                    removeElement(pickElement);\r\n                    item.pickContent.dispose();\r\n                    removeFromList();\r\n                    return {\r\n                        createSelectedItem: ()=> {\r\n                            createPick(multiSelectData, option);\r\n                            onPickCreated(multiSelectData, removeSelectedItem, list.getCount());\r\n                        },\r\n                        count: list.getCount()\r\n                    };\r\n                }\r\n            );\r\n        }\r\n        item.removeSelectedItem = removeSelectedItem;\r\n\r\n        // processRemoveButtonClick removes the \r\n        // what is a problem with calling removeSelectedItem directly (not using  setTimeout(removeSelectedItem, 0)):\r\n        // consider situation \"MultiSelect\" on DROPDOWN (that should be closed on the click outside dropdown)\r\n        // therefore we aslo have document's click's handler where we decide to close or leave the DROPDOWN open.\r\n        // because of the event's bubling process removeSelectedItem runs first. \r\n        // that means the event's target element on which we click (the x button) will be removed from the DOM together with badge \r\n        // before we could analize is it belong to our dropdown or not.\r\n        // important 1: we can't just the stop propogation using stopPropogate because click outside dropdown on the similar \r\n        // component that use stopPropogation will not close dropdown (error, dropdown should be closed)\r\n        // important 2: we can't change the dropdown's event handler to leave dropdown open if event's target is null because of\r\n        // the situation described above: click outside dropdown on the same component.\r\n        // Alternatively it could be possible to use stopPropogate but together create custom click event setting new target that belomgs to DOM (e.g. panel)\r\n\r\n        // let removePickAndCloseChoices = () => {\r\n        //     removeSelectedItem();\r\n        //     //afterRemove();\r\n        // };\r\n    \r\n        let onRemoveSelectedItemEvent = (event) => {\r\n             processRemoveButtonClick(removeSelectedItem/*() => removePickAndCloseChoices()*/, event);\r\n        };\r\n\r\n        item.pickContent = pickContentGenerator(\r\n            pickElement,\r\n            option,\r\n            onRemoveSelectedItemEvent);\r\n\r\n        item.pickContent.disable(isComponentDisabled);\r\n        picksElement.insertBefore(pickElement, pickFilterElement);\r\n\r\n        onPickCreated(multiSelectData, list.getCount(), removeSelectedItem);\r\n    }\r\n\r\n    var eventBinder = EventBinder();\r\n    return {\r\n        pickFilterElement,\r\n        createPick,\r\n        removePicksTail(){  \r\n            var item = list.getTail();\r\n            if (item) \r\n                item.removeSelectedItem(); // always remove in this case\r\n        },\r\n        isEmpty: list.isEmpty,\r\n        enable(){\r\n            isComponentDisabled= false;\r\n            list.forEach(i=>i.pickContent.disable(false))\r\n            eventBinder.bind(picksElement,\"click\", event => onClick(event));  // OPEN dropdown\r\n        },\r\n        disable(){\r\n            isComponentDisabled= true;\r\n            list.forEach(i=>i.pickContent.disable(true))\r\n            eventBinder.unbind();\r\n        },\r\n        deselectAll(){\r\n            list.forEach(i =>i.removeSelectedItem())\r\n        },\r\n        clear() {\r\n            list.forEach(i=>removeElement(i.pickElement));\r\n            list.reset();\r\n        },\r\n        dispose(){\r\n            removeChildren(picksElement);\r\n            eventBinder.unbind();\r\n            list.forEach(i=>i.pickContent.dispose());\r\n        }\r\n    }\r\n}","export function MultiSelectInputAspect (\r\n    window,\r\n    appendToContainer, \r\n    choiceFilterInputElement, \r\n    picksElement,\r\n    choicesElement, \r\n    showChoices,\r\n    hideChoicesAndResetFilter,\r\n    isChoiceEmpty,\r\n    Popper\r\n    ) {\r\n        appendToContainer();\r\n        var document = window.document;\r\n\r\n    var skipFocusout = false;\r\n    \r\n    // we want to escape the closing of the menu (because of focus out from) on a user's click inside the container\r\n    var skipoutMousedown = function() {\r\n         skipFocusout = true;\r\n    }\r\n\r\n    var documentMouseup = function(event) {\r\n        // if click outside container - close dropdown\r\n        if (  !(choicesElement === event.target \r\n                || picksElement === event.target \r\n                || choicesElement.contains(event.target)\r\n                || picksElement.contains(event.target)\r\n               )\r\n            ) {\r\n            hideChoicesAndResetFilter();\r\n        }\r\n    }\r\n\r\n    var popper = null;\r\n    //if (!!Popper.prototype && !!Popper.prototype.constructor.name) {\r\n        popper=new Popper( \r\n            choiceFilterInputElement, \r\n            choicesElement, \r\n            {\r\n                placement: 'bottom-start',\r\n                modifiers: {\r\n                    preventOverflow: {enabled:false},\r\n                    hide: {enabled:false},\r\n                    flip: {enabled:false}\r\n                }\r\n            }\r\n        );\r\n    /*}else{\r\n        popper=Popper.createPopper( \r\n            choiceFilterInputElement, \r\n            choicesElement\r\n            // ,  https://github.com/popperjs/popper.js/blob/next/docs/src/pages/docs/modifiers/prevent-overflow.mdx#mainaxis\r\n            // {\r\n            //     placement: 'bottom-start',\r\n            //     modifiers: {\r\n            //         preventOverflow: {enabled:false},\r\n            //         hide: {enabled:false},\r\n            //         flip: {enabled:false}\r\n            //     }\r\n            // }\r\n        );\r\n    }*/\r\n     \r\n\r\n    var filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n    var preventDefaultClickEvent = null;\r\n\r\n    function alignAndShowChoices(event){\r\n        if (preventDefaultClickEvent != event) {\r\n            if (!isChoiceEmpty())\r\n            {\r\n                alignToFilterInputItemLocation(true);\r\n                showChoices();\r\n            }\r\n        }\r\n        preventDefaultClickEvent=null;\r\n    }\r\n    \r\n    function alignToFilterInputItemLocation(force) {\r\n        let offsetLeft = choiceFilterInputElement.offsetLeft;\r\n        if (force || filterInputItemOffsetLeft != offsetLeft){ // position changed\r\n            popper.update();\r\n            filterInputItemOffsetLeft = offsetLeft;\r\n        }\r\n    }\r\n\r\n    return {\r\n        dispose(){\r\n            popper.destroy();\r\n        },\r\n        alignToFilterInputItemLocation,\r\n        alignAndShowChoices,\r\n        processUncheck(uncheckOption, event){\r\n            // we can't remove item on \"click\" in the same loop iteration - it is unfrendly for 3PP event handlers (they will get detached element)\r\n            // never remove elements in the same event iteration\r\n\r\n            window.setTimeout(()=>uncheckOption(),0)\r\n            preventDefaultClickEvent = event; // setPreventDefaultMultiSelectEvent\r\n        },\r\n        onChoicesShow(){\r\n            // add listeners that manages close dropdown on input's focusout and click outside container\r\n            //container.removeEventListener(\"mousedown\", containerMousedown);\r\n\r\n            picksElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            choicesElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            document.addEventListener(\"mouseup\", documentMouseup);\r\n            \r\n        },\r\n        onChoicesHide(){\r\n            picksElement.removeEventListener(\"mousedown\", skipoutMousedown);\r\n            choicesElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            document.removeEventListener(\"mouseup\", documentMouseup);\r\n        },\r\n        getSkipFocusout : function() {\r\n             return skipFocusout;\r\n        },\r\n        resetSkipFocusout : function() {\r\n             skipFocusout=false;\r\n        }\r\n    }\r\n}","export function PlaceholderAspect(placeholderText, picksIsEmpty, filterIsEmpty, picksElement, inputElement ){\r\n    function setEmptyInputWidth(isVisible){\r\n        if(isVisible)\r\n            inputElement.style.width=\"100%\"\r\n        else\r\n            inputElement.style.width=\"2ch\";\r\n    }\r\n\r\n    function showPlacehodler(isVisible){\r\n        if (isVisible)\r\n        {\r\n            inputElement.placeholder = placeholderText?placeholderText:\"\";\r\n            picksElement.style.display= \"block\";\r\n        }\r\n        else\r\n        {\r\n            inputElement.placeholder = \"\";\r\n            picksElement.style.display= \"flex\";\r\n        }\r\n        setEmptyInputWidth(isVisible);\r\n    }\r\n    showPlacehodler(true);\r\n\r\n    return {\r\n        init(){\r\n        },\r\n        updatePlacehodlerVisibility(){\r\n            showPlacehodler(picksIsEmpty() && filterIsEmpty());\r\n        },\r\n        updateEmptyInputWidth(){\r\n            setEmptyInputWidth(picksIsEmpty() && filterIsEmpty())\r\n        },\r\n        setDisabled(isDisabled)\r\n        { \r\n            inputElement.disabled = isDisabled;\r\n        }\r\n    }\r\n}","export function EventSkipper(window) {\r\n    var isSkippable = false;\r\n    return {\r\n        isSkippable(){\r\n            return isSkippable;\r\n        },\r\n        setSkippable(){\r\n            isSkippable = true;\r\n            window.setTimeout( \r\n                () => {  \r\n                    isSkippable = false;\r\n                }, 0)\r\n        }\r\n    }\r\n}","import {FilterPanel} from './FilterPanel'\r\nimport {ChoicesPanel} from './ChoicesPanel'\r\nimport {PicksPanel} from './PicksPanel'\r\nimport {MultiSelectInputAspect} from './MultiSelectInputAspect'\r\nimport {PlaceholderAspect} from './PlaceholderAspect'\r\n\r\nimport {EventSkipper} from './EventSkipper'\r\nimport {removeElement} from './ToolsDom'\r\n\r\nfunction filterMultiSelectData(MultiSelectData, isFiltered, visibleIndex) {\r\n    MultiSelectData.visible = isFiltered;\r\n    MultiSelectData.visibleIndex = visibleIndex;\r\n    MultiSelectData.choiceElement.style.display = isFiltered ? 'block': 'none';\r\n} \r\n\r\nfunction resetChoices(MultiSelectDataList) {\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            filterMultiSelectData(multiSelectData, true, i);\r\n        }\r\n    }\r\n}\r\n\r\nfunction collectFilterChoices(MultiSelectDataList, text) {\r\n    var list = [];\r\n    var j = 0;\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            if ( multiSelectData.excludedFromSearch || multiSelectData.searchText.indexOf(text)<0 )\r\n            {\r\n                filterMultiSelectData(multiSelectData, false);\r\n            }\r\n            else \r\n            {\r\n                filterMultiSelectData(multiSelectData, true, j++);\r\n                list.push( multiSelectData );\r\n            }\r\n        }\r\n    }\r\n    return list;\r\n}\r\n\r\nexport class MultiSelect {\r\n\r\n    constructor(optionsAdapter, setSelected, containerAdapter, styling, \r\n        pickContentGenerator, choiceContentGenerator, \r\n        labelAdapter, createStylingComposite, placeholderText,\r\n        configuration, onUpdate, onDispose, popper, window) {\r\n\r\n        this.onUpdate = onUpdate;\r\n        this.onDispose = onDispose; \r\n\r\n        // readonly\r\n        this.optionsAdapter = optionsAdapter;\r\n        this.containerAdapter = containerAdapter;\r\n        this.styling = styling;\r\n        this.pickContentGenerator = pickContentGenerator;\r\n        this.choiceContentGenerator = choiceContentGenerator;\r\n        this.labelAdapter = labelAdapter;\r\n        this.createStylingComposite = createStylingComposite;\r\n        this.configuration = configuration;\r\n        this.placeholderText = placeholderText;\r\n        this.setSelected=setSelected; // should I rebind this for callbacks? setSelected.bind(this);\r\n        this.popper = popper;\r\n        this.window = window;\r\n\r\n        this.visibleCount=10;\r\n\r\n        this.choicesPanel = null;\r\n\r\n        this.stylingComposite = null;\r\n\r\n        this.isComponentDisabled = null;\r\n                \r\n        this.resetMultiSelectDataList();\r\n    }\r\n\r\n    resetMultiSelectDataList(){\r\n        this.MultiSelectDataList = [];\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    \r\n    getVisibleMultiSelectDataList(){\r\n        if (this.filteredMultiSelectDataList)\r\n            return this.filteredMultiSelectDataList;\r\n        else\r\n            return this.MultiSelectDataList;\r\n    }\r\n\r\n    resetFilter(){\r\n        if (!this.filterPanel.isEmpty()) {\r\n            this.filterPanel.setEmpty();\r\n            this.processEmptyInput();\r\n            this.placeholderAspect.updatePlacehodlerVisibility();\r\n        }\r\n    }\r\n\r\n    processEmptyInput(){\r\n        this.filterPanel.setEmptyLength();\r\n        resetChoices(this.MultiSelectDataList);\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    // -----------------------------------------------------------------------------------------------------------------------\r\n    GetContainer(){\r\n        return this.containerAdapter.containerElement;\r\n    }\r\n\r\n    Update(){\r\n        this.onUpdate();\r\n        this.UpdateDisabled();\r\n        this.UpdateData();\r\n    }\r\n\r\n    /*\r\n    UpdateOption(index){\r\n        let multiSelectData = this.MultiSelectDataList[index];\r\n        let option = multiSelectData.option;\r\n        multiSelectData.searchText = option.text.toLowerCase().trim();\r\n        if (multiSelectData.isHidden != option.isHidden)\r\n        {\r\n            multiSelectData.isHidden=option.isHidden;\r\n            if (multiSelectData.isHidden)\r\n                this.optionsPanel.insertChoice(multiSelectData, \r\n                    (p1,p2,p3)=>this.picksPanel.createPick(p1,p2,p3),\r\n                    ()=>this.optionsAdapter.triggerChange(),\r\n                    option.isSelected, option.isDisabled);\r\n            else\r\n                multiSelectData.removeChoiceElement();\r\n        }\r\n        else \r\n        {\r\n            if (multiSelectData.isSelected != option.isSelected)\r\n            {\r\n                multiSelectData.isSelected=option.isSelected;\r\n                if (multiSelectData.isSelected)\r\n                {\r\n                    // this.insertChoice(multiSelectData, (e)=>this.choicesElement.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeChoiceElement();\r\n                }\r\n            }\r\n            if (multiSelectData.isDisabled != option.isDisabled)\r\n            {\r\n                multiSelectData.isDisabled=option.isDisabled;\r\n                if (multiSelectData.isDisabled)\r\n                {\r\n                    // this.insertChoice(multiSelectData, (e)=>this.choicesElement.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeChoiceElement();\r\n                }\r\n            }\r\n        }    \r\n        //multiSelectData.updateOption();\r\n    }*/\r\n\r\n    DeselectAll(){\r\n        this.choicesPanel.hideChoices(); // always hide 1st\r\n        this.picksPanel.deselectAll();\r\n        this.resetFilter();\r\n    }\r\n\r\n    SelectAll(){\r\n        this.choicesPanel.hideChoices(); // always hide 1st\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (!multiSelectData.excludedFromSearch)\r\n                multiSelectData.toggle();\r\n        }\r\n        this.resetFilter();\r\n    }\r\n\r\n    empty(){\r\n        // close drop down , remove filter\r\n        this.choicesPanel.hideChoices(); // always hide 1st\r\n        this.resetFilter();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.choiceElement)\r\n                removeElement(multiSelectData.choiceElement);\r\n        }\r\n        this.resetMultiSelectDataList();\r\n        this.picksPanel.clear();\r\n        this.placeholderAspect.updatePlacehodlerVisibility();\r\n    }\r\n\r\n    UpdateData(){\r\n        this.empty();\r\n        // reinitiate\r\n        this.updateDataImpl();\r\n    }\r\n\r\n    updateDataImpl(){\r\n        var fillChoices = () => {\r\n            let options = this.optionsAdapter.getOptions();\r\n            var j = 0;\r\n            for(let i = 0; i<options.length; i++) {\r\n                let option = options[i];\r\n\r\n                let isSelected = option.selected;\r\n\r\n                let isOptionDisabled = (option.disabled)?option.disabled:false;\r\n                let isOptionHidden   = (option.hidden)?option.hidden:false;\r\n                \r\n                var MultiSelectData = {\r\n                    searchText: option.text.toLowerCase().trim(),\r\n                    excludedFromSearch: isSelected || isOptionDisabled || isOptionHidden,\r\n                    option: option,\r\n                    isOptionDisabled: isOptionDisabled,\r\n                    isHidden: isOptionHidden,\r\n                    choiceElement: null,\r\n                    choiceContent: null,\r\n                    //selectedPrev: null,\r\n                    //selectedNext: null,\r\n                    visible: false,\r\n                    toggle: null,\r\n                    pickElement: null,\r\n                    remove: null,\r\n                    disable: null,\r\n                    removeChoiceElement: null\r\n                };\r\n\r\n                this.MultiSelectDataList.push(MultiSelectData);\r\n                if (!isOptionHidden){\r\n                    MultiSelectData.visible = true;\r\n                    MultiSelectData.visibleIndex=i;\r\n                    this.choicesPanel.insertChoice(\r\n                        MultiSelectData, \r\n                        /*createSelectedItemGen*/ (multiSelectData/*,isOptionDisabled,setChoiceContentDisabled*/) => {\r\n                            this.picksPanel.createPick(\r\n                                multiSelectData,\r\n                                multiSelectData.option\r\n                                /*,\r\n                                isOptionDisabled,\r\n                                setChoiceContentDisabled\r\n                                */\r\n                                )\r\n                            //\r\n                        },\r\n                        (o,i) => this.setSelected(o,i),\r\n                        () => this.optionsAdapter.triggerChange()\r\n                        ,isSelected\r\n                        //,isOptionDisabled\r\n                        );\r\n                }\r\n            } \r\n            this.aspect.alignToFilterInputItemLocation(false);\r\n            //this.placeholderAspect.updatePlacehodlerVisibility();\r\n        }\r\n\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        if (document.readyState != 'loading'){\r\n            fillChoices();\r\n        } else {\r\n            var domContentLoadedHandler = function(){\r\n                fillChoices();\r\n                document.removeEventListener(\"DOMContentLoaded\", domContentLoadedHandler);\r\n            }\r\n            document.addEventListener('DOMContentLoaded', domContentLoadedHandler); // IE9+\r\n        }\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.onDispose)\r\n            this.onDispose(); // primary used to remove from jQuery tables\r\n        \r\n        // remove event listeners\r\n        // TODO check if open\r\n        this.choicesPanel.hideChoices();\r\n        if (this.optionsAdapter.dispose)\r\n            this.optionsAdapter.dispose();\r\n        this.picksPanel.dispose();\r\n        this.filterPanel.dispose();\r\n        \r\n        this.labelAdapter.dispose();\r\n        \r\n        this.aspect.dispose();\r\n        \r\n        this.containerAdapter.dispose();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            multiSelectData.toggle = null;\r\n            multiSelectData.remove = null; \r\n            multiSelectData.removeChoiceElement = null;\r\n            if (multiSelectData.DisposeChoiceElement)\r\n                multiSelectData.DisposeChoiceElement();\r\n            \r\n            if (multiSelectData.ChoiceContent)\r\n                multiSelectData.ChoiceContent.dispose();\r\n        }\r\n    }\r\n\r\n    UpdateDisabled(){\r\n        let isComponentDisabled = this.optionsAdapter.getDisabled();\r\n        if (this.isComponentDisabled!==isComponentDisabled){\r\n            if (isComponentDisabled) {\r\n                this.picksPanel.disable();\r\n                this.placeholderAspect.setDisabled(true);\r\n                this.styling.Disable(this.stylingComposite);\r\n            } else {\r\n                this.picksPanel.enable();\r\n                this.placeholderAspect.setDisabled(false);\r\n                this.styling.Enable(this.stylingComposite);\r\n            }\r\n            this.isComponentDisabled=isComponentDisabled;\r\n        }\r\n    }\r\n \r\n    input(filterInputValue, resetLength){\r\n        let text = filterInputValue.trim().toLowerCase();\r\n        var isEmpty=false;\r\n        if (text == '')\r\n            isEmpty=true;\r\n        else\r\n        {\r\n            // check if exact match, otherwise new search\r\n            this.filteredMultiSelectDataList = collectFilterChoices(this.MultiSelectDataList, text);\r\n            if (this.filteredMultiSelectDataList.length == 1)\r\n            {\r\n                let fullMatchMultiSelectData =  this.filteredMultiSelectDataList[0];\r\n                if (fullMatchMultiSelectData.searchText == text)\r\n                {\r\n                    fullMatchMultiSelectData.toggle();\r\n                    this.filterPanel.setEmpty(); // clear\r\n                    isEmpty=true;\r\n                }\r\n            }\r\n        }\r\n        if (isEmpty)\r\n            this.processEmptyInput();\r\n        else\r\n            resetLength();  \r\n        \r\n        \r\n        this.choicesPanel.stopAndResetChoicesHover();\r\n        if (this.getVisibleMultiSelectDataList().length == 1) {\r\n            this.choicesPanel.hoverInInternal(0)\r\n        }\r\n\r\n        if (this.getVisibleMultiSelectDataList().length > 0) {\r\n            this.aspect.alignToFilterInputItemLocation(true); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.choicesPanel.showChoices();\r\n        } else {\r\n            this.choicesPanel.hideChoices();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        var document = this.window.document;\r\n        var createElement = (name) => document.createElement(name);\r\n\r\n        var lazyfilterItemInputElementAtach=null;\r\n        \r\n        this.filterPanel = FilterPanel(\r\n            createElement,\r\n            (filterItemInputElement) => {\r\n                lazyfilterItemInputElementAtach = (filterItemElement)=>{\r\n                    filterItemElement.appendChild(filterItemInputElement);\r\n                    this.labelAdapter.init(filterItemInputElement); \r\n                };\r\n            },\r\n            () => {\r\n                this.styling.FocusIn(this.stylingComposite)\r\n            },  // focus in - show dropdown\r\n            () => {\r\n                if (!this.aspect.getSkipFocusout()) // skip initiated by mouse click (we manage it different way)\r\n                {\r\n                    this.resetFilter(); // if do not do this we will return to filtered list without text filter in input\r\n                    this.styling.FocusOut(this.stylingComposite)\r\n                }\r\n                this.aspect.resetSkipFocusout();\r\n            }, // focus out - hide dropdown\r\n            () => this.choicesPanel.keyDownArrow(false), // arrow up\r\n            () => this.choicesPanel.keyDownArrow(true),  // arrow down\r\n            () => this.choicesPanel.hideChoices(),  // tab on empty\r\n            () => {\r\n                this.picksPanel.removePicksTail();\r\n                this.aspect.alignToFilterInputItemLocation(false);\r\n            }, // backspace - \"remove last\"\r\n            () => { \r\n                if (this.choicesPanel.getIsVisble())\r\n                    this.choicesPanel.toggleHovered() }, // tab/enter \"compleate hovered\"\r\n            (isEmpty, event) => {\r\n                if (!isEmpty || this.choicesPanel.getIsVisble()) // supports bs modal - stop esc (close modal) propogation\r\n                    event.stopPropagation();\r\n            }, // esc keydown\r\n            () => {\r\n                this.choicesPanel.hideChoices(); // always hide 1st\r\n                this.resetFilter();\r\n            }, // esc keyup \r\n            (filterInputValue, resetLength) =>\r\n            { \r\n                this.placeholderAspect.updatePlacehodlerVisibility();\r\n                this.input(filterInputValue, resetLength) \r\n            }, // filter\r\n            () => {\r\n                this.placeholderAspect.updateEmptyInputWidth();\r\n            }\r\n        );\r\n        \r\n        this.picksPanel =  PicksPanel(\r\n            //this.setSelected,\r\n            createElement,\r\n            this.containerAdapter.picksElement,\r\n            (filterItemElement) => {\r\n                lazyfilterItemInputElementAtach(filterItemElement);\r\n            },\r\n            this.pickContentGenerator,\r\n            this.isComponentDisabled,\r\n            // /*afterRemove*/() => {\r\n            //     this.choicesPanel.hideChoices(); // always hide 1st\r\n            //     this.resetFilter();\r\n            // },\r\n            /*onClick*/(event) => {\r\n                if (!this.filterPanel.isEventTarget(event))\r\n                     this.filterPanel.setFocus();\r\n                this.aspect.alignAndShowChoices(event); \r\n            },\r\n            /*onPickCreated*/ (multiSelectData, count, removePick) => {\r\n                multiSelectData.excludedFromSearch = true; // all selected excluded from search\r\n                multiSelectData.toggle = () => removePick();\r\n                multiSelectData.ChoiceContent.select(true);\r\n                if (count==1) \r\n                    this.placeholderAspect.updatePlacehodlerVisibility()\r\n            },\r\n            /*onPickRemoved*/ (multiSelectData, removePick) => {\r\n                let confirmed = this.setSelected(multiSelectData.option, false);\r\n                if (confirmed==null || confirmed) {\r\n                    var {createSelectedItem, count} = removePick();\r\n                    multiSelectData.excludedFromSearch = multiSelectData.isOptionDisabled;\r\n                    if (multiSelectData.isOptionDisabled)\r\n                    {\r\n                        multiSelectData.ChoiceContent.setChoiceContentDisabled(false);\r\n                        multiSelectData.toggle = ()=> {};\r\n                    }\r\n                    else\r\n                    {\r\n                        multiSelectData.toggle = ()=>{\r\n                            let confirmed = this.setSelected(multiSelectData.option, true);\r\n                            if (confirmed==null || confirmed){\r\n                                createSelectedItem(multiSelectData, multiSelectData.option);\r\n                                this.optionsAdapter.triggerChange();\r\n                            }\r\n                        };\r\n                    }\r\n                    multiSelectData.ChoiceContent.select(false);\r\n                    if (count==0) \r\n                        this.placeholderAspect.updatePlacehodlerVisibility()\r\n                    this.optionsAdapter.triggerChange();\r\n                }\r\n            },\r\n            (doUncheck, event) => {\r\n                this.aspect.processUncheck(doUncheck, event);\r\n                this.choicesPanel.hideChoices(); // always hide 1st\r\n                this.resetFilter();\r\n            }\r\n        );\r\n\r\n        this.choicesPanel = ChoicesPanel(\r\n            createElement,\r\n            this.containerAdapter.choicesElement,\r\n            () => this.aspect.onChoicesShow(),\r\n            () => this.aspect.onChoicesHide(),\r\n            EventSkipper(this.window),\r\n            this.choiceContentGenerator,\r\n            () => this.getVisibleMultiSelectDataList(),\r\n            () => this.resetFilter(),\r\n            () => this.aspect.alignToFilterInputItemLocation(true),\r\n            () => this.filterPanel.setFocus()\r\n        );\r\n\r\n        this.placeholderAspect = PlaceholderAspect(\r\n            this.placeholderText, \r\n            () => this.picksPanel.isEmpty(), \r\n            () => this.filterPanel.isEmpty(), \r\n            this.containerAdapter.picksElement, \r\n            this.filterPanel.filterInputElement\r\n        )\r\n\r\n        this.placeholderAspect.init();\r\n        this.placeholderAspect.updateEmptyInputWidth();\r\n\r\n        this.aspect =  MultiSelectInputAspect(\r\n            this.window,\r\n            ()=>this.containerAdapter.appendToContainer(), \r\n            this.picksPanel.pickFilterElement, \r\n            this.containerAdapter.picksElement, \r\n            this.containerAdapter.choicesElement, \r\n            () => this.choicesPanel.showChoices(),\r\n            () => {  \r\n                this.choicesPanel.hideChoices();\r\n                this.resetFilter();\r\n            },\r\n            () => this.getVisibleMultiSelectDataList().length==0, \r\n            this.popper\r\n        );\r\n        \r\n        this.stylingComposite = this.createStylingComposite(\r\n            this.picksPanel.pickFilterElement, \r\n            this.filterPanel.filterInputElement, \r\n            this.containerAdapter.choicesElement);\r\n        \r\n        this.styling.Init(this.stylingComposite);\r\n\r\n        this.containerAdapter.attachContainer();\r\n\r\n        this.onUpdate();\r\n        this.UpdateDisabled(); // should be done after updateDataImpl\r\n        this.updateDataImpl();\r\n\r\n        if (this.optionsAdapter.subscribeToReset)\r\n            this.optionsAdapter.subscribeToReset(()=> this.window.setTimeout( ()=>this.UpdateData() ) );\r\n    }\r\n}","export function LabelAdapter(labelElement, createInputId){\r\n    var backupedForAttribute = null; // state saved between init and dispose\r\n    return {\r\n        init(filterInputElement) {\r\n            if (labelElement) {\r\n                backupedForAttribute = labelElement.getAttribute('for');\r\n                var newId = createInputId();\r\n                filterInputElement.setAttribute('id', newId);\r\n                labelElement.setAttribute('for',newId);\r\n            }\r\n        },\r\n        dispose(){\r\n            if(backupedForAttribute)\r\n                labelElement.setAttribute('for',backupedForAttribute);\r\n        }\r\n    }\r\n}","export function addToJQueryPrototype(pluginName, createPlugin, defaults, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    const firstCharLower = firstChar.toLowerCase();\r\n    if (firstCharLower == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstCharLower + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance (for 1st $selected item)\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n\r\n    $.fn[prototypableName].defaults = defaults;\r\n}\r\n\r\n","\r\n\r\nfunction OptionsAdapterElement(selectElement, getDisabled, getSize, getIsValid, getIsInvalid, trigger, form) {\r\n    var backup;\r\n    return {\r\n        getOptions(){\r\n            return selectElement.getElementsByTagName('OPTION')\r\n        },\r\n        triggerChange(){\r\n            trigger('change')\r\n            trigger('multiselect:change')\r\n        },\r\n        getDisabled,\r\n        getSize,\r\n        getIsValid,\r\n        getIsInvalid,\r\n        subscribeToReset(handler){\r\n            backup = handler;\r\n            if (form)\r\n                form.addEventListener('reset', backup)\r\n        },\r\n        dispose(){\r\n            if (form && backup)\r\n                form.removeEventListener('reset', backup)\r\n        }\r\n    }\r\n}\r\n\r\nfunction OptionsAdapterJson(options, getDisabled, getSize, getIsValid, getIsInvalid, trigger) {\r\n    return {\r\n        getOptions(){\r\n            return options\r\n        },\r\n        triggerChange(){\r\n            trigger('multiselect:change')\r\n        },\r\n        getDisabled(){\r\n            return getDisabled?getDisabled():false\r\n        },\r\n        getSize(){\r\n            return getSize?getSize():null\r\n        },\r\n        getIsValid(){\r\n            return getIsValid?getIsValid():false\r\n        },\r\n        getIsInvalid(){\r\n            return getIsInvalid?getIsInvalid():false\r\n        }\r\n    }\r\n}\r\n\r\nexport {OptionsAdapterJson, OptionsAdapterElement}","import {setStyles} from './ToolsDom';\r\nimport {createEmpty} from './ToolsJs';\r\n\r\nexport function StylingCorrector(configuration){\r\n    var resetDisable = createEmpty(configuration.picksStyleDisabled, \"\");\r\n    var resetFocus = createEmpty(configuration.picksStyleFocus, \"\");\r\n    return {\r\n        init(elements){\r\n            setStyles(elements.picks, configuration.picksStyle);\r\n        },\r\n    \r\n        enable(picksElement){\r\n            setStyles(picksElement, resetDisable)\r\n        },\r\n    \r\n        disable(picksElement){\r\n            setStyles(picksElement, configuration.picksStyleDisabled);\r\n        },\r\n    \r\n        focusIn(picksElement){\r\n            setStyles(picksElement, configuration.picksStyleFocus)\r\n        },\r\n    \r\n        focusOut(picksElement){\r\n            setStyles(picksElement, resetFocus)\r\n        }\r\n    }\r\n}","import {addClasses, removeClasses} from './ToolsDom';\r\n\r\nexport function Styling(configuration, stylingCorrector) {\r\n    return {\r\n        Init(elements){\r\n            addClasses(elements.container, configuration.containerClass);\r\n            addClasses(elements.picks, configuration.picksClass);\r\n            addClasses(elements.choices, configuration.choicesClass);\r\n            addClasses(elements.pickFilter, configuration.pickFilterClass);\r\n            addClasses(elements.input, configuration.filterInputClass);\r\n            if (stylingCorrector && stylingCorrector.init)\r\n                stylingCorrector.init(elements)\r\n        },\r\n\r\n        Enable(elements){\r\n            removeClasses(elements.picks, configuration.picksClassDisabled);\r\n            if (stylingCorrector && stylingCorrector.enable)\r\n                stylingCorrector.enable(elements.picks)\r\n        },\r\n\r\n        Disable(elements){\r\n            addClasses(elements.picks, configuration.picksClassDisabled);\r\n            if (stylingCorrector && stylingCorrector.disable)\r\n                stylingCorrector.disable(elements.picks)\r\n        },\r\n\r\n        FocusIn(elements){\r\n            addClasses(elements.picks, configuration.picksClassFocus);\r\n            if (stylingCorrector && stylingCorrector.focusIn)\r\n                stylingCorrector.focusIn(elements.picks)\r\n        },\r\n\r\n        FocusOut(elements){\r\n            removeClasses(elements.picks, configuration.picksClassFocus);\r\n            if (stylingCorrector && stylingCorrector.focusOut)\r\n                stylingCorrector.focusOut(elements.picks)\r\n        }\r\n    }\r\n}","import  {addClasses, setStyles, EventBinder} from './ToolsDom';\r\n\r\n\r\nexport function BsPickContentStylingCorrector(configuration) {\r\n    return {\r\n        disablePickContent(pickContentElement){\r\n            setStyles(pickContentElement, configuration.pickContentStyleDisabled);\r\n        },\r\n    \r\n        createPickContent(pickElement, pickButtonElement){\r\n            setStyles(pickElement, configuration.pickStyle);\r\n            setStyles(pickButtonElement, configuration.pickButtonStyle);\r\n        }\r\n    }\r\n}\r\n\r\nfunction bsPickContentGenerator(pickElement, option, removePick, configuration, stylingCorrector){\r\n    addClasses(pickElement, configuration.pickClass);\r\n\r\n    pickElement.innerHTML = '<span></span><button aria-label=\"Remove\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>'\r\n    var pickContentElement = pickElement.querySelector(`SPAN`);\r\n    pickContentElement.textContent= option.text;\r\n    if (option.disabled ){\r\n        addClasses(pickContentElement, configuration.pickContentClassDisabled)\r\n        if (stylingCorrector && stylingCorrector.disablePickContent)\r\n            stylingCorrector.disablePickContent(pickContentElement);\r\n    }\r\n    var pickButtonElement = pickElement.querySelector(`BUTTON`);\r\n    // bs 'close' class that will be added to button set the float:right, therefore it impossible to configure no-warp policy \r\n        // with .css(\"white-space\", \"nowrap\") or  .css(\"display\", \"inline-block\"); TODO: migrate to flex? \r\n    pickButtonElement.style.float= \"none\";\r\n    addClasses(pickButtonElement, configuration.pickButtonClass); // bs close class set the float:right\r\n    \r\n    var eventBinder = EventBinder();\r\n    eventBinder.bind(pickButtonElement, \"click\", event => removePick(event));\r\n    if (stylingCorrector && stylingCorrector.createPickContent)\r\n        stylingCorrector.createPickContent(pickElement, pickButtonElement);\r\n    return {\r\n        disable(isDisabled){ \r\n            pickButtonElement.disabled=isDisabled; \r\n        },\r\n        dispose(){\r\n            eventBinder.unbind();\r\n        }\r\n    };\r\n}\r\n\r\nexport function BsPickContentGenerator(configuration, stylingCorrector) {\r\n    return function (pickElement, option, removePick){\r\n            return bsPickContentGenerator(pickElement, option, removePick, configuration, stylingCorrector)\r\n        }\r\n}","import {addClasses, removeClasses, setStyles, EventBinder} from './ToolsDom';\r\nimport {createEmpty} from './ToolsJs'\r\n\r\nexport function BsChoiceContentStylingCorrector(configuration) {\r\n    var resetStyle = createEmpty(resetStyle, configuration.choiceLabelStyleDisabled, '');\r\n    return{\r\n        disabledStyle(choiceLabelElement, isDisbaled){\r\n            setStyles(choiceLabelElement, isDisbaled? configuration.choiceLabelStyleDisabled : resetStyle)\r\n        }\r\n    }\r\n}\r\n\r\nfunction bsChoiceContentGenerator(choiceElement, option, configuration, stylingCorrector){\r\n    addClasses(choiceElement, configuration.choiceClass);\r\n    choiceElement.innerHTML = '<div><input type=\"checkbox\"><label></label></div>';\r\n    let choiceCheckBoxElement = choiceElement.querySelector('INPUT');\r\n    let choiceLabelElement = choiceElement.querySelector('LABEL');\r\n    let choiceContentElement = choiceElement.querySelector('DIV');\r\n    addClasses(choiceContentElement, configuration.choiceContentClass); \r\n    addClasses(choiceCheckBoxElement, configuration.choiceCheckBoxClass); \r\n    addClasses(choiceLabelElement, configuration.choiceLabelClass); \r\n\r\n    choiceLabelElement.textContent =option.text;\r\n    let eventBinder = EventBinder();\r\n\r\n    function disabledStyle(isDisabled){\r\n        if (isDisabled) \r\n                addClasses(choiceCheckBoxElement, configuration.choiceCheckBoxClassDisabled);\r\n            else\r\n                removeClasses(choiceCheckBoxElement, configuration.choiceCheckBoxClassDisabled);\r\n            if (stylingCorrector && stylingCorrector.disabledStyle)\r\n                stylingCorrector.disabledStyle(choiceLabelElement, isDisabled);  \r\n    };\r\n    return { \r\n        select(isSelected){ choiceCheckBoxElement.checked = isSelected }, \r\n        // --- distinct disable and disabledStyle to provide a possibility to unselect disabled option\r\n        //disable,//disable(isDisabled){ choiceCheckBoxElement.disabled = isDisabled },\r\n        //disabledStyle,\r\n        setChoiceContentDisabled : (isSelected) => {\r\n            disabledStyle(true); // TODO add option update\r\n            // do not desable checkBix if selected! there should be possibility to unselect \"disabled\"\r\n            choiceCheckBoxElement.disabled = !isSelected;\r\n        },\r\n        hoverIn(){\r\n            addClasses(choiceElement, configuration.choiceClassHover);\r\n        },\r\n        hoverOut(){\r\n            removeClasses(choiceElement, configuration.choiceClassHover);\r\n        },\r\n        onSelected(toggle) {\r\n            eventBinder.bind(choiceCheckBoxElement, \"change\", toggle);\r\n            eventBinder.bind(choiceElement, \"click\", \r\n                event => {\r\n                    if (choiceElement === event.target || choiceElement.contains(event.target)) {\r\n                        toggle();\r\n                    }\r\n                }\r\n            );\r\n        },\r\n        dispose(){\r\n            eventBinder.unbind();\r\n        }\r\n    }\r\n}\r\n\r\nexport function BsChoiceContentGenerator(configuration, stylingCorrector) {\r\n    return function(choiceElement, option){\r\n        return bsChoiceContentGenerator(choiceElement, option, configuration, stylingCorrector)\r\n    }\r\n}","import {setStyles} from './ToolsDom'\r\n\r\nconst picksStyle = {display:'flex', flexWrap:'wrap', listStyleType:'none'};  // remove bullets since this is ul\r\n\r\nexport function ContainerAdapter(createElement, selectElement, containerElement, picksElement) { // select\r\n    var ownContainerElement = false;\r\n    var ownPicksElement = false;\r\n    \r\n    if (!containerElement){\r\n        containerElement = createElement('div');\r\n        ownContainerElement= true;\r\n    }\r\n    if (!picksElement){\r\n        picksElement = createElement('UL');\r\n        ownPicksElement = true;\r\n    }\r\n    setStyles(picksElement, picksStyle); \r\n    \r\n    var choicesElement = createElement('UL');\r\n    choicesElement.style.display=\"none\";\r\n    \r\n    var backupDisplay = null;\r\n    if (selectElement)\r\n    { \r\n        backupDisplay = selectElement.style.display;\r\n        selectElement.style.display='none';\r\n    }\r\n    \r\n    return {\r\n        containerElement,\r\n        picksElement,\r\n        choicesElement,\r\n        init(){\r\n            if (ownPicksElement)\r\n                containerElement.appendChild(picksElement);\r\n        },\r\n        appendToContainer(){\r\n            if (ownContainerElement || !selectElement)            \r\n            {\r\n                if (ownPicksElement)\r\n                    containerElement.appendChild(picksElement);\r\n                containerElement.appendChild(choicesElement);\r\n            }\r\n            else\r\n            {\r\n                if (selectElement)\r\n                {\r\n                    selectElement.parentNode.insertBefore(choicesElement, selectElement.nextSibling);\r\n                    if (ownPicksElement)\r\n                        selectElement.parentNode.insertBefore(picksElement, choicesElement);\r\n                }\r\n            }\r\n        },\r\n        attachContainer(){\r\n            if (ownContainerElement)\r\n                selectElement.parentNode.insertBefore(containerElement, selectElement.nextSibling);\r\n        },\r\n        dispose(){\r\n            if (ownContainerElement)\r\n                containerElement.parentNode.removeChild(containerElement);\r\n            if (ownPicksElement)\r\n                picksElement.parentNode.removeChild(picksElement);\r\n            choicesElement.parentNode.removeChild(choicesElement);\r\n            if (selectElement)\r\n                selectElement.style.display = backupDisplay;\r\n        }\r\n    }\r\n}","import {addClass, removeClass, setStyles} from './ToolsDom';\r\n\r\nfunction updateIsValid(picksElement, isValid, isInvalid){\r\n    if (isValid)\r\n        addClass(picksElement,'is-valid');\r\n    else\r\n        removeClass(picksElement,'is-valid');\r\n    \r\n    if (isInvalid)\r\n        addClass(picksElement,'is-invalid');\r\n    else\r\n        removeClass(picksElement,'is-invalid');\r\n}\r\n\r\n\r\nfunction updateSize(picksElement, size){\r\n    if (size==\"custom-select-lg\"){\r\n        addClass(picksElement,'form-control-lg');\r\n        removeClass(picksElement,'form-control-sm');\r\n    }\r\n    else if (size==\"custom-select-sm\"){\r\n        removeClass(picksElement,'form-control-lg');\r\n        addClass(picksElement,'form-control-sm');\r\n    }\r\n    else{\r\n        removeClass(picksElement,'form-control-lg');\r\n        removeClass(picksElement,'form-control-sm');\r\n    }\r\n}\r\n\r\nfunction updateSizeJs(picksElement, picksStyleLg, picksStyleSm, picksStyleDef, size){\r\n    updateSize(picksElement, size);\r\n    if (size==\"custom-select-lg\" || size==\"input-group-lg\"){\r\n        setStyles(picksElement, picksStyleLg);\r\n    } else if (size==\"custom-select-sm\" || size==\"input-group-sm\"){\r\n        setStyles(picksElement, picksStyleSm);\r\n    } else {\r\n        setStyles(picksElement, picksStyleDef);\r\n    }\r\n}\r\n\r\nfunction updateIsValidForAdapter(picksElement, optionsAdapter){\r\n    updateIsValid(picksElement, optionsAdapter.getIsValid(), optionsAdapter.getIsInvalid())\r\n}\r\n\r\nfunction updateSizeForAdapter(picksElement, optionsAdapter){\r\n    updateSize(picksElement, optionsAdapter.getSize())\r\n}\r\n\r\nfunction updateSizeJsForAdapter(picksElement, picksStyleLg, picksStyleSm, picksStyleDef, optionsAdapter){\r\n    updateSizeJs(picksElement, picksStyleLg, picksStyleSm, picksStyleDef,  optionsAdapter.getSize())\r\n}\r\n\r\nexport function createBsAppearance(picksElement, configuration, optionsAdapter){\r\n    var updateIsValid = () => updateIsValidForAdapter(picksElement, optionsAdapter);\r\n    if (configuration.useCss){\r\n        return Object.create({\r\n            updateIsValid,\r\n            updateSize: () => updateSizeForAdapter(picksElement, optionsAdapter)\r\n        });\r\n    }else{\r\n        const {picksStyleLg, picksStyleSm, picksStyleDef} = configuration;\r\n        return Object.create({\r\n            updateIsValid,\r\n            updateSize: () => updateSizeJsForAdapter(picksElement, \r\n                picksStyleLg, picksStyleSm, picksStyleDef, optionsAdapter)\r\n        });\r\n    }\r\n}","import $ from 'jquery'\r\nimport Popper from 'popper.js'\r\n\r\nimport {extendIfUndefined} from './ToolsJs';\r\nimport {MultiSelect} from './MultiSelect'\r\nimport {LabelAdapter} from './LabelAdapter';\r\nimport {addToJQueryPrototype} from './AddToJQueryPrototype'\r\n\r\nimport {OptionsAdapterJson,OptionsAdapterElement} from './OptionsAdapters';\r\n\r\nimport {StylingCorrector} from './StylingCorrector'\r\nimport {Styling} from './Styling';\r\n\r\nimport {BsPickContentGenerator, BsPickContentStylingCorrector} from './BsPickContentGenerator';\r\nimport {BsChoiceContentGenerator, BsChoiceContentStylingCorrector} from './BsChoiceContentGenerator';\r\nimport {ContainerAdapter} from './ContainerAdapter';\r\n\r\nimport {createBsAppearance} from './BsAppearance';\r\nimport {findDirectChildByTagName, setStyles} from './ToolsDom';\r\n\r\nconst classesDefaults = {\r\n    containerClass: 'dashboardcode-bsmultiselect',\r\n    choicesClass: 'dropdown-menu',\r\n\r\n    choiceClassHover: 'text-primary bg-light', // dirty but BS doesn't provide better choices\r\n    choiceClassSelected: '', // not used? should be used in OptionsPanel.js\r\n    choiceClassDisabled: '', // not used? should be used in OptionsPanel.js\r\n\r\n    picksClass: 'form-control',  \r\n    picksClassFocus: 'focus', // internal, not bs4, used in scss\r\n    picksClassDisabled: 'disabled', // internal, not bs4, used in scss\r\n\r\n    pickClassDisabled: '', // not used? should be used in PicksPanel.js\r\n    \r\n    pickFilterClass: '', \r\n    filterInputClass: 'form-control',\r\n\r\n    // used in BsPickContentStylingCorrector\r\n    pickClass: 'badge',\r\n    pickContentClassDisabled: 'disabled', // internal, not bs4, used in scss\r\n    pickButtonClass: 'close',\r\n\r\n    // used in BsChoiceContentStylingCorrector\r\n    choiceClass:  'px-2',\r\n    choiceCheckBoxClassDisabled: 'disabled', // internal, not bs4, used in scss\r\n    choiceContentClass: 'custom-control custom-checkbox',\r\n    choiceCheckBoxClass: 'custom-control-input',\r\n    choiceLabelClass: 'custom-control-label justify-content-start'\r\n\r\n};\r\n\r\nconst stylingDefaults = {\r\n    // used in StylingCorrector\r\n    picksStyle: {marginBottom: 0, height: 'auto'},\r\n    picksStyleDisabled: {backgroundColor: '#e9ecef'},\r\n\r\n    picksStyleFocus: {borderColor: '#80bdff', boxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)'},\r\n    picksStyleFocusValid: {boxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)'},\r\n    picksStyleFocusInvalid: {boxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)'},\r\n    \r\n    //filterInputStyle: {color: 'inherit' /*#495057 for default BS*/, fontWeight : 'inherit'},\r\n\r\n    // used in BsAppearance\r\n    picksStyleDef: {minHeight: 'calc(2.25rem + 2px)'},\r\n    picksStyleLg:  {minHeight: 'calc(2.875rem + 2px)'},\r\n    picksStyleSm:  {minHeight: 'calc(1.8125rem + 2px)'},\r\n\r\n    // used in BsPickContentStylingCorrector\r\n    pickStyle: {paddingLeft: '0px', lineHeight: '1.5em'},\r\n    pickButtonStyle: {fontSize:'1.5em', lineHeight: '.9em'},\r\n    pickContentStyleDisabled: {opacity: '.65'}, // avoid opacity on pickElement's border\r\n\r\n    // used in BsChoiceContentStylingCorrector\r\n    choiceLabelStyleDisabled: {opacity: '.65'} // more flexible than {color: '#6c757d'}\r\n};\r\n\r\n(\r\n    (window, $) => {\r\n        function createPlugin(element, settings, onDispose){\r\n\r\n            if (typeof Popper === 'undefined') {\r\n                throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n            }\r\n    \r\n            let configuration = $.extend({}, settings); // settings used per jQuery intialization, configuration per element\r\n            if (configuration.buildConfiguration)\r\n                configuration.buildConfiguration(element, configuration);\r\n            \r\n            let useCss = configuration.useCss;\r\n            let styling = configuration.styling;\r\n            if (!configuration.adapter)\r\n            {\r\n                let stylingCorrector = configuration.stylingCorrector;\r\n                if (!stylingCorrector)\r\n                {\r\n                    if (!useCss)\r\n                    {\r\n                        extendIfUndefined(configuration, stylingDefaults);\r\n                        stylingCorrector = StylingCorrector(configuration);\r\n                        var defFocusIn = stylingCorrector.focusIn;\r\n                        stylingCorrector.focusIn = (picksElement) => {\r\n                            if (picksElement.classList.contains(\"is-valid\")){\r\n                                setStyles(picksElement, configuration.picksStyleFocusValid)\r\n                            } else if (picksElement.classList.contains(\"is-invalid\")){\r\n                                setStyles(picksElement, configuration.picksStyleFocusInvalid)\r\n                            } else {\r\n                                defFocusIn(picksElement)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                extendIfUndefined(configuration, classesDefaults);\r\n                styling = Styling(configuration, stylingCorrector);\r\n            }\r\n\r\n            let optionsAdapter = null;\r\n            let containerAdapter = null;\r\n            if (configuration.optionsAdapter)\r\n                optionsAdapter = configuration.optionsAdapter;\r\n            else\r\n            {\r\n                var createElement = function(name){\r\n                    return window.document.createElement(name);\r\n                }\r\n                var trigger = function(eventName){\r\n                    $(element).trigger(eventName);\r\n                }\r\n                if (configuration.options){\r\n                    optionsAdapter = OptionsAdapterJson(\r\n                        configuration.options,\r\n                        configuration.getDisabled,\r\n                        configuration.getSize,\r\n                        configuration.getIsValid,\r\n                        configuration.getIsInvalid,\r\n                        trigger );\r\n                    if (!configuration.createInputId)\r\n                        configuration.createInputId = () => `${configuration.containerClass}-generated-filter-${element.id}`;\r\n                    // find direct child by tagName\r\n                    var picksElement = findDirectChildByTagName(element, \"UL\");\r\n                    containerAdapter = ContainerAdapter(createElement, null, element, picksElement);\r\n                } \r\n                else  \r\n                {\r\n                    var selectElement = null;\r\n                    var containerElement = null;\r\n                    if (element.tagName==\"SELECT\")\r\n                        selectElement = element;\r\n                    else \r\n                    { \r\n                        selectElement = findDirectChildByTagName(element, \"SELECT\");\r\n                        if (!selectElement)\r\n                            throw \"There are no SELECT element or options in the configuraion\";\r\n                        containerElement = element;\r\n                    }\r\n\r\n                    if (!containerElement && configuration.containerClass)\r\n                    {\r\n                        var $container = $(selectElement).closest('.' + configuration.containerClass);\r\n                        if ($container.length>0)\r\n                            containerElement =  $container.get(0);\r\n                    }\r\n\r\n                    if (!configuration.label)\r\n                    {\r\n                        let $formGroup = $(selectElement).closest('.form-group');\r\n                        if ($formGroup.length == 1) {\r\n                            let $label = $formGroup.find(`label[for=\"${selectElement.id}\"]`);\r\n                            if ($label.length>0)\r\n                            {   \r\n                                let label = $label.get(0);\r\n                                let forId = label.getAttribute('for');\r\n                                if (forId == selectElement.id) {\r\n                                    configuration.label = label;\r\n                                }\r\n                            }   \r\n                        }\r\n                    }\r\n                    var $form = $(selectElement).closest('form');\r\n                    var form = null;\r\n                    if ($form.length == 1) {\r\n                        form = $form.get(0);\r\n                    }\r\n                    \r\n                    if (!configuration.getDisabled) {\r\n                        var $fieldset = $(selectElement).closest('fieldset');\r\n                    \r\n                        if ($fieldset.length == 1) {\r\n                            var fieldset = $fieldset.get(0);\r\n                            configuration.getDisabled = () => selectElement.disabled || fieldset.disabled;\r\n                        }else{\r\n                            configuration.getDisabled = () => selectElement.disabled;\r\n                        }\r\n                    }\r\n\r\n                    if (!configuration.getSize) {\r\n                        configuration.getSize = function(){\r\n                            var value=null;\r\n                            if (selectElement.classList.contains('custom-select-lg') || selectElement.classList.contains('form-control-lg') )\r\n                                value='custom-select-lg';\r\n                            else if (selectElement.classList.contains('custom-select-sm')  || selectElement.classList.contains('form-control-sm')  )\r\n                                value='custom-select-sm';\r\n                            else if (containerElement && containerElement.classList.contains('input-group-lg'))\r\n                                value='input-group-lg';\r\n                            else if (containerElement && containerElement.classList.contains('input-group-sm'))\r\n                                value='input-group-sm';\r\n                            return value;\r\n                        }\r\n                    }\r\n                    if (!configuration.getIsValid) {\r\n                        configuration.getIsValid = function()\r\n                        { return selectElement.classList.contains('is-valid')}\r\n                    }\r\n                    if (!configuration.getIsInvalid) {\r\n                        configuration.getIsInvalid = function()\r\n                        { return selectElement.classList.contains('is-invalid')}\r\n                    }\r\n                    optionsAdapter = OptionsAdapterElement(selectElement, configuration.getDisabled, \r\n                        configuration.getSize, \r\n                        configuration.getIsValid, configuration.getIsInvalid,\r\n                        trigger, form);\r\n\r\n                    if (!configuration.createInputId)\r\n                        configuration.createInputId = () => `${configuration.containerClass}-generated-input-${((selectElement.id)?selectElement.id:selectElement.name).toLowerCase()}-id`;\r\n\r\n                    \r\n                    var picksElement = null;\r\n                    if (containerElement)\r\n                        picksElement = findDirectChildByTagName(containerElement, \"UL\");\r\n                    containerAdapter = ContainerAdapter(createElement, selectElement, containerElement, picksElement);\r\n                    \r\n                }\r\n            }\r\n            let labelAdapter = LabelAdapter(configuration.label, configuration.createInputId);\r\n\r\n            let pickContentGenerator = configuration.pickContentGenerator;\r\n            if (!pickContentGenerator){\r\n                let pickContentStylingCorrector = configuration.pickContentStylingCorrector;\r\n                if (!pickContentStylingCorrector)\r\n                {\r\n                    if (!useCss){\r\n                        var  {pickStyle, pickButtonStyle, pickContentStyleDisabled} = stylingDefaults;\r\n                        extendIfUndefined(configuration,  {pickStyle, pickButtonStyle, pickContentStyleDisabled});\r\n                        pickContentStylingCorrector=BsPickContentStylingCorrector(configuration, $);\r\n                    }\r\n                }\r\n                \r\n                var  {pickClass, pickButtonClass, pickContentClassDisabled} = classesDefaults;\r\n                extendIfUndefined(configuration, {pickClass, pickButtonClass, pickContentClassDisabled});\r\n                pickContentGenerator = BsPickContentGenerator(configuration, pickContentStylingCorrector, $);\r\n            }\r\n\r\n            let choiceContentGenerator = configuration.choiceContentGenerator;\r\n            if (!choiceContentGenerator){\r\n                let choiceContentStylingCorrector = configuration.choiceContentStylingCorrector;\r\n                if (!useCss){\r\n                    var {choiceLabelStyleDisabled} = stylingDefaults;\r\n                    extendIfUndefined(configuration, {choiceLabelStyleDisabled});\r\n                    choiceContentStylingCorrector=BsChoiceContentStylingCorrector(configuration);\r\n                }\r\n                \r\n                var  {choiceClass, choiceCheckBoxClassDisabled} = classesDefaults;\r\n                extendIfUndefined(configuration, {choiceClass, choiceCheckBoxClassDisabled});\r\n                choiceContentGenerator = BsChoiceContentGenerator(configuration, choiceContentStylingCorrector)\r\n            }\r\n\r\n            let createStylingComposite = function(pickFilterElement, inputElement, choicesElement){\r\n                return {\r\n                    container: containerAdapter.containerElement,\r\n                    picks: containerAdapter.picksElement,\r\n                    pickFilter: pickFilterElement,\r\n                    input: inputElement,\r\n                    choices: choicesElement\r\n                };\r\n            }\r\n            var placeholderText = configuration.placeholder;\r\n            if (!placeholderText)\r\n            {\r\n                if (selectElement)\r\n                {\r\n                    placeholderText = $(selectElement).data(\"bsmultiselect-placeholder\");\r\n                    if (!placeholderText)\r\n                        placeholderText = $(selectElement).data(\"placeholder\");\r\n                }\r\n                else if (containerElement)                 \r\n                {\r\n                    placeholderText = $(containerElement).data(\"bsmultiselect-placeholder\");\r\n                    if (!placeholderText)\r\n                        placeholderText = $(containerElement).data(\"placeholder\");\r\n                }\r\n            }\r\n            \r\n            let setSelected = configuration.setSelected;\r\n            if (!setSelected){\r\n                setSelected = (option, value)=> { option.selected = value;}\r\n            }\r\n\r\n            var bsAppearance =  createBsAppearance(containerAdapter.picksElement, configuration, optionsAdapter);\r\n\r\n            var onUpdate = () => {\r\n                bsAppearance.updateSize();\r\n                bsAppearance.updateIsValid();\r\n            }\r\n\r\n            let multiSelect = new MultiSelect(\r\n                optionsAdapter,\r\n                setSelected,\r\n                containerAdapter,\r\n                styling,\r\n                pickContentGenerator,\r\n                choiceContentGenerator,\r\n                labelAdapter,\r\n                createStylingComposite,\r\n                placeholderText,\r\n                configuration,\r\n                onUpdate,\r\n                onDispose,\r\n                Popper,\r\n                window);\r\n            \r\n            multiSelect.UpdateSize = bsAppearance.updateSize;\r\n            multiSelect.UpdateIsValid = bsAppearance.updateIsValid;\r\n            \r\n            if (configuration.init)\r\n                configuration.init(element, multiSelect);\r\n            \r\n            multiSelect.init();\r\n\r\n            return multiSelect;\r\n        };\r\n        var defaults = {\r\n            classes: classesDefaults,\r\n            styling: stylingDefaults\r\n        };\r\n        addToJQueryPrototype('BsMultiSelect', createPlugin, defaults, $);\r\n    }\r\n)(window, $, Popper)\r\n"],"names":["extendIfUndefined","destination","source","property","undefined","createEmpty","value","forEachRecursion","f","i","prev","List","tail","count","add","e","next","node","remove","forEach","getTail","getCount","isEmpty","reset","removeElement","parentNode","removeChild","findDirectChildByTagName","element","tagName","returnValue","children","length","tmp","addClass","c","classList","removeClass","addClasses","classes","modifyClasses","removeClasses","setStyles","styles","style","modify","Array","isArray","array","split","removeChildren","toRemove","firstChild","EventBinder","list","bind","eventName","handler","addEventListener","push","unbind","removeEventListener","filterInputStyle","border","height","boxShadow","padding","margin","outline","backgroundColor","FilterPanel","createElement","insertIntoDom","onFocusIn","onFocusOut","onKeyDownArrowUp","onKeyDownArrowDown","onTabForEmpty","onBackspace","onEnterOrTabToCompleate","onKeyDownEsc","onKeyUpEsc","onInput","setEmptyLength","filterInputElement","setAttribute","onfilterInputKeyDown","event","indexOf","which","preventDefault","onFilterInputKeyUp","onFilterInputInput","filterInputValue","width","setEmpty","setFocus","focus","isEventTarget","target","dispose","choicesStyle","listStyleType","ChoicesPanel","choicesElement","onShow","onHide","eventSkipper","choiceContentGenerator","getVisibleMultiSelectDataList","resetFilter","updateChoicesLocation","filterPanelSetFocus","hoveredMultiSelectData","hoveredMultiSelectDataIndex","candidateToHoveredMultiSelectData","hideChoices","resetCandidateToHoveredMultiSelectData","display","showChoices","setSkippable","hoverInInternal","index","ChoiceContent","hoverIn","resetChoicesHover","hoverOut","choiceElement","processCandidateToHovered","visibleIndex","toggleHovered","toggle","keyDownArrow","down","visibleMultiSelectDataList","newIndex","visible","onChoiceElementMouseoverGeneral","MultiSelectData","isSkippable","insertChoice","createSelectedItemGen","setSelected","triggerChange","isSelected","onChoiceElementMouseover","onChoiceElementMouseleave","appendChild","choiceContent","option","DisposeChoiceElement","isOptionDisabled","setChoiceContentDisabled","onSelected","createSelectedItem","excludedFromSearch","confirmed","item","stopAndResetChoicesHover","getIsVisble","PicksPanel","picksElement","init","pickContentGenerator","isComponentDisabled","onClick","onPickCreated","onPickRemoved","processRemoveButtonClick","pickFilterElement","createPick","multiSelectData","pickElement","removeFromList","removeSelectedItem","pickContent","onRemoveSelectedItemEvent","disable","insertBefore","eventBinder","removePicksTail","enable","deselectAll","clear","MultiSelectInputAspect","window","appendToContainer","choiceFilterInputElement","hideChoicesAndResetFilter","isChoiceEmpty","Popper","document","skipFocusout","skipoutMousedown","documentMouseup","contains","popper","placement","modifiers","preventOverflow","enabled","hide","flip","filterInputItemOffsetLeft","preventDefaultClickEvent","alignAndShowChoices","alignToFilterInputItemLocation","force","offsetLeft","update","destroy","processUncheck","uncheckOption","setTimeout","onChoicesShow","onChoicesHide","getSkipFocusout","resetSkipFocusout","PlaceholderAspect","placeholderText","picksIsEmpty","filterIsEmpty","inputElement","setEmptyInputWidth","isVisible","showPlacehodler","placeholder","updatePlacehodlerVisibility","updateEmptyInputWidth","setDisabled","isDisabled","disabled","EventSkipper","filterMultiSelectData","isFiltered","resetChoices","MultiSelectDataList","isHidden","collectFilterChoices","text","j","searchText","MultiSelect","optionsAdapter","containerAdapter","styling","labelAdapter","createStylingComposite","configuration","onUpdate","onDispose","visibleCount","choicesPanel","stylingComposite","resetMultiSelectDataList","filteredMultiSelectDataList","filterPanel","processEmptyInput","placeholderAspect","GetContainer","containerElement","Update","UpdateDisabled","UpdateData","DeselectAll","picksPanel","SelectAll","empty","updateDataImpl","fillChoices","options","getOptions","selected","isOptionHidden","hidden","toLowerCase","trim","removeChoiceElement","o","aspect","readyState","domContentLoadedHandler","Dispose","getDisabled","Disable","Enable","input","resetLength","fullMatchMultiSelectData","name","lazyfilterItemInputElementAtach","filterItemInputElement","filterItemElement","FocusIn","FocusOut","stopPropagation","removePick","select","doUncheck","Init","attachContainer","subscribeToReset","LabelAdapter","labelElement","createInputId","backupedForAttribute","getAttribute","newId","addToJQueryPrototype","pluginName","createPlugin","defaults","$","firstChar","charAt","firstCharLower","TypeError","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","each","$e","instance","data","isMethodName","test","optionsObject","removeData","methodName","noConflict","OptionsAdapterElement","selectElement","getSize","getIsValid","getIsInvalid","trigger","form","backup","getElementsByTagName","OptionsAdapterJson","StylingCorrector","resetDisable","picksStyleDisabled","resetFocus","picksStyleFocus","elements","picks","picksStyle","focusIn","focusOut","Styling","stylingCorrector","container","containerClass","picksClass","choices","choicesClass","pickFilter","pickFilterClass","filterInputClass","picksClassDisabled","picksClassFocus","BsPickContentStylingCorrector","disablePickContent","pickContentElement","pickContentStyleDisabled","createPickContent","pickButtonElement","pickStyle","pickButtonStyle","bsPickContentGenerator","pickClass","innerHTML","querySelector","textContent","pickContentClassDisabled","float","pickButtonClass","BsPickContentGenerator","BsChoiceContentStylingCorrector","resetStyle","choiceLabelStyleDisabled","disabledStyle","choiceLabelElement","isDisbaled","bsChoiceContentGenerator","choiceClass","choiceCheckBoxElement","choiceContentElement","choiceContentClass","choiceCheckBoxClass","choiceLabelClass","choiceCheckBoxClassDisabled","checked","choiceClassHover","BsChoiceContentGenerator","flexWrap","ContainerAdapter","ownContainerElement","ownPicksElement","backupDisplay","nextSibling","updateIsValid","isValid","isInvalid","updateSize","size","updateSizeJs","picksStyleLg","picksStyleSm","picksStyleDef","updateIsValidForAdapter","updateSizeForAdapter","updateSizeJsForAdapter","createBsAppearance","useCss","Object","create","classesDefaults","choiceClassSelected","choiceClassDisabled","pickClassDisabled","stylingDefaults","marginBottom","borderColor","picksStyleFocusValid","picksStyleFocusInvalid","minHeight","paddingLeft","lineHeight","fontSize","opacity","settings","extend","buildConfiguration","adapter","defFocusIn","id","$container","closest","get","label","$formGroup","$label","find","forId","$form","$fieldset","fieldset","pickContentStylingCorrector","choiceContentStylingCorrector","bsAppearance","multiSelect","UpdateSize","UpdateIsValid"],"mappings":"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"}