{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/Bs4Commons.js","../../js/src/Bs4AdapterCss.js","../../js/src/Bs4Adapter.js","../../js/src/MultiSelect.js","../../js/src/AddToJQueryPrototype.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["class Bs4Commons {\r\n    \r\n    constructor(jQuery, hiddenSelect, dropDownItemHoverClass){\r\n        this.$=jQuery;\r\n        this.hiddenSelect=hiddenSelect;\r\n        this.dropDownItemHoverClass = dropDownItemHoverClass;\r\n    }\r\n\r\n    HandleLabel($selectedPanel, containerClass){\r\n        let inputId = this.hiddenSelect.id;\r\n        let $formGroup = this.$(this.hiddenSelect).closest('.form-group');\r\n        if ($formGroup.length == 1) {\r\n            let $label = $formGroup.find(`label[for=\"${inputId}\"]`);\r\n            let forId = $label.attr('for');\r\n            let $filterInput = $selectedPanel.find('input');\r\n            if (forId == this.hiddenSelect.id) {\r\n                let id = `${containerClass}-generated-filter-id-${this.hiddenSelect.id}`;\r\n                $filterInput.attr('id', id);\r\n                $label.attr('for', id);\r\n                return () => {\r\n                    $label.attr('for', forId);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    CreateDropDownItemContent(\r\n        $dropDownItem, optionId, itemText, isSelected,\r\n        containerClass, dropDownItemClass){\r\n        let checkBoxId = `${containerClass}-${this.hiddenSelect.name.toLowerCase()}-generated-id-${optionId.toLowerCase()}`;\r\n        let checked = isSelected ? \"checked\" : \"\";\r\n\r\n        let $dropDownItemContent= this.$(`<div class=\"custom-control custom-checkbox\">\r\n            <input type=\"checkbox\" class=\"custom-control-input\" id=\"${checkBoxId}\" ${checked}>\r\n            <label class=\"custom-control-label\" for=\"${checkBoxId}\">${itemText}</label>\r\n        </div>`)\r\n        $dropDownItemContent.appendTo($dropDownItem);\r\n        let $checkBox = $dropDownItem.find(`INPUT[type=\"checkbox\"]`);\r\n        let adoptDropDownItem = (isSelected) => {\r\n            $checkBox.prop('checked', isSelected);\r\n        }\r\n        $dropDownItem.addClass(dropDownItemClass)\r\n        return adoptDropDownItem;\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, itemText, removeSelectedItem,\r\n        selectedItemClass, removeSelectedItemButtonClass, disabled\r\n    ){\r\n        $selectedItem.addClass(selectedItemClass);\r\n        \r\n        this.$(`<span>${itemText}</span>`).appendTo($selectedItem);\r\n        let $button = this.$('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n            .addClass(removeSelectedItemButtonClass)\r\n            .css(\"white-space\", \"nowrap\")\r\n            .on(\"click\", removeSelectedItem)\r\n            .appendTo($selectedItem)\r\n            .prop(\"disabled\", disabled)\r\n        return $button;\r\n    }\r\n\r\n    FilterClick(event){\r\n        return !(event.target.nodeName == \"BUTTON\" || (event.target.nodeName == \"SPAN\" && event.target.parentElement.nodeName == \"BUTTON\"))\r\n    }\r\n\r\n    Hover($dropDownItem, isHover){\r\n        if (isHover)\r\n            $dropDownItem.addClass(this.dropDownItemHoverClass);\r\n        else\r\n            $dropDownItem.removeClass(this.dropDownItemHoverClass);\r\n    }\r\n}\r\nexport default Bs4Commons;\r\n","import Bs4Commons from \"./Bs4Commons\";\r\n\r\nclass Bs4AdapterCss {\r\n\r\n    constructor(jQuery, hiddenSelect, options) {\r\n        const defaults = {\r\n            containerClass: 'dashboardcode-bsmultiselect',\r\n            dropDownMenuClass: 'dropdown-menu',\r\n            dropDownItemClass: 'px-2',\r\n            dropDownItemHoverClass: 'text-primary bg-light',\r\n            selectedPanelClass: 'form-control',\r\n            selectedPanelFocusClass : 'focus',\r\n            selectedPanelDisabledClass: 'disabled',\r\n            selectedItemClass: 'badge',\r\n            removeSelectedItemButtonClass: 'close',\r\n            filterInputItemClass: '',\r\n            filterInputClass: ''\r\n        };\r\n        this.options = jQuery.extend({}, defaults, options);\r\n        this.jQuery=jQuery;\r\n        this.hiddenSelect=hiddenSelect;\r\n        this.bs4Commons = new Bs4Commons(jQuery, hiddenSelect, this.options.dropDownItemHoverClass);\r\n        this.bs4CommonsLabelDispose = null;\r\n    }\r\n\r\n    Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu){\r\n        $container.addClass(this.options.containerClass);\r\n        $selectedPanel.addClass(this.options.selectedPanelClass);\r\n\r\n        $dropDownMenu.addClass(this.options.dropDownMenuClass);\r\n        $filterInputItem.addClass(this.options.filterInputItemClass)\r\n        $filterInput.addClass(this.options.filterInputClass);\r\n\r\n        this.bs4CommonsLabelDispose = this.bs4Commons.HandleLabel($selectedPanel, this.options.containerClass);\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.bs4CommonsLabelDispose !== null)\r\n            this.bs4CommonsLabelDispose();\r\n    }\r\n\r\n    UpdateIsValid($selectedPanel){\r\n        let $hiddenSelect = this.jQuery(this.hiddenSelect);\r\n        if ($hiddenSelect.hasClass(\"is-valid\")){\r\n            $selectedPanel.addClass(\"is-valid\");\r\n        }\r\n\r\n        if ($hiddenSelect.hasClass(\"is-invalid\")){\r\n            $selectedPanel.addClass(\"is-invalid\");\r\n        }\r\n    }\r\n\r\n    Enable($selectedPanel, isEnabled){\r\n        if(isEnabled){\r\n            $selectedPanel.removeClass(this.options.selectedPanelDisabledClass);\r\n            $selectedPanel.find('BUTTON').prop(\"disabled\", false);\r\n        }\r\n        else{\r\n            $selectedPanel.addClass(this.options.selectedPanelDisabledClass);\r\n            $selectedPanel.find('BUTTON').prop(\"disabled\", true);\r\n        }\r\n    }\r\n\r\n    CreateDropDownItemContent($dropDownItem, optionId, itemText, isSelected){\r\n        return this.bs4Commons.CreateDropDownItemContent($dropDownItem, optionId, itemText, isSelected, this.options.containerClass, this.options.dropDownItemClass);\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, itemText, removeSelectedItem, disabled){\r\n        this.bs4Commons.CreateSelectedItemContent($selectedItem, itemText, removeSelectedItem, this.options.selectedItemClass, this.options.removeSelectedItemButtonClass, disabled);\r\n    }\r\n\r\n    \r\n    Hover($dropDownItem, isHover){\r\n        this.bs4Commons.Hover($dropDownItem, isHover);\r\n    }\r\n\r\n    FilterClick(event){\r\n        return this.bs4Commons.FilterClick(event)\r\n    }\r\n\r\n    Focus($selectedPanel, isFocused){\r\n        if (isFocused){\r\n            $selectedPanel.addClass(this.options.selectedPanelFocusClass);\r\n        }else{\r\n            $selectedPanel.removeClass(this.options.selectedPanelFocusClass);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Bs4AdapterCss;\r\n","import Bs4Commons from \"./Bs4Commons\";\r\n//import styles from './../../scss/BsMutliSelect.scss'\r\n\r\nclass Bs4Adapter {\r\n\r\n    constructor(jQuery, hiddenSelect, options) {\r\n        const defaults = {\r\n            selectedPanelDefMinHeight: 'calc(2.25rem + 2px)',\r\n            selectedPanelLgMinHeight: 'calc(2.875rem + 2px)',\r\n            selectedPanelSmMinHeight: 'calc(1.8125rem + 2px)',\r\n            selectedPanelDisabledBackgroundColor: '#e9ecef',\r\n            selectedPanelFocusBorderColor: '#80bdff',\r\n            selectedPanelFocusBoxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)',\r\n            selectedPanelFocusValidBoxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)',\r\n            selectedPanelFocusInvalidBoxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)',\r\n            filterInputColor: '#495057'\r\n        };\r\n        this.options = jQuery.extend({}, defaults, options);\r\n        this.jQuery=jQuery;\r\n        this.hiddenSelect=hiddenSelect;\r\n\r\n        this.containerClass= 'dashboardcode-bsmultiselect';\r\n        this.dropDownMenuClass= 'dropdown-menu';\r\n        this.dropDownItemClass= 'px-2';\r\n        this.dropDownItemHoverClass= 'text-primary bg-light';\r\n        this.selectedPanelClass= 'form-control';\r\n        this.selectedItemClass= 'badge';\r\n        this.removeSelectedItemButtonClass= 'close';\r\n\r\n        this.selectedPanelStyle= {'margin-bottom': '0'};\r\n        this.selectedItemStyle= {'padding-left': '0px', 'line-height': '1.5em'};\r\n        this.removeSelectedItemButtonStyle= {'font-size':'1.5em', 'line-height': '.9em'};\r\n\r\n        this.bs4Commons = new Bs4Commons(jQuery, hiddenSelect, this.dropDownItemHoverClass);\r\n        this.bs4CommonsLabelDispose = null;\r\n    }\r\n\r\n    Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu){\r\n\r\n        $container.addClass(this.containerClass);\r\n        $selectedPanel.addClass(this.selectedPanelClass);\r\n        $selectedPanel.css(this.selectedPanelStyle);\r\n\r\n        $dropDownMenu.addClass(this.dropDownMenuClass);\r\n        $filterInput.css(\"color\", this.options.filterInputColor);\r\n\r\n        this.bs4CommonsLabelDispose = this.bs4Commons.HandleLabel($selectedPanel, this.containerClass);\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.bs4CommonsLabelDispose !== null)\r\n            this.bs4CommonsLabelDispose();\r\n    }\r\n    \r\n    UpdateIsValid($selectedPanel){\r\n        let $hiddenSelect = this.jQuery(this.hiddenSelect);\r\n        if ($hiddenSelect.hasClass(\"is-valid\")){\r\n            $selectedPanel.addClass(\"is-valid\");\r\n        }\r\n\r\n        if ($hiddenSelect.hasClass(\"is-invalid\")){\r\n            $selectedPanel.addClass(\"is-invalid\");\r\n        }\r\n    }\r\n\r\n    UpdateSize($selectedPanel){\r\n        if ($selectedPanel.hasClass(\"form-control-lg\")){\r\n            $selectedPanel.css(\"min-height\", this.options.selectedPanelLgMinHeight);\r\n        } else if ($selectedPanel.hasClass(\"form-control-sm\")){\r\n            $selectedPanel.css(\"min-height\", this.options.selectedPanelSmMinHeight);\r\n        } else {\r\n            $selectedPanel.css(\"min-height\", this.options.selectedPanelDefMinHeight);\r\n        }\r\n    }\r\n\r\n    Enable($selectedPanel, isEnabled){\r\n        if(isEnabled){\r\n            $selectedPanel.css({\"background-color\": \"\"});\r\n            $selectedPanel.find('BUTTON').prop(\"disabled\", false);\r\n        }\r\n        else{\r\n            $selectedPanel.css({\"background-color\": this.options.selectedPanelDisabledBackgroundColor});\r\n            $selectedPanel.find('BUTTON').prop(\"disabled\", true);\r\n        }\r\n    }\r\n\r\n    CreateDropDownItemContent($dropDownItem, optionId, itemText, isSelected){\r\n        return this.bs4Commons.CreateDropDownItemContent($dropDownItem, optionId, itemText, isSelected, this.containerClass, this.dropDownItemClass)\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, itemText, removeSelectedItem, disabled){\r\n        let $buttom = this.bs4Commons.CreateSelectedItemContent($selectedItem, itemText, removeSelectedItem, this.selectedItemClass, this.removeSelectedItemButtonClass, disabled);\r\n        $buttom.css(this.removeSelectedItemButtonStyle);\r\n        $selectedItem.css(this.selectedItemStyle);\r\n    }\r\n\r\n    Hover($dropDownItem, isHover){\r\n        this.bs4Commons.Hover($dropDownItem, isHover);\r\n    }\r\n\r\n    FilterClick(event){\r\n        return this.bs4Commons.FilterClick(event)\r\n    }\r\n\r\n    Focus($selectedPanel, isFocused){\r\n        if (isFocused){\r\n                if ($selectedPanel.hasClass(\"is-valid\")){\r\n                    $selectedPanel.css(\"box-shadow\", this.options.selectedPanelFocusValidBoxShadow);\r\n                } else if ($selectedPanel.hasClass(\"is-invalid\")){\r\n                    $selectedPanel.css(\"box-shadow\", this.options.selectedPanelFocusInvalidBoxShadow);\r\n                } else {\r\n                    $selectedPanel\r\n                        .css(\"box-shadow\", this.options.selectedPanelFocusBoxShadow)\r\n                        .css(\"border-color\", this.options.selectedPanelFocusBorderColor);\r\n                }\r\n        }else{\r\n            $selectedPanel.css(\"box-shadow\", \"\" ).css(\"border-color\", \"\")\r\n        }\r\n    }\r\n}\r\n\r\nexport default Bs4Adapter;\r\n","import Popper from 'popper.js'\r\n\r\nconst defSelectedPanelStyleSys = {'display':'flex', 'flex-wrap':'wrap', 'list-style-type':'none'};  // remove bullets since this is ul\r\nconst defFilterInputStyleSys   = {'width':'2ch', 'border':'0', 'padding':'0', 'outline':'none', 'background-color':'transparent' };\r\nconst defDropDownMenuStyleSys  = {'list-style-type':'none'}; // remove bullets since this is ul\r\n\r\n// jQuery used for:\r\n// $.extend, $.contains, $(\"<div>\"), $(function(){}) aka ready\r\n// $e.trigger, $e.unbind, $e.on; but namespaces are not used;\r\n// events: \"focusin\", \"focusout\", \"mouseover\", \"mouseout\", \"keydown\", \"keyup\", \"click\"\r\n// $e.show, $e.hide, $e.focus, $e.css\r\n// $e.appendTo, $e.remove, $e.find, $e.closest, $e.prev, $e.data, $e.val\r\n\r\nclass MultiSelect {\r\n    constructor(selectElement, options, adapter, window, $) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n        // readonly\r\n        this.selectElement = selectElement;\r\n        this.adapter = adapter;\r\n        this.window = window;\r\n        this.$ = $;\r\n        \r\n        this.options = $.extend({}, options);\r\n        \r\n        this.container = null;\r\n        this.selectedPanel = null;\r\n        this.filterInputItem = null;\r\n        this.filterInput = null;\r\n        this.dropDownMenu = null;\r\n        this.popper = null;\r\n        // removable handlers\r\n        this.selectedPanelClick  = null;\r\n        this.documentMouseup   = null;\r\n        this.containerMousedown   = null;\r\n        this.documentMouseup2   = null;\r\n        // state\r\n        this.disabled=null;\r\n        this.filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n        this.skipFocusout = false;\r\n        this.hoveredDropDownItem = null;\r\n        this.hoveredDropDownIndex = null;\r\n        this.hasDropDownVisible = false;\r\n\r\n        // jquery adapters\r\n        this.$document= $(window.document);\r\n        this.init();\r\n    }\r\n    updateDropDownPosition(force) {\r\n        let offsetLeft = this.filterInputItem.offsetLeft;\r\n        if (force || this.filterInputItemOffsetLeft!=offsetLeft){\r\n            this.popper.update();\r\n            this.filterInputItemOffsetLeft=offsetLeft;\r\n        }\r\n    }\r\n    hideDropDown() {\r\n        this.dropDownMenu.style.display = 'none';\r\n    }\r\n    showDropDown() {\r\n        this.dropDownMenu.style.display = 'block';\r\n    }\r\n    // Public methods\r\n    resetDropDownMenuHover() {\r\n        if (this.hoveredDropDownItem !== null) {\r\n            this.adapter.Hover(this.$(this.hoveredDropDownItem), false);\r\n            this.hoveredDropDownItem = null;\r\n        }\r\n        this.hoveredDropDownIndex = null;\r\n    }\r\n    filterDropDownMenu() {\r\n        let text = this.filterInput.value.trim().toLowerCase();\r\n        let visible = 0;\r\n        this.$(this.dropDownMenu).find('LI').each((i, dropDownMenuItem) => {\r\n            let $dropDownMenuItem = this.$(dropDownMenuItem);\r\n            if (text == '') {\r\n                $dropDownMenuItem.show();\r\n                visible++;\r\n            }\r\n            else {\r\n                let itemText = $dropDownMenuItem.data(\"option-text\");\r\n                let isSelected = $dropDownMenuItem.data(\"option-selected\");\r\n                if (!isSelected && itemText.indexOf(text)>=0) {\r\n                    $dropDownMenuItem.show();\r\n                    visible++;\r\n                } else {\r\n                    $dropDownMenuItem.hide();\r\n                }\r\n            }\r\n        });\r\n        this.hasDropDownVisible = visible > 0;\r\n        this.resetDropDownMenuHover();\r\n    }\r\n    clearFilterInput(updatePosition) {\r\n        if (this.filterInput.value) {\r\n            this.filterInput.value = '';\r\n            this.input(updatePosition);\r\n        }\r\n    }\r\n    closeDropDown() {\r\n        this.resetDropDownMenuHover();\r\n        this.clearFilterInput(true);\r\n        this.hideDropDown();\r\n    }\r\n    appendDropDownItem(optionElement) {\r\n        let optionId = optionElement.value;\r\n        let itemText = optionElement.text;\r\n        let isSelected = optionElement.selected;\r\n        let $dropDownItem = this.$(\"<LI/>\");\r\n        $dropDownItem.data(\"option-id\", optionId);\r\n        $dropDownItem.data(\"option-text\", itemText.toLowerCase());\r\n        let adoptDropDownItem = this.adapter.CreateDropDownItemContent($dropDownItem, optionId, itemText, isSelected)\r\n        $dropDownItem.appendTo(this.dropDownMenu);\r\n        let appendItem = (doTrigger) => {\r\n            $dropDownItem.data(\"option-selected\", true);\r\n            let $selectedItem = this.$(\"<LI/>\");\r\n            $selectedItem.data(\"option-id\", optionId);\r\n            optionElement.selected = true;\r\n            adoptDropDownItem(true);\r\n            let removeItem = () => {\r\n                $dropDownItem.data(\"option-selected\", false);\r\n                $dropDownItem.data(\"option-toggle\", appendItem);\r\n                $selectedItem.data(\"option-remove\", null);\r\n                $selectedItem.remove();\r\n                optionElement.selected = false;\r\n                adoptDropDownItem(false);\r\n                this.$(this.selectElement).trigger('change');\r\n            };\r\n            let removeItemAndCloseDropDown = () => {\r\n                removeItem();\r\n                this.closeDropDown();\r\n            };\r\n            this.adapter.CreateSelectedItemContent(\r\n                $selectedItem,\r\n                itemText,\r\n                removeItemAndCloseDropDown,\r\n                this.disabled\r\n            );\r\n            $selectedItem.insertBefore(this.filterInputItem);\r\n            $dropDownItem.data(\"option-toggle\", removeItem);\r\n            $selectedItem.data(\"option-remove\", removeItemAndCloseDropDown);\r\n            if (typeof doTrigger === \"undefined\" || doTrigger===true)\r\n                this.$(this.selectElement).trigger('change');\r\n            return $selectedItem;\r\n        }\r\n        $dropDownItem.data(\"option-toggle\", appendItem );\r\n        \r\n        if (isSelected) {\r\n            appendItem(false);\r\n        }\r\n        let manageHover = (event, isOn) => {\r\n            this.adapter.Hover(this.$(event.target).closest(\"LI\"), isOn)\r\n        }\r\n        $dropDownItem.click(event => {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            let toggleItem = this.$(event.currentTarget).closest(\"LI\").data(\"option-toggle\");\r\n            toggleItem();\r\n            this.filterInput.focus();\r\n        }).mouseover(e => manageHover(e, true)).mouseout(e => manageHover(e, false));\r\n    }\r\n    keydownArrow(down) {\r\n        let visibleNodeListArray = this.$(this.dropDownMenu).find('LI:not([style*=\"display: none\"])').toArray();\r\n        if (visibleNodeListArray.length > 0) {\r\n            if (this.hasDropDownVisible) {\r\n                this.updateDropDownPosition(true);\r\n                this.showDropDown();\r\n            }\r\n            if (this.hoveredDropDownItem === null) {\r\n                this.hoveredDropDownIndex = down ? 0 : visibleNodeListArray.length - 1;\r\n            }\r\n            else {\r\n                this.adapter.Hover(this.$(this.hoveredDropDownItem), false);\r\n                if (down) {\r\n                    let newIndex = this.hoveredDropDownIndex + 1;\r\n                    this.hoveredDropDownIndex = newIndex < visibleNodeListArray.length ? newIndex : 0;\r\n                } else {\r\n                    let newIndex = this.hoveredDropDownIndex - 1;\r\n                    this.hoveredDropDownIndex = newIndex >= 0 ? newIndex : visibleNodeListArray.length - 1;\r\n                }\r\n            }\r\n            this.hoveredDropDownItem = visibleNodeListArray[this.hoveredDropDownIndex];\r\n            this.adapter.Hover(this.$(this.hoveredDropDownItem), true);\r\n        }\r\n    }\r\n    input(forceUpdatePosition) {\r\n        this.filterInput.style.width = this.filterInput.value.length*1.3 + 2 + \"ch\";\r\n        this.filterDropDownMenu();\r\n        if (this.hasDropDownVisible) {\r\n            if (forceUpdatePosition) // ignore it if it is called from\r\n                this.updateDropDownPosition(forceUpdatePosition); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.showDropDown();\r\n        } else {\r\n            this.hideDropDown();\r\n        }\r\n    }\r\n    Update(){\r\n        let $selectedPanel = this.$(this.selectedPanel);\r\n        this.adapter.UpdateIsValid($selectedPanel);\r\n        this.UpdateSizeImpl($selectedPanel);\r\n        this.UpdateDisabledImpl(this.$(this.container), $selectedPanel);\r\n    }\r\n    Dispose(){\r\n        // removable handlers\r\n        this.$document.unbind(\"mouseup\", this.documentMouseup)\r\n                      .unbind(\"mouseup\", this.documentMouseup2);\r\n        \r\n        if (this.adapter !== null) {\r\n            this.adapter.Dispose()\r\n        }\r\n        if (this.popper !== null) {\r\n            this.popper.destroy()\r\n        }\r\n        \r\n        if (this.container !== null) {\r\n            this.$(this.container).remove();\r\n        }\r\n        // this.selectedPanel = null;\r\n        // this.filterInputItem = null;\r\n        // this.filterInput = null;\r\n        // this.dropDownMenu = null;\r\n        // this.selectElement = null;\r\n        // this.options = null;\r\n    }\r\n    UpdateSize(){\r\n        this.UpdateSizeImpl(this.$(this.selectedPanel));\r\n    }\r\n    UpdateDisabled(){\r\n        this.UpdateDisabledImpl(this.$(this.container), this.$(this.selectedPanel));\r\n    }\r\n    UpdateSizeImpl($selectedPanel){\r\n        if (this.adapter.UpdateSize)\r\n            this.adapter.UpdateSize($selectedPanel);\r\n    }\r\n    UpdateDisabledImpl($container, $selectedPanel){\r\n        let disabled = this.selectElement.disabled;\r\n        if (this.disabled!==disabled){\r\n            if (disabled) {\r\n                this.filterInput.style.display = \"none\";\r\n                this.adapter.Enable($selectedPanel, false);\r\n\r\n                $container.unbind(\"mousedown\", this.containerMousedown);\r\n                this.$document.unbind(\"mouseup\", this.documentMouseup);\r\n\r\n                $selectedPanel.unbind(\"click\", this.selectedPanelClick);\r\n                this.$document.unbind(\"mouseup\", this.documentMouseup2);\r\n                \r\n            } else {\r\n                this.filterInput.style.display = \"inline-block\";\r\n                this.adapter.Enable($selectedPanel, true);\r\n\r\n                $container.mousedown(this.containerMousedown);    // removable\r\n                this.$document.mouseup(this.documentMouseup); // removable\r\n\r\n                $selectedPanel.click(this.selectedPanelClick);     // removable\r\n                this.$document.mouseup(this.documentMouseup2); // removable\r\n            }\r\n            this.disabled=disabled;\r\n        }\r\n    }\r\n    init() {\r\n        let $selectElement = this.$(this.selectElement);\r\n        $selectElement.hide();\r\n        let $container = this.$(\"<DIV/>\");\r\n        this.container = $container.get(0);\r\n        let $selectedPanel = this.$(\"<UL/>\");\r\n        $selectedPanel.css(defSelectedPanelStyleSys);\r\n        \r\n        this.selectedPanel = $selectedPanel.get(0);\r\n        \r\n        $selectedPanel.appendTo(this.container);\r\n        let $filterInputItem = this.$('<LI/>');\r\n        this.filterInputItem = $filterInputItem.get(0)\r\n        $filterInputItem.appendTo(this.selectedPanel);\r\n        let $filterInput = this.$('<INPUT type=\"search\" autocomplete=\"off\">');\r\n        $filterInput.css(defFilterInputStyleSys);\r\n        $filterInput.appendTo(this.filterInputItem);\r\n        this.filterInput = $filterInput.get(0);\r\n        let $dropDownMenu = this.$(\"<UL/>\")\r\n            .css({\"display\":\"none\"})\r\n            .appendTo($container);\r\n        this.dropDownMenu = $dropDownMenu.get(0);\r\n        \r\n        // prevent heavy understandable styling error\r\n        $dropDownMenu.css(defDropDownMenuStyleSys);\r\n        // create handlers\r\n        this.documentMouseup = () => {\r\n            this.skipFocusout = false;\r\n        }\r\n\r\n        this.containerMousedown = () => {\r\n            this.skipFocusout = true;\r\n        };\r\n        this.documentMouseup2 = event => {\r\n            if (!(this.container === event.target || this.$.contains(this.container, event.target))) {\r\n                this.closeDropDown();\r\n            }\r\n        }\r\n        this.selectedPanelClick = event => {\r\n            if (event.target.nodeName != \"INPUT\")\r\n                this.$(this.filterInput).val('').focus();\r\n            if (this.hasDropDownVisible && this.adapter.FilterClick(event)){\r\n                this.updateDropDownPosition(true);\r\n                this.showDropDown();\r\n            }\r\n        };\r\n        this.adapter.Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu);\r\n        $container.insertAfter($selectElement);\r\n        \r\n        this.popper = new Popper(this.filterInput, this.dropDownMenu, {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: { enabled:false }\r\n                }\r\n        });\r\n        this.adapter.UpdateIsValid($selectedPanel);\r\n        this.UpdateSizeImpl($selectedPanel);\r\n        this.UpdateDisabledImpl($container, $selectedPanel);\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        // bellow: ready shortcut\r\n        this.$(() => {\r\n            let selectOptions = $selectElement.find('OPTION');\r\n            selectOptions.each(\r\n                (index, optionElement) => {\r\n                    this.appendDropDownItem(optionElement);\r\n                }\r\n            );\r\n            this.hasDropDownVisible = selectOptions.length > 0;\r\n            this.updateDropDownPosition(false);\r\n        });\r\n        $dropDownMenu.click( event => event.stopPropagation());\r\n        $dropDownMenu.mouseover(() => this.resetDropDownMenuHover());\r\n\r\n        $filterInput.focusin(() => this.adapter.Focus($selectedPanel, true))\r\n                    .focusout(() => {\r\n                            if (!this.skipFocusout)\r\n                                this.adapter.Focus($selectedPanel, false)\r\n                            });\r\n        $filterInput.on(\"keydown\", (event) => {\r\n            if (event.which == 38) {\r\n                event.preventDefault();\r\n                this.keydownArrow(false);\r\n            }\r\n            else if (event.which == 40) {\r\n                event.preventDefault()\r\n                this.keydownArrow(true);\r\n            }\r\n            else if (event.which == 13) {\r\n                event.preventDefault();\r\n            }\r\n            else if (event.which == 9) {\r\n                if (this.filterInput.value) {\r\n                    event.preventDefault();\r\n                }\r\n                else {\r\n                    this.closeDropDown();\r\n                }\r\n            }\r\n            else {\r\n                if (event.which == 8) {\r\n                    // NOTE: this will process backspace only if there are no text in the input field\r\n                    // If user will find this inconvinient, we will need to calculate something like this\r\n                    // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n                    if (!this.filterInput.value)\r\n                    {\r\n                        let $penult = this.$(this.selectedPanel).find(\"LI:last\").prev();\r\n                        if ($penult.length){\r\n                            let removeItem = $penult.data(\"option-remove\");\r\n                            removeItem();\r\n                        }\r\n                        this.updateDropDownPosition(false);\r\n                    }\r\n                }\r\n                this.resetDropDownMenuHover();\r\n            }\r\n        });\r\n        $filterInput.on(\"keyup\", (event) => {\r\n            if (event.which == 13 || event.which == 9 ) {\r\n                if (this.hoveredDropDownItem) {\r\n                    let $hoveredDropDownItem = this.$(this.hoveredDropDownItem);\r\n                    let toggleItem =  $hoveredDropDownItem.data(\"option-toggle\");\r\n                    toggleItem();\r\n                    this.closeDropDown();\r\n                } else {\r\n                    let text = this.filterInput.value.trim().toLowerCase();\r\n                    let dropDownItems = this.dropDownMenu.querySelectorAll(\"LI\");\r\n                    let dropDownItem = null;\r\n                    for (let i = 0; i < dropDownItems.length; ++i) {\r\n                        let it = dropDownItems[i];\r\n                        if (it.textContent.trim().toLowerCase() == text)\r\n                        {\r\n                            dropDownItem=it;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (dropDownItem) {\r\n                        let $dropDownItem = this.$(dropDownItem);\r\n                        let isSelected = $dropDownItem.data(\"option-selected\");\r\n                        if (!isSelected){\r\n                            let toggle = $dropDownItem.data(\"option-toggle\");\r\n                            toggle();\r\n                        }\r\n                        this.clearFilterInput(true);\r\n                    }\r\n                }\r\n            }\r\n            else if (event.which == 27) { // escape\r\n                this.closeDropDown();\r\n            }\r\n        });\r\n        $filterInput.on('input', () => {\r\n            this.input(true);\r\n        });\r\n    }\r\n}\r\n\r\nexport default MultiSelect;\r\n","function AddToJQueryPrototype(pluginName, createPlugin, $){\r\n    const prototypedName = pluginName.charAt(0).toLowerCase() + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypedName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            let isDispose = s => /Dispose/.test(s)\r\n            if (!instance) {\r\n                if (isMethodName && isDispose(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject);\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (isDispose(methodName)) {\r\n                    $e.removeData(dataKey).off(dataKey);\r\n                    instance.Dispose();\r\n                }\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named \"${methodName}\"`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypedName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance for 1st $selected item\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypedName].noConflict = function () {\r\n        $.fn[prototypedName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n}\r\n\r\nexport default AddToJQueryPrototype\r\n","import $ from 'jquery'\r\nimport Bs4AdapterCss from './Bs4AdapterCss'\r\nimport Bs4Adapter from './Bs4Adapter'\r\nimport MultiSelect from './MultiSelect'\r\nimport AddToJQueryPrototype from './AddToJQueryPrototype'\r\n\r\n(\r\n    (window, $) => {\r\n        AddToJQueryPrototype('BsMultiSelect',\r\n            (element, optionsObject) => {\r\n                let adapter = optionsObject && optionsObject.useCss\r\n                ? new Bs4AdapterCss($, element, optionsObject)\r\n                : new Bs4Adapter($, element, optionsObject);\r\n                return new MultiSelect(element, optionsObject, adapter, window, $);\r\n            }, $);\r\n    }\r\n)(window, $)\r\n"],"names":["Bs4Commons","jQuery","hiddenSelect","dropDownItemHoverClass","$","HandleLabel","$selectedPanel","containerClass","inputId","id","$formGroup","closest","length","$label","find","forId","attr","$filterInput","CreateDropDownItemContent","$dropDownItem","optionId","itemText","isSelected","dropDownItemClass","checkBoxId","name","toLowerCase","checked","$dropDownItemContent","appendTo","$checkBox","adoptDropDownItem","prop","addClass","CreateSelectedItemContent","$selectedItem","removeSelectedItem","selectedItemClass","removeSelectedItemButtonClass","disabled","$button","css","on","FilterClick","event","target","nodeName","parentElement","Hover","isHover","removeClass","Bs4AdapterCss","options","defaults","dropDownMenuClass","selectedPanelClass","selectedPanelFocusClass","selectedPanelDisabledClass","filterInputItemClass","filterInputClass","extend","bs4Commons","bs4CommonsLabelDispose","Init","$container","$filterInputItem","$dropDownMenu","Dispose","UpdateIsValid","$hiddenSelect","hasClass","Enable","isEnabled","Focus","isFocused","Bs4Adapter","selectedPanelDefMinHeight","selectedPanelLgMinHeight","selectedPanelSmMinHeight","selectedPanelDisabledBackgroundColor","selectedPanelFocusBorderColor","selectedPanelFocusBoxShadow","selectedPanelFocusValidBoxShadow","selectedPanelFocusInvalidBoxShadow","filterInputColor","selectedPanelStyle","selectedItemStyle","removeSelectedItemButtonStyle","UpdateSize","$buttom","defSelectedPanelStyleSys","defFilterInputStyleSys","defDropDownMenuStyleSys","MultiSelect","selectElement","adapter","window","Popper","TypeError","container","selectedPanel","filterInputItem","filterInput","dropDownMenu","popper","selectedPanelClick","documentMouseup","containerMousedown","documentMouseup2","filterInputItemOffsetLeft","skipFocusout","hoveredDropDownItem","hoveredDropDownIndex","hasDropDownVisible","$document","document","init","updateDropDownPosition","force","offsetLeft","update","hideDropDown","style","display","showDropDown","resetDropDownMenuHover","filterDropDownMenu","text","value","trim","visible","each","i","dropDownMenuItem","$dropDownMenuItem","show","data","indexOf","hide","clearFilterInput","updatePosition","input","closeDropDown","appendDropDownItem","optionElement","selected","appendItem","doTrigger","removeItem","remove","trigger","removeItemAndCloseDropDown","insertBefore","manageHover","isOn","click","preventDefault","stopPropagation","toggleItem","currentTarget","focus","mouseover","e","mouseout","keydownArrow","down","visibleNodeListArray","toArray","newIndex","forceUpdatePosition","width","Update","UpdateSizeImpl","UpdateDisabledImpl","unbind","destroy","UpdateDisabled","mousedown","mouseup","$selectElement","get","contains","val","insertAfter","placement","modifiers","preventOverflow","enabled","flip","selectOptions","index","focusin","focusout","which","$penult","prev","$hoveredDropDownItem","dropDownItems","querySelectorAll","dropDownItem","it","textContent","toggle","AddToJQueryPrototype","pluginName","createPlugin","prototypedName","charAt","slice","noConflictPrototypable","fn","dataKey","prototypable","$e","instance","isMethodName","isDispose","test","s","optionsObject","methodName","removeData","off","noConflict","element","useCss"],"mappings":"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"}