{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/FilterPanel.js","../../js/src/OptionsPanel.js","../../js/src/removeElement.js","../../js/src/SelectionsPanel.js","../../js/src/MultiSelectInputAspect.js","../../js/src/MultiSelect.js","../../js/src/LabelAdapter.js","../../js/src/OptionsAdapters.js","../../js/src/Tools.js","../../js/src/Bs4StylingMethodCss.js","../../js/src/Bs4StylingMethodJs.js","../../js/src/Bs4Styling.js","../../js/src/AddToJQueryPrototype.js","../../js/src/Bs4SelectedItemContent.js","../../js/src/Bs4DropDownItemContent.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["function defFilterInputStyleSys(s) {s.width='2ch'; s.border='0'; s.padding='0'; s.outline='none'; s.backgroundColor='transparent' };\r\n\r\nfunction FilterPanel(\r\n        document,\r\n        insertIntoDom,\r\n        onFilterInputFocusIn,  // show dropdown\r\n        onFilterInputFocusOut, // hide dropdown\r\n        keyDownArrowUp, \r\n        keyDownArrowDown,\r\n        hideDropDown,  // tab on empty\r\n        removeSelectedTail, // backspace alike\r\n        toggleHovered, // \"compleate alike\"\r\n        resetFilterAndHideDropDown, // \"esc\" alike\r\n        input // filter\r\n    ) {\r\n    \r\n    var filterInput = document.createElement('INPUT'); \r\n    \r\n    filterInput.setAttribute(\"type\",\"search\");\r\n    filterInput.setAttribute(\"autocomplete\",\"off\");\r\n\r\n    defFilterInputStyleSys(filterInput.style);\r\n\r\n    insertIntoDom(filterInput);\r\n\r\n    var onfilterInputKeyDown = (event) => {\r\n        if ([38, 40, 13 ,27].indexOf(event.which)>=0 || (event.which == 9 && filterInput.value) ) {\r\n            event.preventDefault(); // for 9 it enables keyup\r\n        }\r\n\r\n        if (event.which == 38) {\r\n            keyDownArrowUp();\r\n        }\r\n        else if (event.which == 40) {\r\n            keyDownArrowDown();\r\n        }\r\n        else if (event.which == 9  /*tab*/) { // no keydown for this\r\n            if (!filterInput.value) {\r\n                 hideDropDown(); // filter is empty, nothing to reset\r\n            }\r\n        }\r\n        else if (event.which == 8 /*backspace*/) {\r\n            // NOTE: this will process backspace only if there are no text in the input field\r\n            // If user will find this inconvinient, we will need to calculate something like this\r\n            // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n            if (!filterInput.value)\r\n            { \r\n                removeSelectedTail();\r\n            }\r\n        }\r\n\r\n        //if ([38, 40, 13, 9].indexOf(event.which)==-1)\r\n        //    resetDropDownMenuHover();\r\n    }\r\n    \r\n    var onFilterInputKeyUp = (event) => {\r\n        if (event.which == 13 || event.which == 9) {\r\n            toggleHovered();\r\n        }\r\n        else if (event.which == 27) { // escape\r\n            resetFilterAndHideDropDown();\r\n        }\r\n    }\r\n    \r\n    // it can be initated by 3PP functionality\r\n    // sample (1) BS functionality - input x button click - clears input\r\n    // sample (2) BS functionality - esc keydown - clears input\r\n    // and there could be difference in processing: (2) should hide the menu, then reset , when (1) should just reset without hiding.\r\n    var onFilterInputInput = () => {\r\n        var filterInputValue = filterInput.value;\r\n        input(\r\n            filterInputValue, \r\n            ()=> filterInput.style.width = filterInputValue.length*1.3 + 2 + \"ch\"\r\n        );\r\n    }\r\n    \r\n    var setEmptyLength =() =>{\r\n        filterInput.style.width=\"2ch\";\r\n    }\r\n\r\n    var setEmpty= ()=> {\r\n        filterInput.value ='';\r\n        setEmptyLength();\r\n    };\r\n\r\n    filterInput.addEventListener('focusin', onFilterInputFocusIn);\r\n    filterInput.addEventListener('focusout', onFilterInputFocusOut);\r\n    filterInput.addEventListener('keydown', onfilterInputKeyDown);    \r\n    filterInput.addEventListener('keyup', onFilterInputKeyUp);\r\n    filterInput.addEventListener('input', onFilterInputInput);\r\n\r\n    var filterPanel = {\r\n        input:filterInput,\r\n        isEmpty(){\r\n            return filterInput.value ? false:true;\r\n        },\r\n        setEmpty,\r\n        setEmptyLength,\r\n        setFocus(){\r\n            filterInput.focus();\r\n        },\r\n        isEventTarget(event){\r\n            return event.target == filterInput;\r\n        },\r\n        dispose(){\r\n            filterInput.removeEventListener('focusin', onFilterInputFocusIn);\r\n            filterInput.removeEventListener('focusout', onFilterInputFocusOut);\r\n            filterInput.removeEventListener('keydown', onfilterInputKeyDown);\r\n            filterInput.removeEventListener('keyup', onFilterInputKeyUp);\r\n            filterInput.removeEventListener('input', onFilterInputInput);\r\n        }\r\n    }\r\n    return filterPanel;\r\n}\r\n\r\nexport default FilterPanel;\r\n","function defDropDownMenuStyleSys(s) {s.listStyleType='none'}; // remove bullets since this is ul\r\n\r\nfunction OptionsPanel(document, container, dropDownItemContent, styling, \r\n        getVisibleMultiSelectDataList, resetFilter,updateDropDownLocation, filterPanelSetFocus) {\r\n    var dropDownMenu = document.createElement('UL');\r\n    dropDownMenu.style.display=\"none\";\r\n\r\n    // prevent heavy understandable styling error\r\n    defDropDownMenuStyleSys(dropDownMenu.style);\r\n    var hoveredMultiSelectData=null;\r\n    var hoveredMultiSelectDataIndex = null;\r\n    var candidateToHoveredMultiSelectData=null;\r\n\r\n    var skipFocusout = false;\r\n    var inShowDropDown = false;\r\n    \r\n    // we want to escape the closing of the menu on a user's click inside the container\r\n    var containerMousedown = function(){\r\n        skipFocusout = true;\r\n    };    \r\n                \r\n    // TODO : this.containerMousedown , this.documentMouseup and filterInput.focusOut are actual only when menu is open\r\n    var documentMouseup = function(event) {\r\n        // if click outside container - close dropdown\r\n        if (!(container === event.target || container.contains(event.target))) {\r\n            hideDropDown();\r\n            resetFilter();\r\n        }\r\n    }\r\n\r\n    function setInShowDropDown(){\r\n        inShowDropDown = true;\r\n            setTimeout( () => {  \r\n                inShowDropDown = null;\r\n            }, 0)\r\n    }    \r\n\r\n    function hideDropDown() {\r\n        if (candidateToHoveredMultiSelectData){\r\n            resetCandidateToHoveredMultiSelectData();\r\n        }\r\n        if (dropDownMenu.style.display != 'none')\r\n        {\r\n            dropDownMenu.style.display = 'none';\r\n            // remove listeners that manages close dropdown on input's focusout and click outside container\r\n            container.removeEventListener(\"mousedown\", containerMousedown);\r\n            document.removeEventListener(\"mouseup\", documentMouseup);\r\n        }\r\n    }\r\n\r\n    function showDropDown() {\r\n        if (dropDownMenu.style.display != 'block')\r\n        {\r\n            setInShowDropDown();\r\n            dropDownMenu.style.display = 'block';\r\n            // remove listeners that manages close dropdown on input's focusout and click outside container\r\n            container.addEventListener(\"mousedown\", containerMousedown);\r\n            document.addEventListener(\"mouseup\", documentMouseup);\r\n        }\r\n    }\r\n\r\n    var hoverInInternal = function(index){\r\n        hoveredMultiSelectDataIndex = index;\r\n        hoveredMultiSelectData = getVisibleMultiSelectDataList()[index];\r\n        styling.HoverIn(hoveredMultiSelectData.dropDownMenuItemElement);\r\n    }\r\n\r\n    function resetDropDownMenuHover() {\r\n        if (hoveredMultiSelectData) {\r\n            styling.HoverOut(hoveredMultiSelectData.dropDownMenuItemElement);\r\n            hoveredMultiSelectData = null;\r\n            hoveredMultiSelectDataIndex = null;\r\n        }\r\n    }\r\n\r\n    var resetCandidateToHoveredMultiSelectData = function(){\r\n        candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousemove', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousedown', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData = null;\r\n    }\r\n\r\n    var processCandidateToHovered = function() {\r\n        if (hoveredMultiSelectData != candidateToHoveredMultiSelectData)\r\n        {\r\n            resetDropDownMenuHover(); \r\n            hoverInInternal(candidateToHoveredMultiSelectData.visibleIndex);\r\n        }\r\n        if(candidateToHoveredMultiSelectData) \r\n            resetCandidateToHoveredMultiSelectData();\r\n    }\r\n\r\n    function toggleHovered(){\r\n        if (hoveredMultiSelectData) {\r\n            hoveredMultiSelectData.toggle();\r\n            resetDropDownMenuHover();\r\n            hideDropDown(); // always hide 1st\r\n            resetFilter();\r\n        } \r\n    }\r\n\r\n    function keyDownArrow(down) {\r\n        let visibleMultiSelectDataList = getVisibleMultiSelectDataList();\r\n        let length = visibleMultiSelectDataList.length;\r\n        let newIndex=null;\r\n        if (length > 0) {\r\n            if (down) {\r\n                let i = hoveredMultiSelectDataIndex==null?0:hoveredMultiSelectDataIndex+1;\r\n                while(i<length){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i++;\r\n                }\r\n            } else {\r\n                let i = hoveredMultiSelectDataIndex==null?length-1:hoveredMultiSelectDataIndex-1;\r\n                while(i>=0){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        \r\n        if (newIndex!=null)\r\n        {\r\n            if (hoveredMultiSelectData)\r\n                styling.HoverOut(hoveredMultiSelectData.dropDownMenuItemElement);\r\n            updateDropDownLocation();\r\n            showDropDown(); \r\n            hoverInInternal(newIndex);\r\n        }\r\n    }\r\n\r\n    var  onDropDownMenuItemElementMouseoverGeneral = function(MultiSelectData, dropDownMenuItemElement)\r\n    {\r\n        if (inShowDropDown)\r\n        {\r\n            if(candidateToHoveredMultiSelectData)\r\n                resetCandidateToHoveredMultiSelectData()\r\n\r\n            candidateToHoveredMultiSelectData = MultiSelectData;\r\n            dropDownMenuItemElement.addEventListener('mousemove', processCandidateToHovered);\r\n            dropDownMenuItemElement.addEventListener('mousedown', processCandidateToHovered);\r\n        }\r\n        else\r\n        {\r\n            if (hoveredMultiSelectData!=MultiSelectData)\r\n            {\r\n                // mouseleave is not enough to guarantee remove hover styles in situations\r\n                // when style was setuped without mouse (keyboard arrows)\r\n                // therefore force reset manually\r\n                resetDropDownMenuHover(); \r\n                hoverInInternal(MultiSelectData.visibleIndex);\r\n            }                \r\n        }\r\n    }\r\n\r\n    function insertDropDownItem(MultiSelectData, createSelectedItemGen, triggerChange, isSelected, isOptionDisabled) {\r\n        var dropDownMenuItemElement = document.createElement('LI');\r\n        \r\n        // in chrome it happens on \"become visible\" so we need to skip it, \r\n        // for IE11 and edge it doesn't happens, but for IE11 and Edge it doesn't happens on small \r\n        // mouse moves inside the item. \r\n        // https://stackoverflow.com/questions/59022563/browser-events-mouseover-doesnt-happen-when-you-make-element-visible-and-mous\r\n        \r\n        var onDropDownMenuItemElementMouseover = () => onDropDownMenuItemElementMouseoverGeneral(\r\n            MultiSelectData,\r\n            dropDownMenuItemElement\r\n        )\r\n\r\n        dropDownMenuItemElement.addEventListener('mouseover', onDropDownMenuItemElementMouseover);\r\n        \r\n        // note 1: mouseleave preferred to mouseout - which fires on each descendant\r\n        // note 2: since I want add aditional info panels to the dropdown put mouseleave on dropdwon would not work\r\n        var onDropDownMenuItemElementMouseleave = () => resetDropDownMenuHover();\r\n        dropDownMenuItemElement.addEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n\r\n        dropDownMenu.appendChild(dropDownMenuItemElement);\r\n\r\n        let content = dropDownItemContent(dropDownMenuItemElement, MultiSelectData.option); \r\n        MultiSelectData.dropDownMenuItemElement = dropDownMenuItemElement;\r\n        MultiSelectData.DropDownItemContent = content;\r\n\r\n        MultiSelectData.DisposeDropDownMenuItemElement = ()=> {\r\n            dropDownMenuItemElement.removeEventListener('mouseover',  onDropDownMenuItemElementMouseover);\r\n            dropDownMenuItemElement.removeEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n        }\r\n\r\n        var setDropDownItemContentDisabled = (content,  isSelected) => {\r\n            content.disabledStyle(true);\r\n            // do not desable if selected! there should be possibility to unselect \"disabled\"\r\n            content.disable(!isSelected);\r\n        }\r\n\r\n        if (isOptionDisabled)\r\n            setDropDownItemContentDisabled(content, isSelected )\r\n\r\n        content.onSelected( () => {\r\n            MultiSelectData.toggle();\r\n            filterPanelSetFocus();\r\n        });\r\n        // ------------------------------------------------------------------------------\r\n        \r\n        var createSelectedItem = () => createSelectedItemGen(\r\n            MultiSelectData,\r\n            isOptionDisabled,\r\n            () => setDropDownItemContentDisabled(content, false)\r\n        );\r\n        \r\n        if (isSelected)\r\n        {\r\n            createSelectedItem();\r\n        }\r\n        else\r\n        {\r\n            MultiSelectData.excludedFromSearch =  isOptionDisabled;\r\n            if (isOptionDisabled)\r\n                MultiSelectData.toggle = () => { }\r\n            else\r\n                MultiSelectData.toggle = () =>  {\r\n                    createSelectedItem();\r\n                    triggerChange();\r\n                }\r\n        }\r\n        // TODO\r\n        // MultiSelectData.removeDropDownMenuItemElement = () => {\r\n        //     removeElement(dropDownMenuItemElement);\r\n        //     if (MultiSelectData.selectedItemElement!=null)\r\n        //         removeElement(MultiSelectData.selectedItemElement);\r\n        // }\r\n    }\r\n\r\n    var item = {\r\n        dropDownMenu,\r\n        hoverInInternal,\r\n        resetDropDownMenuHover,\r\n        setInShowDropDown, \r\n        showDropDown,\r\n        hideDropDown,\r\n        toggleHovered,\r\n        getSkipFocusout : function() {return skipFocusout},\r\n        resetSkipFocusout : function() {skipFocusout=false},\r\n        keyDownArrow,\r\n        insertDropDownItem\r\n        \r\n    }\r\n    return item;\r\n}\r\n\r\nexport default OptionsPanel;","function removeElement(e) {e.parentNode.removeChild(e)}\r\nexport default removeElement;","import removeElement from './removeElement.js'\r\n\r\nfunction defSelectedPanelStyleSys(s) {s.display='flex'; s.flexWrap='wrap'; s.listStyleType='none'};  // remove bullets since this is ul\r\n\r\nfunction SelectionsPanel (document, init, \r\n    selectedItemContent, \r\n    isComponentDisabled, \r\n    triggerChange, \r\n    onRemove,\r\n    trySetFilterPanelFocus,\r\n    trySetOptionsPanelFocus) {\r\n    var selectedPanel = document.createElement('UL');\r\n    defSelectedPanelStyleSys(selectedPanel.style); \r\n    var filterInputItem = document.createElement('LI'); // detached\r\n    selectedPanel.appendChild(filterInputItem); // located filter in selectionsPanel\r\n\r\n    init(filterInputItem);\r\n    var MultiSelectDataSelectedTail = null;\r\n\r\n    function removeSelectedTail(){\r\n        if (MultiSelectDataSelectedTail){ \r\n            MultiSelectDataSelectedTail.toggle(); // always remove in this case\r\n        }\r\n    }\r\n\r\n    function removeSelectedFromList(MultiSelectData){\r\n        if (MultiSelectData.selectedPrev){\r\n            (MultiSelectData.selectedPrev).selectedNext = MultiSelectData.selectedNext;\r\n        }\r\n        if (MultiSelectData.selectedNext){\r\n           (MultiSelectData.selectedNext).selectedPrev = MultiSelectData.selectedPrev;\r\n        }\r\n        if (MultiSelectDataSelectedTail == MultiSelectData){\r\n            MultiSelectDataSelectedTail = MultiSelectData.selectedPrev;\r\n        }\r\n        MultiSelectData.selectedNext=null;\r\n        MultiSelectData.selectedPrev=null;\r\n    }\r\n\r\n    var preventDefaultMultiSelectEvent;\r\n    var setPreventDefaultMultiSelectEvent = (event)=>{\r\n        preventDefaultMultiSelectEvent = event;\r\n    }\r\n\r\n    function createSelectedItem(MultiSelectData, isOptionDisabled, setDropDownItemContentDisabled) {\r\n        var selectedItemElement = document.createElement('LI');\r\n        MultiSelectData.selectedItemElement = selectedItemElement;\r\n        if (MultiSelectDataSelectedTail){\r\n            MultiSelectDataSelectedTail.selectedNext = MultiSelectData;\r\n            MultiSelectData.selectedPrev = MultiSelectDataSelectedTail;\r\n        }\r\n        MultiSelectDataSelectedTail = MultiSelectData;\r\n\r\n        var removeSelectedItem = () => {\r\n            MultiSelectData.option.selected = false;\r\n            MultiSelectData.excludedFromSearch = isOptionDisabled;\r\n            if (isOptionDisabled)\r\n            {\r\n                setDropDownItemContentDisabled(MultiSelectData.DropDownItemContent, false);\r\n                MultiSelectData.toggle = ()=> {};\r\n            }\r\n            else\r\n            {\r\n                MultiSelectData.toggle = ()=>{\r\n                    createSelectedItem(MultiSelectData, isOptionDisabled, setDropDownItemContentDisabled);\r\n                    triggerChange();\r\n                };\r\n            }\r\n            MultiSelectData.DropDownItemContent.select(false);\r\n            removeElement(selectedItemElement);\r\n            MultiSelectData.SelectedItemContent.dispose();\r\n            MultiSelectData.SelectedItemContent=null;\r\n            MultiSelectData.selectedItemElement=null;\r\n\r\n            removeSelectedFromList(MultiSelectData);\r\n            triggerChange();\r\n        }\r\n\r\n        // what is a problem with calling removeSelectedItem directly (not using  setTimeout(removeSelectedItem, 0)):\r\n        // consider situation \"MultiSelect\" on DROPDOWN (that should be closed on the click outside dropdown)\r\n        // therefore we aslo have document's click's handler where we decide to close or leave the DROPDOWN open.\r\n        // because of the event's bubling process removeSelectedItem runs first. \r\n        // that means the event's target element on which we click (the x button) will be removed from the DOM together with badge \r\n        // before we could analize is it belong to our dropdown or not.\r\n        // important 1: we can't just the stop propogation using stopPropogate because click outside dropdown on the similar \r\n        // component that use stopPropogation will not close dropdown (error, dropdown should be closed)\r\n        // important 2: we can't change the dropdown's event handler to leave dropdown open if event's target is null because of\r\n        // the situation described above: click outside dropdown on the same component.\r\n        // Alternatively it could be possible to use stopPropogate but together create custom click event setting new target that belomgs to DOM (e.g. panel)\r\n\r\n        let removeSelectedItemAndCloseDropDown = () => {\r\n            removeSelectedItem();\r\n            onRemove();\r\n        };\r\n    \r\n        let onRemoveSelectedItemEvent = () => {\r\n            setTimeout( () => {  \r\n                removeSelectedItemAndCloseDropDown();\r\n            }, 0);\r\n        };\r\n\r\n        MultiSelectData.SelectedItemContent = selectedItemContent(\r\n            selectedItemElement,\r\n            MultiSelectData.option,\r\n            onRemoveSelectedItemEvent,\r\n            setPreventDefaultMultiSelectEvent);\r\n\r\n        var disable = (isDisabled) =>\r\n            MultiSelectData.SelectedItemContent.disable(isDisabled);\r\n        disable(isComponentDisabled);\r\n\r\n        MultiSelectData.option.selected = true;\r\n        MultiSelectData.excludedFromSearch = true; // all selected excluded from search\r\n        //MultiSelectData.remove  = removeSelectedItemAndCloseDropDown;\r\n        MultiSelectData.disable = disable;\r\n        selectedPanel.insertBefore(selectedItemElement, filterInputItem);\r\n\r\n\r\n        MultiSelectData.toggle = () => removeSelectedItem();\r\n        MultiSelectData.DropDownItemContent.select(true);\r\n        \r\n    }\r\n\r\n    var selectedPanelClick = event => {\r\n\r\n        trySetFilterPanelFocus(event);\r\n        if (preventDefaultMultiSelectEvent != event) {\r\n            trySetOptionsPanelFocus();\r\n        }\r\n        preventDefaultMultiSelectEvent=null;\r\n    };\r\n\r\n\r\n    function iterateAll(isDisabled){\r\n        let i = MultiSelectDataSelectedTail;\r\n        while(i){\r\n            i.disable(isDisabled); \r\n            i = i.selectedPrev;\r\n        }\r\n    }\r\n\r\n\r\n    var item = {\r\n        selectedPanel,\r\n        filterInputItem,\r\n        insert(selectedItemElement){\r\n            this.selectedPanel.insertBefore(selectedItemElement, filterInputItem);\r\n        },\r\n        createSelectedItem,\r\n        removeSelectedTail,\r\n        resetMultiSelectDataSelectedTail() {\r\n            MultiSelectDataSelectedTail = null;\r\n        },\r\n        enable(){\r\n            filterInputItem.style.display = \"list-item\";\r\n            iterateAll(false);\r\n            selectedPanel.addEventListener(\"click\", selectedPanelClick);\r\n\r\n        },\r\n        disable(){\r\n            filterInputItem.style.display = \"none\";\r\n            iterateAll(true);\r\n            selectedPanel.removeEventListener(\"click\", selectedPanelClick);\r\n\r\n        },\r\n        dispose(){\r\n            selectedPanel.removeEventListener(\"click\", selectedPanelClick); // OPEN dropdown\r\n        }\r\n    }\r\n    return item;\r\n}\r\n\r\nexport default SelectionsPanel;\r\n","function MultiSelectInputAspect (\r\n    document, \r\n    container, \r\n    selectedPanel, \r\n    filterInputItem, dropDownMenu, Popper\r\n    ) {\r\n\r\n    container.appendChild(selectedPanel);\r\n    container.appendChild(dropDownMenu);\r\n\r\n    var popper = new Popper( \r\n        filterInputItem, \r\n        dropDownMenu, \r\n        {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: {enabled:false}\r\n            }\r\n        }\r\n    );\r\n\r\n    var filterInputItemOffsetLeft = null;\r\n\r\n    return {\r\n        dispose(){\r\n            popper.destroy();\r\n        },\r\n        alignToFilterInputItemLocation(force) {\r\n            let offsetLeft = filterInputItem.offsetLeft;\r\n            if (force || filterInputItemOffsetLeft != offsetLeft){ // position changed\r\n                popper.update();\r\n                this.filterInputItemOffsetLeft=offsetLeft;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default MultiSelectInputAspect;","import Popper from 'popper.js'\r\nimport FilterPanel from './FilterPanel.js'\r\nimport OptionsPanel from './OptionsPanel.js'\r\nimport SelectionsPanel from './SelectionsPanel.js'\r\nimport MultiSelectInputAspect from './MultiSelectInputAspect.js'\r\n\r\nfunction filterMultiSelectData(MultiSelectData, isFiltered, visibleIndex) {\r\n    MultiSelectData.visible = isFiltered;\r\n    MultiSelectData.visibleIndex = visibleIndex;\r\n    MultiSelectData.dropDownMenuItemElement.style.display = isFiltered ? 'block': 'none';\r\n} \r\n\r\nfunction resetFilterDropDownMenu(MultiSelectDataList) {\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            filterMultiSelectData(multiSelectData, true, i);\r\n        }\r\n    }\r\n}\r\n\r\nfunction collectFilterDropDownMenu(MultiSelectDataList, text) {\r\n    var list = [];\r\n    var j = 0;\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            if ( multiSelectData.excludedFromSearch || multiSelectData.searchText.indexOf(text)<0 )\r\n            {\r\n                filterMultiSelectData(multiSelectData, false);\r\n            }\r\n            else \r\n            {\r\n                filterMultiSelectData(multiSelectData, true, j++);\r\n                list.push( multiSelectData );\r\n            }\r\n        }\r\n    }\r\n    return list;\r\n}\r\n\r\nclass MultiSelect {\r\n    constructor(optionsAdapter, styling, \r\n        selectedItemContent, dropDownItemContent, \r\n        labelAdapter, createStylingComposite,\r\n        configuration, onDispose, window) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n\r\n        // readonly\r\n        this.optionsAdapter = optionsAdapter;\r\n        this.container = optionsAdapter.container; // part of published api\r\n        this.styling = styling;\r\n        this.selectedItemContent = selectedItemContent;\r\n        this.dropDownItemContent = dropDownItemContent;\r\n        this.labelAdapter = labelAdapter;\r\n        this.createStylingComposite = createStylingComposite;\r\n        this.configuration = configuration;\r\n        this.onDispose = onDispose;\r\n        this.window = window;\r\n        this.document = window.document;\r\n\r\n        //this.popper = null;\r\n\r\n        this.visibleCount=10;\r\n\r\n        this.selectionsPanel = null;\r\n        this.filterInputItem = null;\r\n        this.optionsPanel = null;\r\n\r\n        this.stylingComposite = null;\r\n\r\n        // removable handlers\r\n        this.documentMouseup = null;\r\n        this.containerMousedown = null;\r\n\r\n        // state\r\n        this.isComponentDisabled = null;\r\n        this.filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n        \r\n        this.resetMultiSelectDataList();\r\n    }\r\n\r\n    resetMultiSelectDataList(){\r\n        this.MultiSelectDataList = [];\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    \r\n    getVisibleMultiSelectDataList(){\r\n        if (this.filteredMultiSelectDataList)\r\n            return this.filteredMultiSelectDataList;\r\n        else\r\n            return this.MultiSelectDataList;\r\n    }\r\n\r\n    resetFilter(){\r\n        if (!this.filterPanel.isEmpty()) {\r\n            this.filterPanel.setEmpty();\r\n            this.processEmptyInput();\r\n        }\r\n    }\r\n\r\n    processEmptyInput(){\r\n        this.filterPanel.setEmptyLength();\r\n        resetFilterDropDownMenu(this.MultiSelectDataList);\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    // -----------------------------------------------------------------------------------------------------------------------\r\n    Update(){\r\n        this.styling.UpdateIsValid(this.stylingComposite, this.optionsAdapter.getIsValid(), this.optionsAdapter.getIsInvalid());\r\n        this.UpdateSize();\r\n        this.UpdateDisabled();\r\n    }\r\n\r\n    UpdateOption(index){\r\n        let multiSelectData = this.MultiSelectDataList[index];\r\n        let option = multiSelectData.option;\r\n        multiSelectData.searchText = option.text.toLowerCase().trim();\r\n        if (multiSelectData.isHidden != option.isHidden)\r\n        {\r\n            multiSelectData.isHidden=option.isHidden;\r\n            if (multiSelectData.isHidden)\r\n                this.optionsPanel.insertDropDownItem(multiSelectData, \r\n                    (p1,p2,p3)=>this.selectionsPanel.createSelectedItem(p1,p2,p3),\r\n                    ()=>this.optionsAdapter.triggerChange(),\r\n                    option.isSelected, option.isDisabled);\r\n            else\r\n                multiSelectData.removeDropDownMenuItemElement();\r\n        }\r\n        else \r\n        {\r\n            if (multiSelectData.isSelected != option.isSelected)\r\n            {\r\n                multiSelectData.isSelected=option.isSelected;\r\n                if (multiSelectData.isSelected)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n            if (multiSelectData.isDisabled != option.isDisabled)\r\n            {\r\n                multiSelectData.isDisabled=option.isDisabled;\r\n                if (multiSelectData.isDisabled)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n        }    \r\n        //multiSelectData.updateOption();\r\n    }\r\n\r\n    UpdateData(){\r\n        // close drop down , remove filter and listeners\r\n        this.optionsPanel.hideDropDown(); // always hide 1st\r\n        this.resetFilter();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.removeDropDownMenuItemElement)\r\n                multiSelectData.removeDropDownMenuItemElement();\r\n        }\r\n        this.resetMultiSelectDataList();\r\n        this.selectionsPanel.resetMultiSelectDataSelectedTail();// this.MultiSelectDataSelectedTail = null;\r\n\r\n        // reinitiate\r\n        this.updateDataImpl();\r\n    }\r\n\r\n    updateDataImpl(){\r\n        var createDropDownItems = () => {\r\n            let options = this.optionsAdapter.getOptions();\r\n            var j = 0;\r\n            for(let i = 0; i<options.length; i++) {\r\n                let option = options[i];\r\n\r\n                let isDisabled = option.disabled;\r\n                let isHidden   = option.hidden;\r\n                let isSelected = option.selected;\r\n                \r\n                var MultiSelectData = {\r\n                    searchText: option.text.toLowerCase().trim(),\r\n                    excludedFromSearch: isSelected || isDisabled || isHidden,\r\n                    option: option,\r\n                    isHidden: isHidden,\r\n                    dropDownMenuItemElement: null,\r\n                    dropDownItemContent: null,\r\n                    selectedPrev: null,\r\n                    selectedNext: null,\r\n                    visible: false,\r\n                    toggle: null,\r\n                    selectedItemElement: null,\r\n                    remove: null,\r\n                    disable: null,\r\n                    removeDropDownMenuItemElement: null\r\n                };\r\n\r\n                this.MultiSelectDataList.push(MultiSelectData);\r\n                if (!isHidden){\r\n                    MultiSelectData.visible = true;\r\n                    MultiSelectData.visibleIndex=i;\r\n                    this.optionsPanel.insertDropDownItem(MultiSelectData, \r\n                        (p1,p2,p3)=>this.selectionsPanel.createSelectedItem(p1,p2,p3),\r\n                        ()=>this.optionsAdapter.triggerChange(), isSelected, isDisabled);\r\n                }\r\n            } \r\n            this.aspect.alignToFilterInputItemLocation(false);\r\n        }\r\n\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        if (document.readyState != 'loading'){\r\n            createDropDownItems();\r\n        } else {\r\n            var createDropDownItemsHandler = function(){\r\n                createDropDownItems();\r\n                document.removeEventListener(\"DOMContentLoaded\", createDropDownItemsHandler);\r\n            }\r\n            document.addEventListener('DOMContentLoaded', createDropDownItemsHandler); // IE9+\r\n        }\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.onDispose)\r\n            this.onDispose(); // primary used to remove from jQuery tables\r\n        \r\n        // remove event listeners\r\n        // TODO check if open\r\n        this.optionsPanel.hideDropDown();\r\n        \r\n        this.selectionsPanel.dispose();\r\n        this.filterPanel.dispose();\r\n        \r\n        this.labelAdapter.dispose();\r\n        \r\n        this.aspect.dispose();\r\n        \r\n        if (this.optionsAdapter.dispose) {\r\n            this.optionsAdapter.dispose();\r\n        }\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.DisposeDropDownMenuItemElement)\r\n                multiSelectData.DisposeDropDownMenuItemElement();\r\n            \r\n            if (multiSelectData.SelectedItemContent)\r\n                multiSelectData.SelectedItemContent.dispose();\r\n            if (multiSelectData.DropDownItemContent)\r\n                multiSelectData.DropDownItemContent.dispose();\r\n        }\r\n    }\r\n\r\n    UpdateSize(){\r\n        if (this.styling.UpdateSize)\r\n            this.styling.UpdateSize(this.stylingComposite);\r\n    }\r\n\r\n    UpdateDisabled(){\r\n        let isComponentDisabled = this.optionsAdapter.getDisabled();\r\n        if (this.isComponentDisabled!==isComponentDisabled){\r\n            if (isComponentDisabled) {\r\n                this.selectionsPanel.disable();\r\n                this.styling.Disable(this.stylingComposite);\r\n            } else {\r\n                this.selectionsPanel.enable();\r\n                this.styling.Enable(this.stylingComposite);\r\n            }\r\n            this.isComponentDisabled=isComponentDisabled;\r\n        }\r\n    }\r\n \r\n    input(filterInputValue, resetLength){\r\n        let text = filterInputValue.trim().toLowerCase();\r\n        var isEmpty=false;\r\n        if (text == '')\r\n            isEmpty=true;\r\n        else\r\n        {\r\n            // check if exact match, otherwise new search\r\n            this.filteredMultiSelectDataList = collectFilterDropDownMenu(this.MultiSelectDataList, text);\r\n            if (this.filteredMultiSelectDataList.length == 1)\r\n            {\r\n                let fullMatchMultiSelectData =  this.filteredMultiSelectDataList[0];\r\n                if (fullMatchMultiSelectData.searchText == text)\r\n                {\r\n                    fullMatchMultiSelectData.toggle();\r\n                    this.filterPanel.setEmpty(); // clear\r\n                    isEmpty=true;\r\n                }\r\n            }\r\n        }\r\n        if (isEmpty)\r\n            this.processEmptyInput();\r\n        else\r\n            resetLength();  \r\n        \r\n        this.optionsPanel.setInShowDropDown();\r\n\r\n        this.optionsPanel.resetDropDownMenuHover();\r\n\r\n        if (this.getVisibleMultiSelectDataList().length == 1) {\r\n            this.optionsPanel.hoverInInternal(0)\r\n        }\r\n\r\n        if (this.getVisibleMultiSelectDataList().length > 0) {\r\n            this.aspect.alignToFilterInputItemLocation(true); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.optionsPanel.showDropDown();\r\n        } else {\r\n            this.optionsPanel.hideDropDown();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        var document = this.document;\r\n        let container = this.optionsAdapter.container;\r\n\r\n        var lazyfilterItemInputElementAtach=null;\r\n        \r\n        this.filterPanel = FilterPanel(\r\n            document,\r\n            (filterItemInputElement) => {\r\n                lazyfilterItemInputElementAtach = (filterItemElement)=>{\r\n                    filterItemElement.appendChild(filterItemInputElement);\r\n                    this.labelAdapter.init(filterItemInputElement); \r\n                };\r\n            },\r\n            () => this.styling.FocusIn(this.stylingComposite),  // focus in - show dropdown\r\n            () => {\r\n                if (!this.optionsPanel.getSkipFocusout()) // skip initiated by mouse click (we manage it different way)\r\n                {\r\n                    this.resetFilter(); // if do not do this we will return to filtered list without text filter in input\r\n                    this.optionsPanel.resetDropDownMenuHover(); // if do not do this tab will select \"only one hovered\"\r\n                    this.styling.FocusOut(this.stylingComposite)\r\n                    this.optionsPanel.resetSkipFocusout();\r\n                }\r\n            }, // focus out - hide dropdown\r\n            () => this.optionsPanel.keyDownArrow(false), // arrow up\r\n            () => this.optionsPanel.keyDownArrow(true),  // arrow down\r\n            () => this.optionsPanel.hideDropDown(),  // tab on empty\r\n            () => {\r\n                this.selectionsPanel.removeSelectedTail();\r\n                this.aspect.alignToFilterInputItemLocation(false);\r\n            }, // backspace - \"remove last\"\r\n            () => this.optionsPanel.toggleHovered(), // tab/enter \"compleate hovered\"\r\n            () => {\r\n                this.optionsPanel.hideDropDown(); // always hide 1st\r\n                this.resetFilter();\r\n            }, // esc  \r\n            (filterInputValue, resetLength) => this.input(filterInputValue, resetLength) // filter\r\n        );\r\n             \r\n        this.selectionsPanel =  SelectionsPanel(\r\n            document,\r\n            (filterItemElement) => {\r\n                lazyfilterItemInputElementAtach(filterItemElement);\r\n            },\r\n            this.selectedItemContent,\r\n            this.isComponentDisabled,\r\n            () => this.optionsAdapter.triggerChange(),\r\n            () => {\r\n                this.optionsPanel.hideDropDown(); // always hide 1st\r\n                this.resetFilter();\r\n            },\r\n            (event) => {\r\n                  if (!this.filterPanel.isEventTarget(event))\r\n                     this.filterPanel.setFocus();\r\n                },\r\n            () => {\r\n                    if (this.getVisibleMultiSelectDataList().length > 0)\r\n                    {\r\n                        this.aspect.alignToFilterInputItemLocation(true);\r\n                        this.optionsPanel.showDropDown();\r\n                    }\r\n                }\r\n        );\r\n        \r\n        this.selectedPanel = this.selectionsPanel.selectedPanel; // TODO remove\r\n        this.filterInputItem = this.selectionsPanel.filterInputItem;\r\n\r\n        this.optionsPanel = OptionsPanel(\r\n            document,\r\n            container,\r\n            this.dropDownItemContent,\r\n            this.styling, \r\n            () => this.getVisibleMultiSelectDataList(),\r\n            () => this.resetFilter(),\r\n            () => this.aspect.alignToFilterInputItemLocation(true),\r\n            () => this.filterPanel.setFocus()\r\n        );\r\n\r\n        this.aspect =  MultiSelectInputAspect(\r\n            document,\r\n            this.optionsAdapter.container, \r\n            this.selectionsPanel.selectedPanel, \r\n            this.selectionsPanel.filterInputItem, \r\n            this.optionsPanel.dropDownMenu, \r\n            Popper\r\n        );\r\n\r\n        this.stylingComposite = this.createStylingComposite(container, \r\n            this.selectionsPanel.selectedPanel,\r\n            this.selectionsPanel.filterInputItem, \r\n            this.filterPanel.input, \r\n            this.optionsPanel.dropDownMenu);\r\n        \r\n        this.styling.Init(this.stylingComposite);\r\n\r\n        if (this.optionsAdapter.afterContainerFilled)\r\n            this.optionsAdapter.afterContainerFilled();\r\n\r\n\r\n        \r\n        \r\n        this.styling.UpdateIsValid(this.stylingComposite, this.optionsAdapter.getIsValid(), this.optionsAdapter.getIsInvalid());\r\n        \r\n        this.UpdateSize();\r\n        this.UpdateDisabled();\r\n        \r\n        this.updateDataImpl();\r\n    }\r\n}\r\n\r\nexport default MultiSelect;\r\n","function LabelAdapter(label, createInputId){\r\n    var backupedFor = null; // state saved between init and dispose\r\n    return {\r\n        init(filterInput) {\r\n            if (label) {\r\n                backupedFor = label.getAttribute('for');\r\n                var newId = createInputId();\r\n                filterInput.setAttribute('id', newId);\r\n                label.setAttribute('for',newId);\r\n            }\r\n        },\r\n        dispose(){\r\n            if(backupedFor)\r\n                label.setAttribute('for',backupedFor);\r\n        }\r\n    }\r\n}\r\n\r\nexport default LabelAdapter;","function OptionsAdapterJson(container, options, getDisabled, getIsValid, getIsInvalid, trigger) {\r\n    return {\r\n        container,\r\n        getOptions(){return options},\r\n        dispose(){\r\n            while (container.firstChild) container.removeChild(container.firstChild);\r\n        },\r\n        triggerChange(){\r\n            trigger('multiselect:change');\r\n        },\r\n        getDisabled(){\r\n            return getDisabled?getDisabled():false;\r\n        },\r\n        getIsValid(){\r\n            return getIsValid?getIsValid():false;\r\n        },\r\n        getIsInvalid(){\r\n            return getIsInvalid?getIsInvalid():false;\r\n        }\r\n    }\r\n}\r\n\r\nfunction OptionsAdapterElement(selectElement, trigger) {\r\n    selectElement.style.display='none';\r\n    var container = document.createElement('div');\r\n    return {\r\n        container,\r\n        getOptions(){return selectElement.getElementsByTagName('OPTION')},\r\n        dispose(){\r\n            container.parentNode.removeChild(container);\r\n        },\r\n        afterContainerFilled(){\r\n            selectElement.parentNode.insertBefore(container, selectElement.nextSibling);\r\n        },\r\n        triggerChange(){\r\n            trigger('change');\r\n            trigger('multiselect:change');\r\n        },\r\n        getDisabled(){\r\n            return selectElement.disabled;\r\n        },\r\n        getIsValid(){\r\n            return selectElement.classList.contains('is-valid');\r\n        },\r\n        getIsInvalid(){\r\n            return selectElement.classList.contains('is-invalid');\r\n        }\r\n    }\r\n}\r\n\r\nexport {OptionsAdapterJson, OptionsAdapterElement};\r\n","export function ExtendIfUndefined(destination, source) {\r\n    for (var property in source)\r\n        if (destination[property] === undefined)\r\n            destination[property] = source[property];\r\n}\r\n\r\nexport function ExtendIfUndefinedFluent(destination, source) {\r\n    ExtendIfUndefined(destination, source);\r\n    return destination;\r\n}","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst bs4StylingMethodCssDefaults = {\r\n    selectedPanelFocusClass : 'focus',\r\n    selectedPanelDisabledClass: 'disabled',\r\n    dropDownItemDisabledClass: 'disabled'\r\n};\r\n\r\nfunction Bs4StylingMethodCss(configuration){\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssDefaults);\r\n\r\n    return {\r\n        Enable($selectedPanel){\r\n            $selectedPanel.removeClass(configuration.selectedPanelDisabledClass)\r\n        },\r\n    \r\n        Disable($selectedPanel){\r\n            $selectedPanel.addClass(configuration.selectedPanelDisabledClass)\r\n        },\r\n    \r\n        FocusIn($selectedPanel){\r\n            $selectedPanel.addClass(configuration.selectedPanelFocusClass);\r\n        },\r\n    \r\n        FocusOut($selectedPanel){\r\n            $selectedPanel.removeClass(configuration.selectedPanelFocusClass);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Bs4StylingMethodCss;","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst defSelectedPanelStyle = {'margin-bottom': '0', 'height': 'auto'};\r\n\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedPanelDefMinHeight: 'calc(2.25rem + 2px)',\r\n    selectedPanelLgMinHeight:  'calc(2.875rem + 2px)',\r\n    selectedPanelSmMinHeight:  'calc(1.8125rem + 2px)',\r\n    selectedPanelDisabledBackgroundColor: '#e9ecef',\r\n    selectedPanelFocusBorderColor: '#80bdff',\r\n    selectedPanelFocusBoxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)',\r\n    selectedPanelFocusValidBoxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)',\r\n    selectedPanelFocusInvalidBoxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)',\r\n    filterInputColor: '#495057',\r\n    //selectedItemContentDisabledOpacity: '.65'\r\n};\r\n\r\nfunction Bs4StylingMethodJs(configuration){\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n\r\n    return {\r\n        OnInit(composite){\r\n            composite.$selectedPanel.css(defSelectedPanelStyle);\r\n            composite.$filterInput.css(\"color\", configuration.filterInputColor);\r\n        },\r\n    \r\n        UpdateSize($selectedPanel){\r\n            if ($selectedPanel.hasClass(\"form-control-lg\")){\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelLgMinHeight);\r\n            } else if ($selectedPanel.hasClass(\"form-control-sm\")){\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelSmMinHeight);\r\n            } else {\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelDefMinHeight);\r\n            }\r\n        },\r\n    \r\n        Enable($selectedPanel){\r\n            $selectedPanel.css(\"background-color\", \"\")\r\n        },\r\n    \r\n        Disable($selectedPanel){\r\n            $selectedPanel.css(\"background-color\", configuration.selectedPanelDisabledBackgroundColor)\r\n        },\r\n    \r\n        FocusIn($selectedPanel){\r\n            if ($selectedPanel.hasClass(\"is-valid\")){\r\n                $selectedPanel.css(\"box-shadow\", configuration.selectedPanelFocusValidBoxShadow);\r\n            } else if ($selectedPanel.hasClass(\"is-invalid\")){\r\n                $selectedPanel.css(\"box-shadow\", configuration.selectedPanelFocusInvalidBoxShadow);\r\n            } else {\r\n                $selectedPanel\r\n                    .css(\"box-shadow\", configuration.selectedPanelFocusBoxShadow)\r\n                    .css(\"border-color\", configuration.selectedPanelFocusBorderColor);\r\n            }\r\n        },\r\n    \r\n        FocusOut($selectedPanel){\r\n                $selectedPanel.css(\"box-shadow\", \"\" ).css(\"border-color\", \"\")\r\n        },\r\n    }\r\n}\r\n\r\nexport default Bs4StylingMethodJs;","import  { ExtendIfUndefined } from './Tools';\r\n\r\n// Bs4Styling\r\nconst bs4StylingDefaults = {\r\n    containerClass: 'dashboardcode-bsmultiselect',\r\n    dropDownMenuClass: 'dropdown-menu',\r\n    dropDownItemClass:  'px-2',\r\n    dropDownItemHoverClass: 'text-primary bg-light',\r\n    selectedPanelClass: 'form-control',\r\n    selectedItemClass: 'badge',\r\n    removeSelectedItemButtonClass: 'close',\r\n    filterInputItemClass: '',\r\n    filterInputClass: ''\r\n}\r\n\r\nfunction Bs4Styling(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4StylingDefaults);\r\n\r\n    return {\r\n        Init(composite){\r\n            composite.$container.addClass(configuration.containerClass);\r\n            composite.$selectedPanel.addClass(configuration.selectedPanelClass);\r\n            composite.$dropDownMenu.addClass(configuration.dropDownMenuClass);\r\n            composite.$filterInputItem.addClass(configuration.filterInputItemClass);\r\n            composite.$filterInput.addClass(configuration.filterInputClass);\r\n            if (stylingMethod.OnInit)\r\n                stylingMethod.OnInit(composite)\r\n        },\r\n\r\n        UpdateIsValid(composite, isValid, isInvalid){\r\n            if (isValid)\r\n                composite.$selectedPanel.addClass('is-valid');\r\n\r\n            if (isInvalid)\r\n                composite.$selectedPanel.addClass('is-invalid');\r\n        },\r\n\r\n        UpdateSize(composite){\r\n            if(stylingMethod.UpdateSize)\r\n               stylingMethod.UpdateSize(composite.$selectedPanel)\r\n        },\r\n\r\n        Enable(composite){\r\n            stylingMethod.Enable(composite.$selectedPanel)\r\n        },\r\n\r\n        Disable(composite){\r\n            stylingMethod.Disable(composite.$selectedPanel)\r\n        },\r\n\r\n        FocusIn(composite){\r\n            stylingMethod.FocusIn(composite.$selectedPanel)\r\n        },\r\n\r\n        FocusOut(composite){\r\n            stylingMethod.FocusOut(composite.$selectedPanel)\r\n        },\r\n\r\n        HoverIn(dropDownItem){\r\n            $(dropDownItem).addClass(configuration.dropDownItemHoverClass);\r\n        },\r\n\r\n        HoverOut(dropDownItem){\r\n            $(dropDownItem).removeClass(configuration.dropDownItemHoverClass);\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nexport default Bs4Styling;","function AddToJQueryPrototype(pluginName, createPlugin, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    const firstCharLower = firstChar.toLowerCase();\r\n    if (firstCharLower == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstCharLower + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance for 1st $selected item\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n}\r\n\r\nexport default AddToJQueryPrototype;","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst bs4StylingMethodCssdefaults = {\r\n    selectedItemContentDisabledClass: 'disabled'\r\n};\r\n\r\nfunction Bs4SelectedItemContentStylingMethodCss(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssdefaults);\r\n\r\n    return {\r\n        disableSelectedItemContent($content){\r\n            $content.addClass(configuration.selectedItemContentDisabledClass )\r\n        }\r\n    }\r\n}\r\n\r\nconst defSelectedItemStyle = {'padding-left': '0px', 'line-height': '1.5em'};\r\nconst defRemoveSelectedItemButtonStyle = {'font-size':'1.5em', 'line-height': '.9em'};\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedItemContentDisabledOpacity: '.65'\r\n };\r\n\r\nfunction Bs4SelectedItemContentStylingMethodJs(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n    return {\r\n        disableSelectedItemContent($content){\r\n            $content.css(\"opacity\", configuration.selectedItemContentDisabledOpacity )\r\n        },\r\n    \r\n        createSelectedItemContent($selectedItem, $button){\r\n            $selectedItem.css(defSelectedItemStyle);\r\n            if ($button)\r\n                $button.css(defRemoveSelectedItemButtonStyle);\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4SelectedItemContentDefaults = {\r\n    selectedItemClass: 'badge',\r\n    removeSelectedItemButtonClass: 'close'\r\n};\r\nfunction Bs4SelectedItemContent(stylingMethod, configuration, $) {\r\n        ExtendIfUndefined(configuration, bs4SelectedItemContentDefaults);\r\n        \r\n        return function (selectedItem, optionItem, removeSelectedItem, preventDefaultMultiSelect){\r\n                let $selectedItem = $(selectedItem)\r\n                $selectedItem.addClass(configuration.selectedItemClass);\r\n                let $content = $(`<span/>`).text(optionItem.text);\r\n                $content.appendTo($selectedItem);\r\n                if (optionItem.disabled)\r\n                    stylingMethod.disableSelectedItemContent($content);\r\n                let $button = $('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n                    // bs 'close' class that will be added to button set the float:right, therefore it impossible to configure no-warp policy \r\n                    // with .css(\"white-space\", \"nowrap\") or  .css(\"display\", \"inline-block\"); TODO: migrate to flex? \r\n                    .css(\"float\", \"none\").appendTo($selectedItem)\r\n                    .addClass(configuration.removeSelectedItemButtonClass) // bs close class set the float:right\r\n                    .on(\"click\", (jqEvent) => \r\n                        {   \r\n                            removeSelectedItem(); \r\n                            preventDefaultMultiSelect(jqEvent.originalEvent);\r\n                        });\r\n                \r\n                if (stylingMethod.createSelectedItemContent)\r\n                    stylingMethod.createSelectedItemContent($selectedItem, $button);\r\n                return {\r\n                    disable(isDisabled){ \r\n                        $button.prop('disabled', isDisabled); \r\n                    },\r\n                    dispose(){\r\n                        $button.unbind();\r\n                    }\r\n                };\r\n            }\r\n}\r\n\r\nexport { Bs4SelectedItemContent as Bs4SelectedItemContent, Bs4SelectedItemContentStylingMethodJs, Bs4SelectedItemContentStylingMethodCss};","import  { ExtendIfUndefined} from './Tools';\r\n\r\nconst bs4StylingMethodCssDefaults = {\r\n    selectedItemContentDisabledClass: 'disabled',\r\n};\r\n\r\nfunction Bs4DropDownItemContentStylingMethodCss(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssDefaults);\r\n    return {\r\n        disabledStyle($checkBox, $checkBoxLabel, isDisbaled){\r\n            if (isDisbaled) \r\n                $checkBox.addClass(configuration.dropDownItemDisabledClass);\r\n            else\r\n                $checkBox.removeClass(configuration.dropDownItemDisabledClass);\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedItemContentDisabledOpacity: '.65',\r\n    dropdDownLabelDisabledColor: '#6c757d'\r\n};\r\n\r\nfunction Bs4DropDownItemContentStylingMethodJs(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n    return{\r\n        disabledStyle($checkBox, $checkBoxLabel, isDisbaled){\r\n            $checkBoxLabel.css('color', isDisbaled?configuration.dropdDownLabelDisabledColor:'')\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4DropDownItemContentDefaults = {\r\n    dropDownItemClass:  'px-2',\r\n}\r\n\r\nfunction Bs4DropDownItemContent(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4DropDownItemContentDefaults);\r\n    return function(dropDownItem, option){\r\n        let $dropDownItem = $(dropDownItem);\r\n        $dropDownItem.addClass(configuration.dropDownItemClass);\r\n        let $dropDownItemContent= $(`<div class=\"custom-control custom-checkbox\">\r\n            <input type=\"checkbox\" class=\"custom-control-input\">\r\n            <label class=\"custom-control-label\"></label>\r\n        </div>`);\r\n        $dropDownItemContent.appendTo(dropDownItem);\r\n        let $checkBox = $dropDownItemContent.find(`INPUT[type=\"checkbox\"]`);\r\n        let $checkBoxLabel = $dropDownItemContent.find(`label`);\r\n        $checkBoxLabel.text(option.text);\r\n\r\n        var tmp = { \r\n            select(isSelected){ $checkBox.prop('checked', isSelected); }, \r\n            // --- distinct disable and disabledStyle to provide a possibility to unselect disabled option\r\n            disable(isDisabled){ $checkBox.prop('disabled', isDisabled); },\r\n            disabledStyle(isDisbaled){ stylingMethod.disabledStyle($checkBox, $checkBoxLabel, isDisbaled); },\r\n\r\n            onSelected(toggle) {\r\n                $checkBox.on(\"change\", toggle)\r\n                $dropDownItem.on(\"click\", event => {\r\n                    if (dropDownItem === event.target || $.contains(dropDownItem, event.target)) {\r\n                        toggle();\r\n                    }\r\n                })\r\n            },\r\n            dispose(){\r\n                $checkBox.unbind();\r\n                $dropDownItem.unbind();\r\n            }\r\n        }\r\n        \r\n        return tmp;\r\n    }\r\n}\r\n\r\nexport { Bs4DropDownItemContent, Bs4DropDownItemContentStylingMethodJs, Bs4DropDownItemContentStylingMethodCss };","import $ from 'jquery'\r\n\r\nimport MultiSelect from './MultiSelect'\r\nimport LabelAdapter from './LabelAdapter';\r\nimport {OptionsAdapterJson,OptionsAdapterElement} from './OptionsAdapters';\r\n\r\nimport Bs4StylingMethodCss from './Bs4StylingMethodCss'\r\nimport Bs4StylingMethodJs from './Bs4StylingMethodJs'\r\nimport Bs4Styling from './Bs4Styling';\r\nimport AddToJQueryPrototype from './AddToJQueryPrototype'\r\n\r\nimport { Bs4SelectedItemContent, Bs4SelectedItemContentStylingMethodJs, Bs4SelectedItemContentStylingMethodCss} from './Bs4SelectedItemContent';\r\nimport { Bs4DropDownItemContent, Bs4DropDownItemContentStylingMethodJs, Bs4DropDownItemContentStylingMethodCss} from './Bs4DropDownItemContent';\r\n\r\n(\r\n    (window, $) => {\r\n        AddToJQueryPrototype('BsMultiSelect',\r\n            (element, settings, onDispose) => {\r\n                let configuration = $.extend({}, settings); // settings used per jQuery intialization, configuration per element\r\n                if (configuration.preBuildConfiguration)\r\n                    configuration.preBuildConfiguration(element, configuration);\r\n                \r\n                var $element= $(element);\r\n                let optionsAdapter = null;\r\n                if (configuration.optionsAdapter)\r\n                    optionsAdapter = configuration.optionsAdapter;\r\n                else\r\n                {\r\n                    var trigger = function(eventName){\r\n                        $element.trigger(eventName);\r\n                    }\r\n                    if (configuration.options){\r\n                        optionsAdapter = OptionsAdapterJson(\r\n                            element,\r\n                            configuration.options,\r\n                            configuration.getDisabled,\r\n                            configuration.getIsValid,\r\n                            configuration.getIsInvalid,\r\n                            trigger );\r\n                        if (!configuration.createInputId)\r\n                            configuration.createInputId=()=>`${configuration.containerClass}-generated-filter-${element.id}`;\r\n            \r\n                    }else {\r\n                        if (!configuration.label)\r\n                        {\r\n                            let $formGroup = $(element).closest('.form-group');\r\n                            if ($formGroup.length == 1) {\r\n                                let $label = $formGroup.find(`label[for=\"${element.id}\"]`);\r\n                                if ($label.length>0)\r\n                                {   \r\n                                    let label = $label.get(0);\r\n                                    let forId = label.getAttribute('for');\r\n                                    if (forId == element.id) {\r\n                                        configuration.label = label;\r\n                                    }\r\n                                }   \r\n                            }\r\n                        }\r\n                        optionsAdapter = OptionsAdapterElement(element, trigger);\r\n                        if (!configuration.createInputId)\r\n                            configuration.createInputId=()=>`${configuration.containerClass}-generated-input-${((element.id)?element.id:element.name).toLowerCase()}-id`;\r\n                    }\r\n                }\r\n\r\n                let labelAdapter = LabelAdapter(configuration.label, configuration.createInputId);\r\n\r\n                let useCss = configuration.useCss;\r\n                let styling = configuration.styling;\r\n                if (!configuration.adapter)\r\n                {\r\n                    let stylingMethod = configuration.stylingMethod;\r\n                    if (!stylingMethod)\r\n                    {\r\n                        if (useCss)\r\n                            stylingMethod = Bs4StylingMethodCss(configuration);\r\n                        else\r\n                            stylingMethod = Bs4StylingMethodJs(configuration);\r\n                    }\r\n                    styling = Bs4Styling(stylingMethod, configuration, $);\r\n                }\r\n\r\n                let selectedItemContent = configuration.selectedItemContent;\r\n                if (!selectedItemContent){\r\n                    let selectedItemContentStylingMethod = configuration.selectedItemContentStylingMethod;\r\n                    if (!selectedItemContentStylingMethod)\r\n                    {\r\n                        if (useCss)\r\n                            selectedItemContentStylingMethod=Bs4SelectedItemContentStylingMethodCss(configuration, $);\r\n                        else\r\n                            selectedItemContentStylingMethod=Bs4SelectedItemContentStylingMethodJs(configuration, $);\r\n                    }\r\n                    selectedItemContent = Bs4SelectedItemContent(selectedItemContentStylingMethod, configuration, $);\r\n                }\r\n\r\n                let dropDownItemContent = configuration.bs4DropDownItemContent;\r\n                if (!dropDownItemContent){\r\n                    let dropDownItemContentStylingMethod = configuration.dropDownItemContentStylingMethod;\r\n                    if (useCss)\r\n                        dropDownItemContentStylingMethod=Bs4DropDownItemContentStylingMethodCss(configuration, $);\r\n                    else\r\n                        dropDownItemContentStylingMethod=Bs4DropDownItemContentStylingMethodJs(configuration, $);\r\n                    dropDownItemContent = Bs4DropDownItemContent(dropDownItemContentStylingMethod, configuration, $)\r\n                }\r\n\r\n                let createStylingComposite = function(container, selectedPanel, filterInputItem, filterInput, dropDownMenu){\r\n                    return {\r\n                        $container:$(container),\r\n                        $selectedPanel:$(selectedPanel),\r\n                        $filterInputItem:$(filterInputItem),\r\n                        $filterInput:$(filterInput),\r\n                        $dropDownMenu:$(dropDownMenu)\r\n                    };\r\n                }\r\n\r\n                let multiSelect = new MultiSelect(\r\n                    optionsAdapter,\r\n                    styling,\r\n                    selectedItemContent,\r\n                    dropDownItemContent,\r\n                    labelAdapter,\r\n                    createStylingComposite,\r\n                    configuration,\r\n                    onDispose,\r\n                    window);\r\n\r\n                if (configuration.postBuildConfiguration)\r\n                    configuration.postBuildConfiguration(element, multiSelect);\r\n                \r\n                multiSelect.init();\r\n                return multiSelect;\r\n            }, $);\r\n    }\r\n)(window, $)\r\n"],"names":["defFilterInputStyleSys","s","width","border","padding","outline","backgroundColor","FilterPanel","document","insertIntoDom","onFilterInputFocusIn","onFilterInputFocusOut","keyDownArrowUp","keyDownArrowDown","hideDropDown","removeSelectedTail","toggleHovered","resetFilterAndHideDropDown","input","filterInput","createElement","setAttribute","style","onfilterInputKeyDown","event","indexOf","which","value","preventDefault","onFilterInputKeyUp","onFilterInputInput","filterInputValue","length","setEmptyLength","setEmpty","addEventListener","filterPanel","isEmpty","setFocus","focus","isEventTarget","target","dispose","removeEventListener","defDropDownMenuStyleSys","listStyleType","OptionsPanel","container","dropDownItemContent","styling","getVisibleMultiSelectDataList","resetFilter","updateDropDownLocation","filterPanelSetFocus","dropDownMenu","display","hoveredMultiSelectData","hoveredMultiSelectDataIndex","candidateToHoveredMultiSelectData","skipFocusout","inShowDropDown","containerMousedown","documentMouseup","contains","setInShowDropDown","setTimeout","resetCandidateToHoveredMultiSelectData","showDropDown","hoverInInternal","index","HoverIn","dropDownMenuItemElement","resetDropDownMenuHover","HoverOut","processCandidateToHovered","visibleIndex","toggle","keyDownArrow","down","visibleMultiSelectDataList","newIndex","i","visible","onDropDownMenuItemElementMouseoverGeneral","MultiSelectData","insertDropDownItem","createSelectedItemGen","triggerChange","isSelected","isOptionDisabled","onDropDownMenuItemElementMouseover","onDropDownMenuItemElementMouseleave","appendChild","content","option","DropDownItemContent","DisposeDropDownMenuItemElement","setDropDownItemContentDisabled","disabledStyle","disable","onSelected","createSelectedItem","excludedFromSearch","item","getSkipFocusout","resetSkipFocusout","removeElement","e","parentNode","removeChild","defSelectedPanelStyleSys","flexWrap","SelectionsPanel","init","selectedItemContent","isComponentDisabled","onRemove","trySetFilterPanelFocus","trySetOptionsPanelFocus","selectedPanel","filterInputItem","MultiSelectDataSelectedTail","removeSelectedFromList","selectedPrev","selectedNext","preventDefaultMultiSelectEvent","setPreventDefaultMultiSelectEvent","selectedItemElement","removeSelectedItem","selected","select","SelectedItemContent","removeSelectedItemAndCloseDropDown","onRemoveSelectedItemEvent","isDisabled","insertBefore","selectedPanelClick","iterateAll","insert","resetMultiSelectDataSelectedTail","enable","MultiSelectInputAspect","Popper","popper","placement","modifiers","preventOverflow","enabled","hide","flip","filterInputItemOffsetLeft","destroy","alignToFilterInputItemLocation","force","offsetLeft","update","filterMultiSelectData","isFiltered","resetFilterDropDownMenu","MultiSelectDataList","multiSelectData","isHidden","collectFilterDropDownMenu","text","list","j","searchText","push","MultiSelect","optionsAdapter","labelAdapter","createStylingComposite","configuration","onDispose","window","TypeError","visibleCount","selectionsPanel","optionsPanel","stylingComposite","resetMultiSelectDataList","filteredMultiSelectDataList","processEmptyInput","Update","UpdateIsValid","getIsValid","getIsInvalid","UpdateSize","UpdateDisabled","UpdateOption","toLowerCase","trim","p1","p2","p3","removeDropDownMenuItemElement","UpdateData","updateDataImpl","createDropDownItems","options","getOptions","disabled","hidden","remove","aspect","readyState","createDropDownItemsHandler","Dispose","getDisabled","Disable","Enable","resetLength","fullMatchMultiSelectData","lazyfilterItemInputElementAtach","filterItemInputElement","filterItemElement","FocusIn","FocusOut","Init","afterContainerFilled","LabelAdapter","label","createInputId","backupedFor","getAttribute","newId","OptionsAdapterJson","trigger","firstChild","OptionsAdapterElement","selectElement","getElementsByTagName","nextSibling","classList","ExtendIfUndefined","destination","source","property","undefined","bs4StylingMethodCssDefaults","selectedPanelFocusClass","selectedPanelDisabledClass","dropDownItemDisabledClass","Bs4StylingMethodCss","$selectedPanel","removeClass","addClass","defSelectedPanelStyle","bs4StylingMethodJsDefaults","selectedPanelDefMinHeight","selectedPanelLgMinHeight","selectedPanelSmMinHeight","selectedPanelDisabledBackgroundColor","selectedPanelFocusBorderColor","selectedPanelFocusBoxShadow","selectedPanelFocusValidBoxShadow","selectedPanelFocusInvalidBoxShadow","filterInputColor","Bs4StylingMethodJs","OnInit","composite","css","$filterInput","hasClass","bs4StylingDefaults","containerClass","dropDownMenuClass","dropDownItemClass","dropDownItemHoverClass","selectedPanelClass","selectedItemClass","removeSelectedItemButtonClass","filterInputItemClass","filterInputClass","Bs4Styling","stylingMethod","$","$container","$dropDownMenu","$filterInputItem","isValid","isInvalid","dropDownItem","AddToJQueryPrototype","pluginName","createPlugin","firstChar","charAt","firstCharLower","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","each","$e","instance","data","isMethodName","test","optionsObject","removeData","methodName","noConflict","bs4StylingMethodCssdefaults","selectedItemContentDisabledClass","Bs4SelectedItemContentStylingMethodCss","disableSelectedItemContent","$content","defSelectedItemStyle","defRemoveSelectedItemButtonStyle","selectedItemContentDisabledOpacity","Bs4SelectedItemContentStylingMethodJs","createSelectedItemContent","$selectedItem","$button","bs4SelectedItemContentDefaults","Bs4SelectedItemContent","selectedItem","optionItem","preventDefaultMultiSelect","appendTo","on","jqEvent","originalEvent","prop","unbind","Bs4DropDownItemContentStylingMethodCss","$checkBox","$checkBoxLabel","isDisbaled","dropdDownLabelDisabledColor","Bs4DropDownItemContentStylingMethodJs","bs4DropDownItemContentDefaults","Bs4DropDownItemContent","$dropDownItem","$dropDownItemContent","find","tmp","element","settings","extend","preBuildConfiguration","$element","eventName","id","$formGroup","closest","$label","get","forId","name","useCss","adapter","selectedItemContentStylingMethod","bs4DropDownItemContent","dropDownItemContentStylingMethod","multiSelect","postBuildConfiguration"],"mappings":";;;;;;;;;;;;;;IAAA,SAASA,sBAAT,CAAgCC,CAAhC,EAAmC;IAACA,EAAAA,CAAC,CAACC,KAAF,GAAQ,KAAR;IAAeD,EAAAA,CAAC,CAACE,MAAF,GAAS,GAAT;IAAcF,EAAAA,CAAC,CAACG,OAAF,GAAU,GAAV;IAAeH,EAAAA,CAAC,CAACI,OAAF,GAAU,MAAV;IAAkBJ,EAAAA,CAAC,CAACK,eAAF,GAAkB,aAAlB;IAAiC;;IAEnI,SAASC,WAAT,CACQC,QADR,EAEQC,aAFR,EAGQC,oBAHR;IAIQC,qBAJR;IAKQC,cALR,EAMQC,gBANR,EAOQC,YAPR;IAQQC,kBARR;IASQC,aATR;IAUQC,0BAVR;IAWQC,KAXR;IAAA,EAYM;IAEF,MAAIC,WAAW,GAAGX,QAAQ,CAACY,aAAT,CAAuB,OAAvB,CAAlB;IAEAD,EAAAA,WAAW,CAACE,YAAZ,CAAyB,MAAzB,EAAgC,QAAhC;IACAF,EAAAA,WAAW,CAACE,YAAZ,CAAyB,cAAzB,EAAwC,KAAxC;IAEArB,EAAAA,sBAAsB,CAACmB,WAAW,CAACG,KAAb,CAAtB;IAEAb,EAAAA,aAAa,CAACU,WAAD,CAAb;;IAEA,MAAII,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,KAAD,EAAW;IAClC,QAAI,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb,EAAiBC,OAAjB,CAAyBD,KAAK,CAACE,KAA/B,KAAuC,CAAvC,IAA6CF,KAAK,CAACE,KAAN,IAAe,CAAf,IAAoBP,WAAW,CAACQ,KAAjF,EAA0F;IACtFH,MAAAA,KAAK,CAACI,cAAN,GADsF;IAEzF;;IAED,QAAIJ,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAuB;IACnBd,MAAAA,cAAc;IACjB,KAFD,MAGK,IAAIY,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAuB;IACxBb,MAAAA,gBAAgB;IACnB,KAFI,MAGA,IAAIW,KAAK,CAACE,KAAN,IAAe;IAAG;IAAtB,MAA+B;IAAE;IAClC,YAAI,CAACP,WAAW,CAACQ,KAAjB,EAAwB;IACnBb,UAAAA,YAAY,GADO;IAEvB;IACJ,OAJI,MAKA,IAAIU,KAAK,CAACE,KAAN,IAAe;IAAE;IAArB,MAAoC;IACrC;IACA;IACA;IACA,YAAI,CAACP,WAAW,CAACQ,KAAjB,EACA;IACIZ,UAAAA,kBAAkB;IACrB;IACJ,OAxBiC;IA2BlC;;IACH,GA5BD;;IA8BA,MAAIc,kBAAkB,GAAG,SAArBA,kBAAqB,CAACL,KAAD,EAAW;IAChC,QAAIA,KAAK,CAACE,KAAN,IAAe,EAAf,IAAqBF,KAAK,CAACE,KAAN,IAAe,CAAxC,EAA2C;IACvCV,MAAAA,aAAa;IAChB,KAFD,MAGK,IAAIQ,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAuB;IAAE;IAC1BT,MAAAA,0BAA0B;IAC7B;IACJ,GAPD,CAzCE;IAmDF;IACA;IACA;;;IACA,MAAIa,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;IAC3B,QAAIC,gBAAgB,GAAGZ,WAAW,CAACQ,KAAnC;IACAT,IAAAA,KAAK,CACDa,gBADC,EAED;IAAA,aAAKZ,WAAW,CAACG,KAAZ,CAAkBpB,KAAlB,GAA0B6B,gBAAgB,CAACC,MAAjB,GAAwB,GAAxB,GAA8B,CAA9B,GAAkC,IAAjE;IAAA,KAFC,CAAL;IAIH,GAND;;IAQA,MAAIC,cAAc,GAAE,SAAhBA,cAAgB,GAAK;IACrBd,IAAAA,WAAW,CAACG,KAAZ,CAAkBpB,KAAlB,GAAwB,KAAxB;IACH,GAFD;;IAIA,MAAIgC,QAAQ,GAAE,SAAVA,QAAU,GAAK;IACff,IAAAA,WAAW,CAACQ,KAAZ,GAAmB,EAAnB;IACAM,IAAAA,cAAc;IACjB,GAHD;;IAKAd,EAAAA,WAAW,CAACgB,gBAAZ,CAA6B,SAA7B,EAAwCzB,oBAAxC;IACAS,EAAAA,WAAW,CAACgB,gBAAZ,CAA6B,UAA7B,EAAyCxB,qBAAzC;IACAQ,EAAAA,WAAW,CAACgB,gBAAZ,CAA6B,SAA7B,EAAwCZ,oBAAxC;IACAJ,EAAAA,WAAW,CAACgB,gBAAZ,CAA6B,OAA7B,EAAsCN,kBAAtC;IACAV,EAAAA,WAAW,CAACgB,gBAAZ,CAA6B,OAA7B,EAAsCL,kBAAtC;IAEA,MAAIM,WAAW,GAAG;IACdlB,IAAAA,KAAK,EAACC,WADQ;IAEdkB,IAAAA,OAFc,qBAEL;IACL,aAAOlB,WAAW,CAACQ,KAAZ,GAAoB,KAApB,GAA0B,IAAjC;IACH,KAJa;IAKdO,IAAAA,QAAQ,EAARA,QALc;IAMdD,IAAAA,cAAc,EAAdA,cANc;IAOdK,IAAAA,QAPc,sBAOJ;IACNnB,MAAAA,WAAW,CAACoB,KAAZ;IACH,KATa;IAUdC,IAAAA,aAVc,yBAUAhB,KAVA,EAUM;IAChB,aAAOA,KAAK,CAACiB,MAAN,IAAgBtB,WAAvB;IACH,KAZa;IAaduB,IAAAA,OAbc,qBAaL;IACLvB,MAAAA,WAAW,CAACwB,mBAAZ,CAAgC,SAAhC,EAA2CjC,oBAA3C;IACAS,MAAAA,WAAW,CAACwB,mBAAZ,CAAgC,UAAhC,EAA4ChC,qBAA5C;IACAQ,MAAAA,WAAW,CAACwB,mBAAZ,CAAgC,SAAhC,EAA2CpB,oBAA3C;IACAJ,MAAAA,WAAW,CAACwB,mBAAZ,CAAgC,OAAhC,EAAyCd,kBAAzC;IACAV,MAAAA,WAAW,CAACwB,mBAAZ,CAAgC,OAAhC,EAAyCb,kBAAzC;IACH;IAnBa,GAAlB;IAqBA,SAAOM,WAAP;IACH;;ICjHD,SAASQ,uBAAT,CAAiC3C,CAAjC,EAAoC;IAACA,EAAAA,CAAC,CAAC4C,aAAF,GAAgB,MAAhB;IAAuB;;IAE5D,SAASC,YAAT,CAAsBtC,QAAtB,EAAgCuC,SAAhC,EAA2CC,mBAA3C,EAAgEC,OAAhE,EACQC,6BADR,EACuCC,WADvC,EACmDC,sBADnD,EAC2EC,mBAD3E,EACgG;IAC5F,MAAIC,YAAY,GAAG9C,QAAQ,CAACY,aAAT,CAAuB,IAAvB,CAAnB;IACAkC,EAAAA,YAAY,CAAChC,KAAb,CAAmBiC,OAAnB,GAA2B,MAA3B,CAF4F;;IAK5FX,EAAAA,uBAAuB,CAACU,YAAY,CAAChC,KAAd,CAAvB;IACA,MAAIkC,sBAAsB,GAAC,IAA3B;IACA,MAAIC,2BAA2B,GAAG,IAAlC;IACA,MAAIC,iCAAiC,GAAC,IAAtC;IAEA,MAAIC,YAAY,GAAG,KAAnB;IACA,MAAIC,cAAc,GAAG,KAArB,CAX4F;;IAc5F,MAAIC,kBAAkB,GAAG,SAArBA,kBAAqB,GAAU;IAC/BF,IAAAA,YAAY,GAAG,IAAf;IACH,GAFD,CAd4F;;;IAmB5F,MAAIG,eAAe,GAAG,SAAlBA,eAAkB,CAAStC,KAAT,EAAgB;IAClC;IACA,QAAI,EAAEuB,SAAS,KAAKvB,KAAK,CAACiB,MAApB,IAA8BM,SAAS,CAACgB,QAAV,CAAmBvC,KAAK,CAACiB,MAAzB,CAAhC,CAAJ,EAAuE;IACnE3B,MAAAA,YAAY;IACZqC,MAAAA,WAAW;IACd;IACJ,GAND;;IAQA,WAASa,iBAAT,GAA4B;IACxBJ,IAAAA,cAAc,GAAG,IAAjB;IACIK,IAAAA,UAAU,CAAE,YAAM;IACdL,MAAAA,cAAc,GAAG,IAAjB;IACH,KAFS,EAEP,CAFO,CAAV;IAGP;;IAED,WAAS9C,YAAT,GAAwB;IACpB,QAAI4C,iCAAJ,EAAsC;IAClCQ,MAAAA,sCAAsC;IACzC;;IACD,QAAIZ,YAAY,CAAChC,KAAb,CAAmBiC,OAAnB,IAA8B,MAAlC,EACA;IACID,MAAAA,YAAY,CAAChC,KAAb,CAAmBiC,OAAnB,GAA6B,MAA7B,CADJ;;IAGIR,MAAAA,SAAS,CAACJ,mBAAV,CAA8B,WAA9B,EAA2CkB,kBAA3C;IACArD,MAAAA,QAAQ,CAACmC,mBAAT,CAA6B,SAA7B,EAAwCmB,eAAxC;IACH;IACJ;;IAED,WAASK,YAAT,GAAwB;IACpB,QAAIb,YAAY,CAAChC,KAAb,CAAmBiC,OAAnB,IAA8B,OAAlC,EACA;IACIS,MAAAA,iBAAiB;IACjBV,MAAAA,YAAY,CAAChC,KAAb,CAAmBiC,OAAnB,GAA6B,OAA7B,CAFJ;;IAIIR,MAAAA,SAAS,CAACZ,gBAAV,CAA2B,WAA3B,EAAwC0B,kBAAxC;IACArD,MAAAA,QAAQ,CAAC2B,gBAAT,CAA0B,SAA1B,EAAqC2B,eAArC;IACH;IACJ;;IAED,MAAIM,eAAe,GAAG,SAAlBA,eAAkB,CAASC,KAAT,EAAe;IACjCZ,IAAAA,2BAA2B,GAAGY,KAA9B;IACAb,IAAAA,sBAAsB,GAAGN,6BAA6B,GAAGmB,KAAH,CAAtD;IACApB,IAAAA,OAAO,CAACqB,OAAR,CAAgBd,sBAAsB,CAACe,uBAAvC;IACH,GAJD;;IAMA,WAASC,sBAAT,GAAkC;IAC9B,QAAIhB,sBAAJ,EAA4B;IACxBP,MAAAA,OAAO,CAACwB,QAAR,CAAiBjB,sBAAsB,CAACe,uBAAxC;IACAf,MAAAA,sBAAsB,GAAG,IAAzB;IACAC,MAAAA,2BAA2B,GAAG,IAA9B;IACH;IACJ;;IAED,MAAIS,sCAAsC,GAAG,SAAzCA,sCAAyC,GAAU;IACnDR,IAAAA,iCAAiC,CAACa,uBAAlC,CAA0D5B,mBAA1D,CAA8E,WAA9E,EAA2F+B,yBAA3F;IACAhB,IAAAA,iCAAiC,CAACa,uBAAlC,CAA0D5B,mBAA1D,CAA8E,WAA9E,EAA2F+B,yBAA3F;IACAhB,IAAAA,iCAAiC,GAAG,IAApC;IACH,GAJD;;IAMA,MAAIgB,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAW;IACvC,QAAIlB,sBAAsB,IAAIE,iCAA9B,EACA;IACIc,MAAAA,sBAAsB;IACtBJ,MAAAA,eAAe,CAACV,iCAAiC,CAACiB,YAAnC,CAAf;IACH;;IACD,QAAGjB,iCAAH,EACIQ,sCAAsC;IAC7C,GARD;;IAUA,WAASlD,aAAT,GAAwB;IACpB,QAAIwC,sBAAJ,EAA4B;IACxBA,MAAAA,sBAAsB,CAACoB,MAAvB;IACAJ,MAAAA,sBAAsB;IACtB1D,MAAAA,YAAY,GAHY;;IAIxBqC,MAAAA,WAAW;IACd;IACJ;;IAED,WAAS0B,YAAT,CAAsBC,IAAtB,EAA4B;IACxB,QAAIC,0BAA0B,GAAG7B,6BAA6B,EAA9D;IACA,QAAIlB,MAAM,GAAG+C,0BAA0B,CAAC/C,MAAxC;IACA,QAAIgD,QAAQ,GAAC,IAAb;;IACA,QAAIhD,MAAM,GAAG,CAAb,EAAgB;IACZ,UAAI8C,IAAJ,EAAU;IACN,YAAIG,CAAC,GAAGxB,2BAA2B,IAAE,IAA7B,GAAkC,CAAlC,GAAoCA,2BAA2B,GAAC,CAAxE;;IACA,eAAMwB,CAAC,GAACjD,MAAR,EAAe;IACX,cAAI+C,0BAA0B,CAACE,CAAD,CAA1B,CAA8BC,OAAlC,EAA0C;IACtCF,YAAAA,QAAQ,GAACC,CAAT;IACA;IACH;;IACDA,UAAAA,CAAC;IACJ;IACJ,OATD,MASO;IACH,YAAIA,EAAC,GAAGxB,2BAA2B,IAAE,IAA7B,GAAkCzB,MAAM,GAAC,CAAzC,GAA2CyB,2BAA2B,GAAC,CAA/E;;IACA,eAAMwB,EAAC,IAAE,CAAT,EAAW;IACP,cAAIF,0BAA0B,CAACE,EAAD,CAA1B,CAA8BC,OAAlC,EAA0C;IACtCF,YAAAA,QAAQ,GAACC,EAAT;IACA;IACH;;IACDA,UAAAA,EAAC;IACJ;IACJ;IACJ;;IAED,QAAID,QAAQ,IAAE,IAAd,EACA;IACI,UAAIxB,sBAAJ,EACIP,OAAO,CAACwB,QAAR,CAAiBjB,sBAAsB,CAACe,uBAAxC;IACJnB,MAAAA,sBAAsB;IACtBe,MAAAA,YAAY;IACZC,MAAAA,eAAe,CAACY,QAAD,CAAf;IACH;IACJ;;IAED,MAAKG,yCAAyC,GAAG,SAA5CA,yCAA4C,CAASC,eAAT,EAA0Bb,uBAA1B,EACjD;IACI,QAAIX,cAAJ,EACA;IACI,UAAGF,iCAAH,EACIQ,sCAAsC;IAE1CR,MAAAA,iCAAiC,GAAG0B,eAApC;IACAb,MAAAA,uBAAuB,CAACpC,gBAAxB,CAAyC,WAAzC,EAAsDuC,yBAAtD;IACAH,MAAAA,uBAAuB,CAACpC,gBAAxB,CAAyC,WAAzC,EAAsDuC,yBAAtD;IACH,KARD,MAUA;IACI,UAAIlB,sBAAsB,IAAE4B,eAA5B,EACA;IACI;IACA;IACA;IACAZ,QAAAA,sBAAsB;IACtBJ,QAAAA,eAAe,CAACgB,eAAe,CAACT,YAAjB,CAAf;IACH;IACJ;IACJ,GAtBD;;IAwBA,WAASU,kBAAT,CAA4BD,eAA5B,EAA6CE,qBAA7C,EAAoEC,aAApE,EAAmFC,UAAnF,EAA+FC,gBAA/F,EAAiH;IAC7G,QAAIlB,uBAAuB,GAAG/D,QAAQ,CAACY,aAAT,CAAuB,IAAvB,CAA9B,CAD6G;IAI7G;IACA;IACA;;IAEA,QAAIsE,kCAAkC,GAAG,SAArCA,kCAAqC;IAAA,aAAMP,yCAAyC,CACpFC,eADoF,EAEpFb,uBAFoF,CAA/C;IAAA,KAAzC;;IAKAA,IAAAA,uBAAuB,CAACpC,gBAAxB,CAAyC,WAAzC,EAAsDuD,kCAAtD,EAb6G;IAgB7G;;IACA,QAAIC,mCAAmC,GAAG,SAAtCA,mCAAsC;IAAA,aAAMnB,sBAAsB,EAA5B;IAAA,KAA1C;;IACAD,IAAAA,uBAAuB,CAACpC,gBAAxB,CAAyC,YAAzC,EAAuDwD,mCAAvD;IAEArC,IAAAA,YAAY,CAACsC,WAAb,CAAyBrB,uBAAzB;IAEA,QAAIsB,OAAO,GAAG7C,mBAAmB,CAACuB,uBAAD,EAA0Ba,eAAe,CAACU,MAA1C,CAAjC;IACAV,IAAAA,eAAe,CAACb,uBAAhB,GAA0CA,uBAA1C;IACAa,IAAAA,eAAe,CAACW,mBAAhB,GAAsCF,OAAtC;;IAEAT,IAAAA,eAAe,CAACY,8BAAhB,GAAiD,YAAK;IAClDzB,MAAAA,uBAAuB,CAAC5B,mBAAxB,CAA4C,WAA5C,EAA0D+C,kCAA1D;IACAnB,MAAAA,uBAAuB,CAAC5B,mBAAxB,CAA4C,YAA5C,EAA0DgD,mCAA1D;IACH,KAHD;;IAKA,QAAIM,8BAA8B,GAAG,SAAjCA,8BAAiC,CAACJ,OAAD,EAAWL,UAAX,EAA0B;IAC3DK,MAAAA,OAAO,CAACK,aAAR,CAAsB,IAAtB,EAD2D;;IAG3DL,MAAAA,OAAO,CAACM,OAAR,CAAgB,CAACX,UAAjB;IACH,KAJD;;IAMA,QAAIC,gBAAJ,EACIQ,8BAA8B,CAACJ,OAAD,EAAUL,UAAV,CAA9B;IAEJK,IAAAA,OAAO,CAACO,UAAR,CAAoB,YAAM;IACtBhB,MAAAA,eAAe,CAACR,MAAhB;IACAvB,MAAAA,mBAAmB;IACtB,KAHD,EAxC6G;;IA8C7G,QAAIgD,kBAAkB,GAAG,SAArBA,kBAAqB;IAAA,aAAMf,qBAAqB,CAChDF,eADgD,EAEhDK,gBAFgD,EAGhD;IAAA,eAAMQ,8BAA8B,CAACJ,OAAD,EAAU,KAAV,CAApC;IAAA,OAHgD,CAA3B;IAAA,KAAzB;;IAMA,QAAIL,UAAJ,EACA;IACIa,MAAAA,kBAAkB;IACrB,KAHD,MAKA;IACIjB,MAAAA,eAAe,CAACkB,kBAAhB,GAAsCb,gBAAtC;IACA,UAAIA,gBAAJ,EACIL,eAAe,CAACR,MAAhB,GAAyB,YAAM,EAA/B,CADJ,KAGIQ,eAAe,CAACR,MAAhB,GAAyB,YAAO;IAC5ByB,QAAAA,kBAAkB;IAClBd,QAAAA,aAAa;IAChB,OAHD;IAIP,KAlE4G;IAoE7G;IACA;IACA;IACA;IACA;;IACH;;IAED,MAAIgB,IAAI,GAAG;IACPjD,IAAAA,YAAY,EAAZA,YADO;IAEPc,IAAAA,eAAe,EAAfA,eAFO;IAGPI,IAAAA,sBAAsB,EAAtBA,sBAHO;IAIPR,IAAAA,iBAAiB,EAAjBA,iBAJO;IAKPG,IAAAA,YAAY,EAAZA,YALO;IAMPrD,IAAAA,YAAY,EAAZA,YANO;IAOPE,IAAAA,aAAa,EAAbA,aAPO;IAQPwF,IAAAA,eAAe,EAAG,2BAAW;IAAC,aAAO7C,YAAP;IAAoB,KAR3C;IASP8C,IAAAA,iBAAiB,EAAG,6BAAW;IAAC9C,MAAAA,YAAY,GAAC,KAAb;IAAmB,KAT5C;IAUPkB,IAAAA,YAAY,EAAZA,YAVO;IAWPQ,IAAAA,kBAAkB,EAAlBA;IAXO,GAAX;IAcA,SAAOkB,IAAP;IACH;;IC1PD,SAASG,aAAT,CAAuBC,CAAvB,EAA0B;IAACA,EAAAA,CAAC,CAACC,UAAF,CAAaC,WAAb,CAAyBF,CAAzB;IAA4B;;ICEvD,SAASG,wBAAT,CAAkC7G,CAAlC,EAAqC;IAACA,EAAAA,CAAC,CAACsD,OAAF,GAAU,MAAV;IAAkBtD,EAAAA,CAAC,CAAC8G,QAAF,GAAW,MAAX;IAAmB9G,EAAAA,CAAC,CAAC4C,aAAF,GAAgB,MAAhB;IAAuB;;IAElG,SAASmE,eAAT,CAA0BxG,QAA1B,EAAoCyG,IAApC,EACIC,mBADJ,EAEIC,mBAFJ,EAGI5B,aAHJ,EAII6B,QAJJ,EAKIC,sBALJ,EAMIC,uBANJ,EAM6B;IACzB,MAAIC,aAAa,GAAG/G,QAAQ,CAACY,aAAT,CAAuB,IAAvB,CAApB;IACA0F,EAAAA,wBAAwB,CAACS,aAAa,CAACjG,KAAf,CAAxB;IACA,MAAIkG,eAAe,GAAGhH,QAAQ,CAACY,aAAT,CAAuB,IAAvB,CAAtB,CAHyB;;IAIzBmG,EAAAA,aAAa,CAAC3B,WAAd,CAA0B4B,eAA1B,EAJyB;;IAMzBP,EAAAA,IAAI,CAACO,eAAD,CAAJ;IACA,MAAIC,2BAA2B,GAAG,IAAlC;;IAEA,WAAS1G,kBAAT,GAA6B;IACzB,QAAI0G,2BAAJ,EAAgC;IAC5BA,MAAAA,2BAA2B,CAAC7C,MAA5B,GAD4B;IAE/B;IACJ;;IAED,WAAS8C,sBAAT,CAAgCtC,eAAhC,EAAgD;IAC5C,QAAIA,eAAe,CAACuC,YAApB,EAAiC;IAC5BvC,MAAAA,eAAe,CAACuC,YAAjB,CAA+BC,YAA/B,GAA8CxC,eAAe,CAACwC,YAA9D;IACH;;IACD,QAAIxC,eAAe,CAACwC,YAApB,EAAiC;IAC7BxC,MAAAA,eAAe,CAACwC,YAAjB,CAA+BD,YAA/B,GAA8CvC,eAAe,CAACuC,YAA9D;IACF;;IACD,QAAIF,2BAA2B,IAAIrC,eAAnC,EAAmD;IAC/CqC,MAAAA,2BAA2B,GAAGrC,eAAe,CAACuC,YAA9C;IACH;;IACDvC,IAAAA,eAAe,CAACwC,YAAhB,GAA6B,IAA7B;IACAxC,IAAAA,eAAe,CAACuC,YAAhB,GAA6B,IAA7B;IACH;;IAED,MAAIE,8BAAJ;;IACA,MAAIC,iCAAiC,GAAG,SAApCA,iCAAoC,CAACtG,KAAD,EAAS;IAC7CqG,IAAAA,8BAA8B,GAAGrG,KAAjC;IACH,GAFD;;IAIA,WAAS6E,kBAAT,CAA4BjB,eAA5B,EAA6CK,gBAA7C,EAA+DQ,8BAA/D,EAA+F;IAC3F,QAAI8B,mBAAmB,GAAGvH,QAAQ,CAACY,aAAT,CAAuB,IAAvB,CAA1B;IACAgE,IAAAA,eAAe,CAAC2C,mBAAhB,GAAsCA,mBAAtC;;IACA,QAAIN,2BAAJ,EAAgC;IAC5BA,MAAAA,2BAA2B,CAACG,YAA5B,GAA2CxC,eAA3C;IACAA,MAAAA,eAAe,CAACuC,YAAhB,GAA+BF,2BAA/B;IACH;;IACDA,IAAAA,2BAA2B,GAAGrC,eAA9B;;IAEA,QAAI4C,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;IAC3B5C,MAAAA,eAAe,CAACU,MAAhB,CAAuBmC,QAAvB,GAAkC,KAAlC;IACA7C,MAAAA,eAAe,CAACkB,kBAAhB,GAAqCb,gBAArC;;IACA,UAAIA,gBAAJ,EACA;IACIQ,QAAAA,8BAA8B,CAACb,eAAe,CAACW,mBAAjB,EAAsC,KAAtC,CAA9B;;IACAX,QAAAA,eAAe,CAACR,MAAhB,GAAyB,YAAK,EAA9B;IACH,OAJD,MAMA;IACIQ,QAAAA,eAAe,CAACR,MAAhB,GAAyB,YAAI;IACzByB,UAAAA,kBAAkB,CAACjB,eAAD,EAAkBK,gBAAlB,EAAoCQ,8BAApC,CAAlB;IACAV,UAAAA,aAAa;IAChB,SAHD;IAIH;;IACDH,MAAAA,eAAe,CAACW,mBAAhB,CAAoCmC,MAApC,CAA2C,KAA3C;IACAxB,MAAAA,aAAa,CAACqB,mBAAD,CAAb;IACA3C,MAAAA,eAAe,CAAC+C,mBAAhB,CAAoCzF,OAApC;IACA0C,MAAAA,eAAe,CAAC+C,mBAAhB,GAAoC,IAApC;IACA/C,MAAAA,eAAe,CAAC2C,mBAAhB,GAAoC,IAApC;IAEAL,MAAAA,sBAAsB,CAACtC,eAAD,CAAtB;IACAG,MAAAA,aAAa;IAChB,KAvBD,CAT2F;IAmC3F;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;;IAEA,QAAI6C,kCAAkC,GAAG,SAArCA,kCAAqC,GAAM;IAC3CJ,MAAAA,kBAAkB;IAClBZ,MAAAA,QAAQ;IACX,KAHD;;IAKA,QAAIiB,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAM;IAClCpE,MAAAA,UAAU,CAAE,YAAM;IACdmE,QAAAA,kCAAkC;IACrC,OAFS,EAEP,CAFO,CAAV;IAGH,KAJD;;IAMAhD,IAAAA,eAAe,CAAC+C,mBAAhB,GAAsCjB,mBAAmB,CACrDa,mBADqD,EAErD3C,eAAe,CAACU,MAFqC,EAGrDuC,yBAHqD,EAIrDP,iCAJqD,CAAzD;;IAMA,QAAI3B,OAAO,GAAG,SAAVA,OAAU,CAACmC,UAAD;IAAA,aACVlD,eAAe,CAAC+C,mBAAhB,CAAoChC,OAApC,CAA4CmC,UAA5C,CADU;IAAA,KAAd;;IAEAnC,IAAAA,OAAO,CAACgB,mBAAD,CAAP;IAEA/B,IAAAA,eAAe,CAACU,MAAhB,CAAuBmC,QAAvB,GAAkC,IAAlC;IACA7C,IAAAA,eAAe,CAACkB,kBAAhB,GAAqC,IAArC,CApE2F;IAqE3F;;IACAlB,IAAAA,eAAe,CAACe,OAAhB,GAA0BA,OAA1B;IACAoB,IAAAA,aAAa,CAACgB,YAAd,CAA2BR,mBAA3B,EAAgDP,eAAhD;;IAGApC,IAAAA,eAAe,CAACR,MAAhB,GAAyB;IAAA,aAAMoD,kBAAkB,EAAxB;IAAA,KAAzB;;IACA5C,IAAAA,eAAe,CAACW,mBAAhB,CAAoCmC,MAApC,CAA2C,IAA3C;IAEH;;IAED,MAAIM,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAhH,KAAK,EAAI;IAE9B6F,IAAAA,sBAAsB,CAAC7F,KAAD,CAAtB;;IACA,QAAIqG,8BAA8B,IAAIrG,KAAtC,EAA6C;IACzC8F,MAAAA,uBAAuB;IAC1B;;IACDO,IAAAA,8BAA8B,GAAC,IAA/B;IACH,GAPD;;IAUA,WAASY,UAAT,CAAoBH,UAApB,EAA+B;IAC3B,QAAIrD,CAAC,GAAGwC,2BAAR;;IACA,WAAMxC,CAAN,EAAQ;IACJA,MAAAA,CAAC,CAACkB,OAAF,CAAUmC,UAAV;IACArD,MAAAA,CAAC,GAAGA,CAAC,CAAC0C,YAAN;IACH;IACJ;;IAGD,MAAIpB,IAAI,GAAG;IACPgB,IAAAA,aAAa,EAAbA,aADO;IAEPC,IAAAA,eAAe,EAAfA,eAFO;IAGPkB,IAAAA,MAHO,kBAGAX,mBAHA,EAGoB;IACvB,WAAKR,aAAL,CAAmBgB,YAAnB,CAAgCR,mBAAhC,EAAqDP,eAArD;IACH,KALM;IAMPnB,IAAAA,kBAAkB,EAAlBA,kBANO;IAOPtF,IAAAA,kBAAkB,EAAlBA,kBAPO;IAQP4H,IAAAA,gCARO,8CAQ4B;IAC/BlB,MAAAA,2BAA2B,GAAG,IAA9B;IACH,KAVM;IAWPmB,IAAAA,MAXO,oBAWC;IACJpB,MAAAA,eAAe,CAAClG,KAAhB,CAAsBiC,OAAtB,GAAgC,WAAhC;IACAkF,MAAAA,UAAU,CAAC,KAAD,CAAV;IACAlB,MAAAA,aAAa,CAACpF,gBAAd,CAA+B,OAA/B,EAAwCqG,kBAAxC;IAEH,KAhBM;IAiBPrC,IAAAA,OAjBO,qBAiBE;IACLqB,MAAAA,eAAe,CAAClG,KAAhB,CAAsBiC,OAAtB,GAAgC,MAAhC;IACAkF,MAAAA,UAAU,CAAC,IAAD,CAAV;IACAlB,MAAAA,aAAa,CAAC5E,mBAAd,CAAkC,OAAlC,EAA2C6F,kBAA3C;IAEH,KAtBM;IAuBP9F,IAAAA,OAvBO,qBAuBE;IACL6E,MAAAA,aAAa,CAAC5E,mBAAd,CAAkC,OAAlC,EAA2C6F,kBAA3C,EADK;IAER;IAzBM,GAAX;IA2BA,SAAOjC,IAAP;IACH;;IC1KD,SAASsC,sBAAT,CACIrI,QADJ,EAEIuC,SAFJ,EAGIwE,aAHJ,EAIIC,eAJJ,EAIqBlE,YAJrB,EAImCwF,MAJnC,EAKM;IAEF/F,EAAAA,SAAS,CAAC6C,WAAV,CAAsB2B,aAAtB;IACAxE,EAAAA,SAAS,CAAC6C,WAAV,CAAsBtC,YAAtB;IAEA,MAAIyF,MAAM,GAAG,IAAID,MAAJ,CACTtB,eADS,EAETlE,YAFS,EAGT;IACI0F,IAAAA,SAAS,EAAE,cADf;IAEIC,IAAAA,SAAS,EAAE;IACPC,MAAAA,eAAe,EAAE;IAACC,QAAAA,OAAO,EAAC;IAAT,OADV;IAEPC,MAAAA,IAAI,EAAE;IAACD,QAAAA,OAAO,EAAC;IAAT,OAFC;IAGPE,MAAAA,IAAI,EAAE;IAACF,QAAAA,OAAO,EAAC;IAAT;IAHC;IAFf,GAHS,CAAb;IAaA,MAAIG,yBAAyB,GAAG,IAAhC;IAEA,SAAO;IACH5G,IAAAA,OADG,qBACM;IACLqG,MAAAA,MAAM,CAACQ,OAAP;IACH,KAHE;IAIHC,IAAAA,8BAJG,0CAI4BC,KAJ5B,EAImC;IAClC,UAAIC,UAAU,GAAGlC,eAAe,CAACkC,UAAjC;;IACA,UAAID,KAAK,IAAIH,yBAAyB,IAAII,UAA1C,EAAqD;IAAE;IACnDX,QAAAA,MAAM,CAACY,MAAP;IACA,aAAKL,yBAAL,GAA+BI,UAA/B;IACH;IACJ;IAVE,GAAP;IAYH;;IC/BD,SAASE,qBAAT,CAA+BxE,eAA/B,EAAgDyE,UAAhD,EAA4DlF,YAA5D,EAA0E;IACtES,EAAAA,eAAe,CAACF,OAAhB,GAA0B2E,UAA1B;IACAzE,EAAAA,eAAe,CAACT,YAAhB,GAA+BA,YAA/B;IACAS,EAAAA,eAAe,CAACb,uBAAhB,CAAwCjD,KAAxC,CAA8CiC,OAA9C,GAAwDsG,UAAU,GAAG,OAAH,GAAY,MAA9E;IACH;;IAED,SAASC,uBAAT,CAAiCC,mBAAjC,EAAsD;IAClD,OAAI,IAAI9E,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC8E,mBAAmB,CAAC/H,MAAnC,EAA2CiD,CAAC,EAA5C,EACA;IACI,QAAI+E,eAAe,GAAGD,mBAAmB,CAAC9E,CAAD,CAAzC;;IACA,QAAK,CAAC+E,eAAe,CAACC,QAAtB,EACA;IACIL,MAAAA,qBAAqB,CAACI,eAAD,EAAkB,IAAlB,EAAwB/E,CAAxB,CAArB;IACH;IACJ;IACJ;;IAED,SAASiF,yBAAT,CAAmCH,mBAAnC,EAAwDI,IAAxD,EAA8D;IAC1D,MAAIC,IAAI,GAAG,EAAX;IACA,MAAIC,CAAC,GAAG,CAAR;;IACA,OAAI,IAAIpF,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC8E,mBAAmB,CAAC/H,MAAnC,EAA2CiD,CAAC,EAA5C,EACA;IACI,QAAI+E,eAAe,GAAGD,mBAAmB,CAAC9E,CAAD,CAAzC;;IACA,QAAK,CAAC+E,eAAe,CAACC,QAAtB,EACA;IACI,UAAKD,eAAe,CAAC1D,kBAAhB,IAAsC0D,eAAe,CAACM,UAAhB,CAA2B7I,OAA3B,CAAmC0I,IAAnC,IAAyC,CAApF,EACA;IACIP,QAAAA,qBAAqB,CAACI,eAAD,EAAkB,KAAlB,CAArB;IACH,OAHD,MAKA;IACIJ,QAAAA,qBAAqB,CAACI,eAAD,EAAkB,IAAlB,EAAwBK,CAAC,EAAzB,CAArB;IACAD,QAAAA,IAAI,CAACG,IAAL,CAAWP,eAAX;IACH;IACJ;IACJ;;IACD,SAAOI,IAAP;IACH;;QAEKI;;;IACF,uBAAYC,cAAZ,EAA4BxH,OAA5B,EACIiE,mBADJ,EACyBlE,mBADzB,EAEI0H,YAFJ,EAEkBC,sBAFlB,EAGIC,aAHJ,EAGmBC,SAHnB,EAG8BC,MAH9B,EAGsC;IAClC,QAAI,OAAOhC,MAAP,KAAkB,WAAtB,EAAmC;IAC/B,YAAM,IAAIiC,SAAJ,CAAc,uEAAd,CAAN;IACH,KAHiC;;;IAMlC,SAAKN,cAAL,GAAsBA,cAAtB;IACA,SAAK1H,SAAL,GAAiB0H,cAAc,CAAC1H,SAAhC,CAPkC;;IAQlC,SAAKE,OAAL,GAAeA,OAAf;IACA,SAAKiE,mBAAL,GAA2BA,mBAA3B;IACA,SAAKlE,mBAAL,GAA2BA,mBAA3B;IACA,SAAK0H,YAAL,GAAoBA,YAApB;IACA,SAAKC,sBAAL,GAA8BA,sBAA9B;IACA,SAAKC,aAAL,GAAqBA,aAArB;IACA,SAAKC,SAAL,GAAiBA,SAAjB;IACA,SAAKC,MAAL,GAAcA,MAAd;IACA,SAAKtK,QAAL,GAAgBsK,MAAM,CAACtK,QAAvB,CAhBkC;;IAoBlC,SAAKwK,YAAL,GAAkB,EAAlB;IAEA,SAAKC,eAAL,GAAuB,IAAvB;IACA,SAAKzD,eAAL,GAAuB,IAAvB;IACA,SAAK0D,YAAL,GAAoB,IAApB;IAEA,SAAKC,gBAAL,GAAwB,IAAxB,CA1BkC;;IA6BlC,SAAKrH,eAAL,GAAuB,IAAvB;IACA,SAAKD,kBAAL,GAA0B,IAA1B,CA9BkC;;IAiClC,SAAKsD,mBAAL,GAA2B,IAA3B;IACA,SAAKmC,yBAAL,GAAiC,IAAjC,CAlCkC;;IAoClC,SAAK8B,wBAAL;IACH;;;;aAEDA,2BAAA,oCAA0B;IACtB,SAAKrB,mBAAL,GAA2B,EAA3B;IACA,SAAKsB,2BAAL,GAAmC,IAAnC;IACH;;aAGDnI,gCAAA,yCAA+B;IAC3B,QAAI,KAAKmI,2BAAT,EACI,OAAO,KAAKA,2BAAZ,CADJ,KAGI,OAAO,KAAKtB,mBAAZ;IACP;;aAED5G,cAAA,uBAAa;IACT,QAAI,CAAC,KAAKf,WAAL,CAAiBC,OAAjB,EAAL,EAAiC;IAC7B,WAAKD,WAAL,CAAiBF,QAAjB;IACA,WAAKoJ,iBAAL;IACH;IACJ;;aAEDA,oBAAA,6BAAmB;IACf,SAAKlJ,WAAL,CAAiBH,cAAjB;IACA6H,IAAAA,uBAAuB,CAAC,KAAKC,mBAAN,CAAvB;IACA,SAAKsB,2BAAL,GAAmC,IAAnC;IACH;;;aAGDE,SAAA,kBAAQ;IACJ,SAAKtI,OAAL,CAAauI,aAAb,CAA2B,KAAKL,gBAAhC,EAAkD,KAAKV,cAAL,CAAoBgB,UAApB,EAAlD,EAAoF,KAAKhB,cAAL,CAAoBiB,YAApB,EAApF;IACA,SAAKC,UAAL;IACA,SAAKC,cAAL;IACH;;aAEDC,eAAA,sBAAaxH,KAAb,EAAmB;IAAA;;IACf,QAAI2F,eAAe,GAAG,KAAKD,mBAAL,CAAyB1F,KAAzB,CAAtB;IACA,QAAIyB,MAAM,GAAGkE,eAAe,CAAClE,MAA7B;IACAkE,IAAAA,eAAe,CAACM,UAAhB,GAA6BxE,MAAM,CAACqE,IAAP,CAAY2B,WAAZ,GAA0BC,IAA1B,EAA7B;;IACA,QAAI/B,eAAe,CAACC,QAAhB,IAA4BnE,MAAM,CAACmE,QAAvC,EACA;IACID,MAAAA,eAAe,CAACC,QAAhB,GAAyBnE,MAAM,CAACmE,QAAhC;IACA,UAAID,eAAe,CAACC,QAApB,EACI,KAAKiB,YAAL,CAAkB7F,kBAAlB,CAAqC2E,eAArC,EACI,UAACgC,EAAD,EAAIC,EAAJ,EAAOC,EAAP;IAAA,eAAY,KAAI,CAACjB,eAAL,CAAqB5E,kBAArB,CAAwC2F,EAAxC,EAA2CC,EAA3C,EAA8CC,EAA9C,CAAZ;IAAA,OADJ,EAEI;IAAA,eAAI,KAAI,CAACzB,cAAL,CAAoBlF,aAApB,EAAJ;IAAA,OAFJ,EAGIO,MAAM,CAACN,UAHX,EAGuBM,MAAM,CAACwC,UAH9B,EADJ,KAMI0B,eAAe,CAACmC,6BAAhB;IACP,KAVD,MAYA;IACI,UAAInC,eAAe,CAACxE,UAAhB,IAA8BM,MAAM,CAACN,UAAzC,EACA;IACIwE,QAAAA,eAAe,CAACxE,UAAhB,GAA2BM,MAAM,CAACN,UAAlC;;IACA,YAAIwE,eAAe,CAACxE,UAApB,EACA;IAOH;;IACD,UAAIwE,eAAe,CAAC1B,UAAhB,IAA8BxC,MAAM,CAACwC,UAAzC,EACA;IACI0B,QAAAA,eAAe,CAAC1B,UAAhB,GAA2BxC,MAAM,CAACwC,UAAlC;;IACA,YAAI0B,eAAe,CAAC1B,UAApB,EACA;IAOH;IACJ,KAzCc;;IA2ClB;;aAED8D,aAAA,sBAAY;IACR;IACA,SAAKlB,YAAL,CAAkBpK,YAAlB,GAFQ;;IAGR,SAAKqC,WAAL;;IAEA,SAAI,IAAI8B,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAK8E,mBAAL,CAAyB/H,MAAxC,EAAgDiD,CAAC,EAAjD,EACA;IACI,UAAI+E,eAAe,GAAG,KAAKD,mBAAL,CAAyB9E,CAAzB,CAAtB;IACA,UAAI+E,eAAe,CAACmC,6BAApB,EACInC,eAAe,CAACmC,6BAAhB;IACP;;IACD,SAAKf,wBAAL;IACA,SAAKH,eAAL,CAAqBtC,gCAArB,GAZQ;IAcR;;IACA,SAAK0D,cAAL;IACH;;aAEDA,iBAAA,0BAAgB;IAAA;;IACZ,QAAIC,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;IAC5B,UAAIC,OAAO,GAAG,MAAI,CAAC9B,cAAL,CAAoB+B,UAApB,EAAd;;IAEA,WAAI,IAAIvH,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAACsH,OAAO,CAACvK,MAAzB,EAAiCiD,CAAC,EAAlC,EAAsC;IAClC,YAAIa,MAAM,GAAGyG,OAAO,CAACtH,CAAD,CAApB;IAEA,YAAIqD,UAAU,GAAGxC,MAAM,CAAC2G,QAAxB;IACA,YAAIxC,QAAQ,GAAKnE,MAAM,CAAC4G,MAAxB;IACA,YAAIlH,UAAU,GAAGM,MAAM,CAACmC,QAAxB;IAEA,YAAI7C,eAAe,GAAG;IAClBkF,UAAAA,UAAU,EAAExE,MAAM,CAACqE,IAAP,CAAY2B,WAAZ,GAA0BC,IAA1B,EADM;IAElBzF,UAAAA,kBAAkB,EAAEd,UAAU,IAAI8C,UAAd,IAA4B2B,QAF9B;IAGlBnE,UAAAA,MAAM,EAAEA,MAHU;IAIlBmE,UAAAA,QAAQ,EAAEA,QAJQ;IAKlB1F,UAAAA,uBAAuB,EAAE,IALP;IAMlBvB,UAAAA,mBAAmB,EAAE,IANH;IAOlB2E,UAAAA,YAAY,EAAE,IAPI;IAQlBC,UAAAA,YAAY,EAAE,IARI;IASlB1C,UAAAA,OAAO,EAAE,KATS;IAUlBN,UAAAA,MAAM,EAAE,IAVU;IAWlBmD,UAAAA,mBAAmB,EAAE,IAXH;IAYlB4E,UAAAA,MAAM,EAAE,IAZU;IAalBxG,UAAAA,OAAO,EAAE,IAbS;IAclBgG,UAAAA,6BAA6B,EAAE;IAdb,SAAtB;;IAiBA,QAAA,MAAI,CAACpC,mBAAL,CAAyBQ,IAAzB,CAA8BnF,eAA9B;;IACA,YAAI,CAAC6E,QAAL,EAAc;IACV7E,UAAAA,eAAe,CAACF,OAAhB,GAA0B,IAA1B;IACAE,UAAAA,eAAe,CAACT,YAAhB,GAA6BM,CAA7B;;IACA,UAAA,MAAI,CAACiG,YAAL,CAAkB7F,kBAAlB,CAAqCD,eAArC,EACI,UAAC4G,EAAD,EAAIC,EAAJ,EAAOC,EAAP;IAAA,mBAAY,MAAI,CAACjB,eAAL,CAAqB5E,kBAArB,CAAwC2F,EAAxC,EAA2CC,EAA3C,EAA8CC,EAA9C,CAAZ;IAAA,WADJ,EAEI;IAAA,mBAAI,MAAI,CAACzB,cAAL,CAAoBlF,aAApB,EAAJ;IAAA,WAFJ,EAE6CC,UAF7C,EAEyD8C,UAFzD;IAGH;IACJ;;IACD,MAAA,MAAI,CAACsE,MAAL,CAAYpD,8BAAZ,CAA2C,KAA3C;IACH,KArCD,CADY;;;IAyCZ,QAAIhJ,QAAQ,CAACqM,UAAT,IAAuB,SAA3B,EAAqC;IACjCP,MAAAA,mBAAmB;IACtB,KAFD,MAEO;IACH,UAAIQ,0BAA0B,GAAG,SAA7BA,0BAA6B,GAAU;IACvCR,QAAAA,mBAAmB;IACnB9L,QAAAA,QAAQ,CAACmC,mBAAT,CAA6B,kBAA7B,EAAiDmK,0BAAjD;IACH,OAHD;;IAIAtM,MAAAA,QAAQ,CAAC2B,gBAAT,CAA0B,kBAA1B,EAA8C2K,0BAA9C,EALG;IAMN;IACJ;;aAEDC,UAAA,mBAAS;IACL,QAAI,KAAKlC,SAAT,EACI,KAAKA,SAAL,GAFC;IAIL;IACA;;IACA,SAAKK,YAAL,CAAkBpK,YAAlB;IAEA,SAAKmK,eAAL,CAAqBvI,OAArB;IACA,SAAKN,WAAL,CAAiBM,OAAjB;IAEA,SAAKgI,YAAL,CAAkBhI,OAAlB;IAEA,SAAKkK,MAAL,CAAYlK,OAAZ;;IAEA,QAAI,KAAK+H,cAAL,CAAoB/H,OAAxB,EAAiC;IAC7B,WAAK+H,cAAL,CAAoB/H,OAApB;IACH;;IAED,SAAI,IAAIuC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAK8E,mBAAL,CAAyB/H,MAAxC,EAAgDiD,CAAC,EAAjD,EACA;IACI,UAAI+E,eAAe,GAAG,KAAKD,mBAAL,CAAyB9E,CAAzB,CAAtB;IACA,UAAI+E,eAAe,CAAChE,8BAApB,EACIgE,eAAe,CAAChE,8BAAhB;IAEJ,UAAIgE,eAAe,CAAC7B,mBAApB,EACI6B,eAAe,CAAC7B,mBAAhB,CAAoCzF,OAApC;IACJ,UAAIsH,eAAe,CAACjE,mBAApB,EACIiE,eAAe,CAACjE,mBAAhB,CAAoCrD,OAApC;IACP;IACJ;;aAEDiJ,aAAA,sBAAY;IACR,QAAI,KAAK1I,OAAL,CAAa0I,UAAjB,EACI,KAAK1I,OAAL,CAAa0I,UAAb,CAAwB,KAAKR,gBAA7B;IACP;;aAEDS,iBAAA,0BAAgB;IACZ,QAAIzE,mBAAmB,GAAG,KAAKsD,cAAL,CAAoBuC,WAApB,EAA1B;;IACA,QAAI,KAAK7F,mBAAL,KAA2BA,mBAA/B,EAAmD;IAC/C,UAAIA,mBAAJ,EAAyB;IACrB,aAAK8D,eAAL,CAAqB9E,OAArB;IACA,aAAKlD,OAAL,CAAagK,OAAb,CAAqB,KAAK9B,gBAA1B;IACH,OAHD,MAGO;IACH,aAAKF,eAAL,CAAqBrC,MAArB;IACA,aAAK3F,OAAL,CAAaiK,MAAb,CAAoB,KAAK/B,gBAAzB;IACH;;IACD,WAAKhE,mBAAL,GAAyBA,mBAAzB;IACH;IACJ;;aAEDjG,QAAA,eAAMa,gBAAN,EAAwBoL,WAAxB,EAAoC;IAChC,QAAIhD,IAAI,GAAGpI,gBAAgB,CAACgK,IAAjB,GAAwBD,WAAxB,EAAX;IACA,QAAIzJ,OAAO,GAAC,KAAZ;IACA,QAAI8H,IAAI,IAAI,EAAZ,EACI9H,OAAO,GAAC,IAAR,CADJ,KAGA;IACI;IACA,WAAKgJ,2BAAL,GAAmCnB,yBAAyB,CAAC,KAAKH,mBAAN,EAA2BI,IAA3B,CAA5D;;IACA,UAAI,KAAKkB,2BAAL,CAAiCrJ,MAAjC,IAA2C,CAA/C,EACA;IACI,YAAIoL,wBAAwB,GAAI,KAAK/B,2BAAL,CAAiC,CAAjC,CAAhC;;IACA,YAAI+B,wBAAwB,CAAC9C,UAAzB,IAAuCH,IAA3C,EACA;IACIiD,UAAAA,wBAAwB,CAACxI,MAAzB;IACA,eAAKxC,WAAL,CAAiBF,QAAjB,GAFJ;;IAGIG,UAAAA,OAAO,GAAC,IAAR;IACH;IACJ;IACJ;IACD,QAAIA,OAAJ,EACI,KAAKiJ,iBAAL,GADJ,KAGI6B,WAAW;IAEf,SAAKjC,YAAL,CAAkBlH,iBAAlB;IAEA,SAAKkH,YAAL,CAAkB1G,sBAAlB;;IAEA,QAAI,KAAKtB,6BAAL,GAAqClB,MAArC,IAA+C,CAAnD,EAAsD;IAClD,WAAKkJ,YAAL,CAAkB9G,eAAlB,CAAkC,CAAlC;IACH;;IAED,QAAI,KAAKlB,6BAAL,GAAqClB,MAArC,GAA8C,CAAlD,EAAqD;IACjD,WAAK4K,MAAL,CAAYpD,8BAAZ,CAA2C,IAA3C,EADiD;;IAEjD,WAAK0B,YAAL,CAAkB/G,YAAlB;IACH,KAHD,MAGO;IACH,WAAK+G,YAAL,CAAkBpK,YAAlB;IACH;IACJ;;aAEDmG,OAAA,gBAAO;IAAA;;IACH,QAAIzG,QAAQ,GAAG,KAAKA,QAApB;IACA,QAAIuC,SAAS,GAAG,KAAK0H,cAAL,CAAoB1H,SAApC;IAEA,QAAIsK,+BAA+B,GAAC,IAApC;IAEA,SAAKjL,WAAL,GAAmB7B,WAAW,CAC1BC,QAD0B,EAE1B,UAAC8M,sBAAD,EAA4B;IACxBD,MAAAA,+BAA+B,GAAG,yCAACE,iBAAD,EAAqB;IACnDA,QAAAA,iBAAiB,CAAC3H,WAAlB,CAA8B0H,sBAA9B;;IACA,QAAA,MAAI,CAAC5C,YAAL,CAAkBzD,IAAlB,CAAuBqG,sBAAvB;IACH,OAHD;IAIH,KAPyB,EAQ1B;IAAA,aAAM,MAAI,CAACrK,OAAL,CAAauK,OAAb,CAAqB,MAAI,CAACrC,gBAA1B,CAAN;IAAA,KAR0B;IAS1B,gBAAM;IACF,UAAI,CAAC,MAAI,CAACD,YAAL,CAAkB1E,eAAlB,EAAL;IACA;IACI,UAAA,MAAI,CAACrD,WAAL,GADJ;;;IAEI,UAAA,MAAI,CAAC+H,YAAL,CAAkB1G,sBAAlB,GAFJ;;;IAGI,UAAA,MAAI,CAACvB,OAAL,CAAawK,QAAb,CAAsB,MAAI,CAACtC,gBAA3B;;IACA,UAAA,MAAI,CAACD,YAAL,CAAkBzE,iBAAlB;IACH;IACJ,KAjByB;IAkB1B;IAAA,aAAM,MAAI,CAACyE,YAAL,CAAkBrG,YAAlB,CAA+B,KAA/B,CAAN;IAAA,KAlB0B;IAmB1B;IAAA,aAAM,MAAI,CAACqG,YAAL,CAAkBrG,YAAlB,CAA+B,IAA/B,CAAN;IAAA,KAnB0B;IAoB1B;IAAA,aAAM,MAAI,CAACqG,YAAL,CAAkBpK,YAAlB,EAAN;IAAA,KApB0B;IAqB1B,gBAAM;IACF,MAAA,MAAI,CAACmK,eAAL,CAAqBlK,kBAArB;;IACA,MAAA,MAAI,CAAC6L,MAAL,CAAYpD,8BAAZ,CAA2C,KAA3C;IACH,KAxByB;IAyB1B;IAAA,aAAM,MAAI,CAAC0B,YAAL,CAAkBlK,aAAlB,EAAN;IAAA,KAzB0B;IA0B1B,gBAAM;IACF,MAAA,MAAI,CAACkK,YAAL,CAAkBpK,YAAlB,GADE;;;IAEF,MAAA,MAAI,CAACqC,WAAL;IACH,KA7ByB;IA8B1B,cAACpB,gBAAD,EAAmBoL,WAAnB;IAAA,aAAmC,MAAI,CAACjM,KAAL,CAAWa,gBAAX,EAA6BoL,WAA7B,CAAnC;IAAA,KA9B0B;IAAA,KAA9B;IAiCA,SAAKlC,eAAL,GAAwBjE,eAAe,CACnCxG,QADmC,EAEnC,UAAC+M,iBAAD,EAAuB;IACnBF,MAAAA,+BAA+B,CAACE,iBAAD,CAA/B;IACH,KAJkC,EAKnC,KAAKrG,mBAL8B,EAMnC,KAAKC,mBAN8B,EAOnC;IAAA,aAAM,MAAI,CAACsD,cAAL,CAAoBlF,aAApB,EAAN;IAAA,KAPmC,EAQnC,YAAM;IACF,MAAA,MAAI,CAAC2F,YAAL,CAAkBpK,YAAlB,GADE;;;IAEF,MAAA,MAAI,CAACqC,WAAL;IACH,KAXkC,EAYnC,UAAC3B,KAAD,EAAW;IACL,UAAI,CAAC,MAAI,CAACY,WAAL,CAAiBI,aAAjB,CAA+BhB,KAA/B,CAAL,EACG,MAAI,CAACY,WAAL,CAAiBE,QAAjB;IACJ,KAf8B,EAgBnC,YAAM;IACE,UAAI,MAAI,CAACY,6BAAL,GAAqClB,MAArC,GAA8C,CAAlD,EACA;IACI,QAAA,MAAI,CAAC4K,MAAL,CAAYpD,8BAAZ,CAA2C,IAA3C;;IACA,QAAA,MAAI,CAAC0B,YAAL,CAAkB/G,YAAlB;IACH;IACJ,KAtB8B,CAAvC;IAyBA,SAAKoD,aAAL,GAAqB,KAAK0D,eAAL,CAAqB1D,aAA1C,CAhEG;;IAiEH,SAAKC,eAAL,GAAuB,KAAKyD,eAAL,CAAqBzD,eAA5C;IAEA,SAAK0D,YAAL,GAAoBpI,YAAY,CAC5BtC,QAD4B,EAE5BuC,SAF4B,EAG5B,KAAKC,mBAHuB,EAI5B,KAAKC,OAJuB,EAK5B;IAAA,aAAM,MAAI,CAACC,6BAAL,EAAN;IAAA,KAL4B,EAM5B;IAAA,aAAM,MAAI,CAACC,WAAL,EAAN;IAAA,KAN4B,EAO5B;IAAA,aAAM,MAAI,CAACyJ,MAAL,CAAYpD,8BAAZ,CAA2C,IAA3C,CAAN;IAAA,KAP4B,EAQ5B;IAAA,aAAM,MAAI,CAACpH,WAAL,CAAiBE,QAAjB,EAAN;IAAA,KAR4B,CAAhC;IAWA,SAAKsK,MAAL,GAAe/D,sBAAsB,CACjCrI,QADiC,EAEjC,KAAKiK,cAAL,CAAoB1H,SAFa,EAGjC,KAAKkI,eAAL,CAAqB1D,aAHY,EAIjC,KAAK0D,eAAL,CAAqBzD,eAJY,EAKjC,KAAK0D,YAAL,CAAkB5H,YALe,EAMjCwF,MANiC,CAArC;IASA,SAAKqC,gBAAL,GAAwB,KAAKR,sBAAL,CAA4B5H,SAA5B,EACpB,KAAKkI,eAAL,CAAqB1D,aADD,EAEpB,KAAK0D,eAAL,CAAqBzD,eAFD,EAGpB,KAAKpF,WAAL,CAAiBlB,KAHG,EAIpB,KAAKgK,YAAL,CAAkB5H,YAJE,CAAxB;IAMA,SAAKL,OAAL,CAAayK,IAAb,CAAkB,KAAKvC,gBAAvB;IAEA,QAAI,KAAKV,cAAL,CAAoBkD,oBAAxB,EACI,KAAKlD,cAAL,CAAoBkD,oBAApB;IAKJ,SAAK1K,OAAL,CAAauI,aAAb,CAA2B,KAAKL,gBAAhC,EAAkD,KAAKV,cAAL,CAAoBgB,UAApB,EAAlD,EAAoF,KAAKhB,cAAL,CAAoBiB,YAApB,EAApF;IAEA,SAAKC,UAAL;IACA,SAAKC,cAAL;IAEA,SAAKS,cAAL;IACH;;;;;ICnbL,SAASuB,YAAT,CAAsBC,KAAtB,EAA6BC,aAA7B,EAA2C;IACvC,MAAIC,WAAW,GAAG,IAAlB,CADuC;;IAEvC,SAAO;IACH9G,IAAAA,IADG,gBACE9F,WADF,EACe;IACd,UAAI0M,KAAJ,EAAW;IACPE,QAAAA,WAAW,GAAGF,KAAK,CAACG,YAAN,CAAmB,KAAnB,CAAd;IACA,YAAIC,KAAK,GAAGH,aAAa,EAAzB;IACA3M,QAAAA,WAAW,CAACE,YAAZ,CAAyB,IAAzB,EAA+B4M,KAA/B;IACAJ,QAAAA,KAAK,CAACxM,YAAN,CAAmB,KAAnB,EAAyB4M,KAAzB;IACH;IACJ,KARE;IASHvL,IAAAA,OATG,qBASM;IACL,UAAGqL,WAAH,EACIF,KAAK,CAACxM,YAAN,CAAmB,KAAnB,EAAyB0M,WAAzB;IACP;IAZE,GAAP;IAcH;;IChBD,SAASG,kBAAT,CAA4BnL,SAA5B,EAAuCwJ,OAAvC,EAAgDS,YAAhD,EAA6DvB,WAA7D,EAAyEC,aAAzE,EAAuFyC,OAAvF,EAAgG;IAC5F,SAAO;IACHpL,IAAAA,SAAS,EAATA,SADG;IAEHyJ,IAAAA,UAFG,wBAES;IAAC,aAAOD,OAAP;IAAe,KAFzB;IAGH7J,IAAAA,OAHG,qBAGM;IACL,aAAOK,SAAS,CAACqL,UAAjB;IAA6BrL,QAAAA,SAAS,CAAC8D,WAAV,CAAsB9D,SAAS,CAACqL,UAAhC;IAA7B;IACH,KALE;IAMH7I,IAAAA,aANG,2BAMY;IACX4I,MAAAA,OAAO,CAAC,oBAAD,CAAP;IACH,KARE;IASHnB,IAAAA,WATG,yBASU;IACT,aAAOA,YAAW,GAACA,YAAW,EAAZ,GAAe,KAAjC;IACH,KAXE;IAYHvB,IAAAA,UAZG,wBAYS;IACR,aAAOA,WAAU,GAACA,WAAU,EAAX,GAAc,KAA/B;IACH,KAdE;IAeHC,IAAAA,YAfG,0BAeW;IACV,aAAOA,aAAY,GAACA,aAAY,EAAb,GAAgB,KAAnC;IACH;IAjBE,GAAP;IAmBH;;IAED,SAAS2C,qBAAT,CAA+BC,aAA/B,EAA8CH,OAA9C,EAAuD;IACnDG,EAAAA,aAAa,CAAChN,KAAd,CAAoBiC,OAApB,GAA4B,MAA5B;IACA,MAAIR,SAAS,GAAGvC,QAAQ,CAACY,aAAT,CAAuB,KAAvB,CAAhB;IACA,SAAO;IACH2B,IAAAA,SAAS,EAATA,SADG;IAEHyJ,IAAAA,UAFG,wBAES;IAAC,aAAO8B,aAAa,CAACC,oBAAd,CAAmC,QAAnC,CAAP;IAAoD,KAF9D;IAGH7L,IAAAA,OAHG,qBAGM;IACLK,MAAAA,SAAS,CAAC6D,UAAV,CAAqBC,WAArB,CAAiC9D,SAAjC;IACH,KALE;IAMH4K,IAAAA,oBANG,kCAMmB;IAClBW,MAAAA,aAAa,CAAC1H,UAAd,CAAyB2B,YAAzB,CAAsCxF,SAAtC,EAAiDuL,aAAa,CAACE,WAA/D;IACH,KARE;IASHjJ,IAAAA,aATG,2BASY;IACX4I,MAAAA,OAAO,CAAC,QAAD,CAAP;IACAA,MAAAA,OAAO,CAAC,oBAAD,CAAP;IACH,KAZE;IAaHnB,IAAAA,WAbG,yBAaU;IACT,aAAOsB,aAAa,CAAC7B,QAArB;IACH,KAfE;IAgBHhB,IAAAA,UAhBG,wBAgBS;IACR,aAAO6C,aAAa,CAACG,SAAd,CAAwB1K,QAAxB,CAAiC,UAAjC,CAAP;IACH,KAlBE;IAmBH2H,IAAAA,YAnBG,0BAmBW;IACV,aAAO4C,aAAa,CAACG,SAAd,CAAwB1K,QAAxB,CAAiC,YAAjC,CAAP;IACH;IArBE,GAAP;IAuBH;;IChDM,SAAS2K,iBAAT,CAA2BC,WAA3B,EAAwCC,MAAxC,EAAgD;IACnD,OAAK,IAAIC,QAAT,IAAqBD,MAArB;IACI,QAAID,WAAW,CAACE,QAAD,CAAX,KAA0BC,SAA9B,EACIH,WAAW,CAACE,QAAD,CAAX,GAAwBD,MAAM,CAACC,QAAD,CAA9B;IAFR;IAGH;;ICFD,IAAME,2BAA2B,GAAG;IAChCC,EAAAA,uBAAuB,EAAG,OADM;IAEhCC,EAAAA,0BAA0B,EAAE,UAFI;IAGhCC,EAAAA,yBAAyB,EAAE;IAHK,CAApC;;IAMA,SAASC,mBAAT,CAA6BvE,aAA7B,EAA2C;IACvC8D,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgBmE,2BAAhB,CAAjB;IAEA,SAAO;IACH7B,IAAAA,MADG,kBACIkC,cADJ,EACmB;IAClBA,MAAAA,cAAc,CAACC,WAAf,CAA2BzE,aAAa,CAACqE,0BAAzC;IACH,KAHE;IAKHhC,IAAAA,OALG,mBAKKmC,cALL,EAKoB;IACnBA,MAAAA,cAAc,CAACE,QAAf,CAAwB1E,aAAa,CAACqE,0BAAtC;IACH,KAPE;IASHzB,IAAAA,OATG,mBASK4B,cATL,EASoB;IACnBA,MAAAA,cAAc,CAACE,QAAf,CAAwB1E,aAAa,CAACoE,uBAAtC;IACH,KAXE;IAaHvB,IAAAA,QAbG,oBAaM2B,cAbN,EAaqB;IACpBA,MAAAA,cAAc,CAACC,WAAf,CAA2BzE,aAAa,CAACoE,uBAAzC;IACH;IAfE,GAAP;IAiBH;;IC1BD,IAAMO,qBAAqB,GAAG;IAAC,mBAAiB,GAAlB;IAAuB,YAAU;IAAjC,CAA9B;IAEA,IAAMC,0BAA0B,GAAG;IAC/BC,EAAAA,yBAAyB,EAAE,qBADI;IAE/BC,EAAAA,wBAAwB,EAAG,sBAFI;IAG/BC,EAAAA,wBAAwB,EAAG,uBAHI;IAI/BC,EAAAA,oCAAoC,EAAE,SAJP;IAK/BC,EAAAA,6BAA6B,EAAE,SALA;IAM/BC,EAAAA,2BAA2B,EAAE,sCANE;IAO/BC,EAAAA,gCAAgC,EAAE,sCAPH;IAQ/BC,EAAAA,kCAAkC,EAAE,sCARL;IAS/BC,EAAAA,gBAAgB,EAAE,SATa;;IAAA,CAAnC;;IAaA,SAASC,kBAAT,CAA4BtF,aAA5B,EAA0C;IACtC8D,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgB4E,0BAAhB,CAAjB;IAEA,SAAO;IACHW,IAAAA,MADG,kBACIC,SADJ,EACc;IACbA,MAAAA,SAAS,CAAChB,cAAV,CAAyBiB,GAAzB,CAA6Bd,qBAA7B;IACAa,MAAAA,SAAS,CAACE,YAAV,CAAuBD,GAAvB,CAA2B,OAA3B,EAAoCzF,aAAa,CAACqF,gBAAlD;IACH,KAJE;IAMHtE,IAAAA,UANG,sBAMQyD,cANR,EAMuB;IACtB,UAAIA,cAAc,CAACmB,QAAf,CAAwB,iBAAxB,CAAJ,EAA+C;IAC3CnB,QAAAA,cAAc,CAACiB,GAAf,CAAmB,YAAnB,EAAiCzF,aAAa,CAAC8E,wBAA/C;IACH,OAFD,MAEO,IAAIN,cAAc,CAACmB,QAAf,CAAwB,iBAAxB,CAAJ,EAA+C;IAClDnB,QAAAA,cAAc,CAACiB,GAAf,CAAmB,YAAnB,EAAiCzF,aAAa,CAAC+E,wBAA/C;IACH,OAFM,MAEA;IACHP,QAAAA,cAAc,CAACiB,GAAf,CAAmB,YAAnB,EAAiCzF,aAAa,CAAC6E,yBAA/C;IACH;IACJ,KAdE;IAgBHvC,IAAAA,MAhBG,kBAgBIkC,cAhBJ,EAgBmB;IAClBA,MAAAA,cAAc,CAACiB,GAAf,CAAmB,kBAAnB,EAAuC,EAAvC;IACH,KAlBE;IAoBHpD,IAAAA,OApBG,mBAoBKmC,cApBL,EAoBoB;IACnBA,MAAAA,cAAc,CAACiB,GAAf,CAAmB,kBAAnB,EAAuCzF,aAAa,CAACgF,oCAArD;IACH,KAtBE;IAwBHpC,IAAAA,OAxBG,mBAwBK4B,cAxBL,EAwBoB;IACnB,UAAIA,cAAc,CAACmB,QAAf,CAAwB,UAAxB,CAAJ,EAAwC;IACpCnB,QAAAA,cAAc,CAACiB,GAAf,CAAmB,YAAnB,EAAiCzF,aAAa,CAACmF,gCAA/C;IACH,OAFD,MAEO,IAAIX,cAAc,CAACmB,QAAf,CAAwB,YAAxB,CAAJ,EAA0C;IAC7CnB,QAAAA,cAAc,CAACiB,GAAf,CAAmB,YAAnB,EAAiCzF,aAAa,CAACoF,kCAA/C;IACH,OAFM,MAEA;IACHZ,QAAAA,cAAc,CACTiB,GADL,CACS,YADT,EACuBzF,aAAa,CAACkF,2BADrC,EAEKO,GAFL,CAES,cAFT,EAEyBzF,aAAa,CAACiF,6BAFvC;IAGH;IACJ,KAlCE;IAoCHpC,IAAAA,QApCG,oBAoCM2B,cApCN,EAoCqB;IAChBA,MAAAA,cAAc,CAACiB,GAAf,CAAmB,YAAnB,EAAiC,EAAjC,EAAsCA,GAAtC,CAA0C,cAA1C,EAA0D,EAA1D;IACP;IAtCE,GAAP;IAwCH;;ICzDD,IAAMG,kBAAkB,GAAG;IACvBC,EAAAA,cAAc,EAAE,6BADO;IAEvBC,EAAAA,iBAAiB,EAAE,eAFI;IAGvBC,EAAAA,iBAAiB,EAAG,MAHG;IAIvBC,EAAAA,sBAAsB,EAAE,uBAJD;IAKvBC,EAAAA,kBAAkB,EAAE,cALG;IAMvBC,EAAAA,iBAAiB,EAAE,OANI;IAOvBC,EAAAA,6BAA6B,EAAE,OAPR;IAQvBC,EAAAA,oBAAoB,EAAE,EARC;IASvBC,EAAAA,gBAAgB,EAAE;IATK,CAA3B;;IAYA,SAASC,UAAT,CAAoBC,aAApB,EAAmCvG,aAAnC,EAAkDwG,CAAlD,EAAqD;IACjD1C,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgB4F,kBAAhB,CAAjB;IAEA,SAAO;IACH9C,IAAAA,IADG,gBACE0C,SADF,EACY;IACXA,MAAAA,SAAS,CAACiB,UAAV,CAAqB/B,QAArB,CAA8B1E,aAAa,CAAC6F,cAA5C;IACAL,MAAAA,SAAS,CAAChB,cAAV,CAAyBE,QAAzB,CAAkC1E,aAAa,CAACiG,kBAAhD;IACAT,MAAAA,SAAS,CAACkB,aAAV,CAAwBhC,QAAxB,CAAiC1E,aAAa,CAAC8F,iBAA/C;IACAN,MAAAA,SAAS,CAACmB,gBAAV,CAA2BjC,QAA3B,CAAoC1E,aAAa,CAACoG,oBAAlD;IACAZ,MAAAA,SAAS,CAACE,YAAV,CAAuBhB,QAAvB,CAAgC1E,aAAa,CAACqG,gBAA9C;IACA,UAAIE,aAAa,CAAChB,MAAlB,EACIgB,aAAa,CAAChB,MAAd,CAAqBC,SAArB;IACP,KATE;IAWH5E,IAAAA,aAXG,yBAWW4E,SAXX,EAWsBoB,OAXtB,EAW+BC,SAX/B,EAWyC;IACxC,UAAID,OAAJ,EACIpB,SAAS,CAAChB,cAAV,CAAyBE,QAAzB,CAAkC,UAAlC;IAEJ,UAAImC,SAAJ,EACIrB,SAAS,CAAChB,cAAV,CAAyBE,QAAzB,CAAkC,YAAlC;IACP,KAjBE;IAmBH3D,IAAAA,UAnBG,sBAmBQyE,SAnBR,EAmBkB;IACjB,UAAGe,aAAa,CAACxF,UAAjB,EACGwF,aAAa,CAACxF,UAAd,CAAyByE,SAAS,CAAChB,cAAnC;IACN,KAtBE;IAwBHlC,IAAAA,MAxBG,kBAwBIkD,SAxBJ,EAwBc;IACbe,MAAAA,aAAa,CAACjE,MAAd,CAAqBkD,SAAS,CAAChB,cAA/B;IACH,KA1BE;IA4BHnC,IAAAA,OA5BG,mBA4BKmD,SA5BL,EA4Be;IACde,MAAAA,aAAa,CAAClE,OAAd,CAAsBmD,SAAS,CAAChB,cAAhC;IACH,KA9BE;IAgCH5B,IAAAA,OAhCG,mBAgCK4C,SAhCL,EAgCe;IACde,MAAAA,aAAa,CAAC3D,OAAd,CAAsB4C,SAAS,CAAChB,cAAhC;IACH,KAlCE;IAoCH3B,IAAAA,QApCG,oBAoCM2C,SApCN,EAoCgB;IACfe,MAAAA,aAAa,CAAC1D,QAAd,CAAuB2C,SAAS,CAAChB,cAAjC;IACH,KAtCE;IAwCH9K,IAAAA,OAxCG,mBAwCKoN,YAxCL,EAwCkB;IACjBN,MAAAA,CAAC,CAACM,YAAD,CAAD,CAAgBpC,QAAhB,CAAyB1E,aAAa,CAACgG,sBAAvC;IACH,KA1CE;IA4CHnM,IAAAA,QA5CG,oBA4CMiN,YA5CN,EA4CmB;IAClBN,MAAAA,CAAC,CAACM,YAAD,CAAD,CAAgBrC,WAAhB,CAA4BzE,aAAa,CAACgG,sBAA1C;IACH;IA9CE,GAAP;IAiDH;;ICnED,SAASe,oBAAT,CAA8BC,UAA9B,EAA0CC,YAA1C,EAAwDT,CAAxD,EAA0D;IACtD,MAAMU,SAAS,GAAGF,UAAU,CAACG,MAAX,CAAkB,CAAlB,CAAlB;IACA,MAAMC,cAAc,GAAGF,SAAS,CAAChG,WAAV,EAAvB;;IACA,MAAIkG,cAAc,IAAIF,SAAtB,EAAiC;IAC7B,UAAM,IAAI/G,SAAJ,mBAA8B6G,UAA9B,8CAAN;IACH;;IACD,MAAMK,gBAAgB,GAAGD,cAAc,GAAGJ,UAAU,CAACM,KAAX,CAAiB,CAAjB,CAA1C;IACA,MAAMC,sBAAsB,GAAGf,CAAC,CAACgB,EAAF,CAAKH,gBAAL,CAA/B;IACA,MAAMI,OAAO,sBAAoBT,UAAjC;;IAEA,WAASU,YAAT,CAAsB/F,OAAtB,EAA+B;IAC3B,WAAO,KAAKgG,IAAL,CAAW,YAAY;IAC1B,UAAIC,EAAE,GAAGpB,CAAC,CAAC,IAAD,CAAV;IACA,UAAIqB,QAAQ,GAAGD,EAAE,CAACE,IAAH,CAAQL,OAAR,CAAf;IACA,UAAIM,YAAY,GAAG,OAAOpG,OAAP,KAAmB,QAAtC;;IACA,UAAI,CAACkG,QAAL,EAAe;IACX,YAAIE,YAAY,IAAI,UAAUC,IAAV,CAAerG,OAAf,CAApB,EAA6C;IACzC;IACH;;IACD,YAAMsG,aAAa,GAAI,OAAOtG,OAAP,KAAmB,QAApB,GAA8BA,OAA9B,GAAsC,IAA5D;IAEAkG,QAAAA,QAAQ,GAAGZ,YAAY,CAAC,IAAD,EAAOgB,aAAP,EACnB,YAAM;IACFL,UAAAA,EAAE,CAACM,UAAH,CAAcT,OAAd;IACH,SAHkB,CAAvB;IAIAG,QAAAA,EAAE,CAACE,IAAH,CAAQL,OAAR,EAAiBI,QAAjB;IACH;;IAED,UAAIE,YAAJ,EAAkB;IACd,YAAII,UAAU,GAAGxG,OAAjB;;IACA,YAAI,OAAOkG,QAAQ,CAACM,UAAD,CAAf,KAAgC,WAApC,EAAiD;IAC7C,gBAAM,IAAIhI,SAAJ,uBAAkCgI,UAAlC,OAAN;IACH;;IACDN,QAAAA,QAAQ,CAACM,UAAD,CAAR;IACH;IACJ,KAxBM,CAAP;IAyBH;;IAED3B,EAAAA,CAAC,CAACgB,EAAF,CAAKH,gBAAL,IAAyBK,YAAzB,CAtCsD;;IAyCtDlB,EAAAA,CAAC,CAACgB,EAAF,CAAKR,UAAL,IAAmB,YAAY;IAC3B,WAAOR,CAAC,CAAC,IAAD,CAAD,CAAQsB,IAAR,CAAaL,OAAb,CAAP;IACH,GAFD;;IAIAjB,EAAAA,CAAC,CAACgB,EAAF,CAAKH,gBAAL,EAAuBe,UAAvB,GAAoC,YAAY;IAC5C5B,IAAAA,CAAC,CAACgB,EAAF,CAAKH,gBAAL,IAAyBE,sBAAzB;IACA,WAAOG,YAAP;IACH,GAHD;IAIH;;IC/CD,IAAMW,2BAA2B,GAAG;IAChCC,EAAAA,gCAAgC,EAAE;IADF,CAApC;;IAIA,SAASC,sCAAT,CAAgDvI,aAAhD,EAA+D;IAC3D8D,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgBqI,2BAAhB,CAAjB;IAEA,SAAO;IACHG,IAAAA,0BADG,sCACwBC,QADxB,EACiC;IAChCA,MAAAA,QAAQ,CAAC/D,QAAT,CAAkB1E,aAAa,CAACsI,gCAAhC;IACH;IAHE,GAAP;IAKH;;IAED,IAAMI,oBAAoB,GAAG;IAAC,kBAAgB,KAAjB;IAAwB,iBAAe;IAAvC,CAA7B;IACA,IAAMC,gCAAgC,GAAG;IAAC,eAAY,OAAb;IAAsB,iBAAe;IAArC,CAAzC;IACA,IAAM/D,4BAA0B,GAAG;IAC/BgE,EAAAA,kCAAkC,EAAE;IADL,CAAnC;;IAIA,SAASC,qCAAT,CAA+C7I,aAA/C,EAA8D;IAC1D8D,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgB4E,4BAAhB,CAAjB;IACA,SAAO;IACH4D,IAAAA,0BADG,sCACwBC,QADxB,EACiC;IAChCA,MAAAA,QAAQ,CAAChD,GAAT,CAAa,SAAb,EAAwBzF,aAAa,CAAC4I,kCAAtC;IACH,KAHE;IAKHE,IAAAA,yBALG,qCAKuBC,aALvB,EAKsCC,OALtC,EAK8C;IAC7CD,MAAAA,aAAa,CAACtD,GAAd,CAAkBiD,oBAAlB;IACA,UAAIM,OAAJ,EACIA,OAAO,CAACvD,GAAR,CAAYkD,gCAAZ;IACP;IATE,GAAP;IAWH;;IAED,IAAMM,8BAA8B,GAAG;IACnC/C,EAAAA,iBAAiB,EAAE,OADgB;IAEnCC,EAAAA,6BAA6B,EAAE;IAFI,CAAvC;;IAIA,SAAS+C,sBAAT,CAAgC3C,aAAhC,EAA+CvG,aAA/C,EAA8DwG,CAA9D,EAAiE;IACzD1C,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgBiJ,8BAAhB,CAAjB;IAEA,SAAO,UAAUE,YAAV,EAAwBC,UAAxB,EAAoChM,kBAApC,EAAwDiM,yBAAxD,EAAkF;IACjF,QAAIN,aAAa,GAAGvC,CAAC,CAAC2C,YAAD,CAArB;IACAJ,IAAAA,aAAa,CAACrE,QAAd,CAAuB1E,aAAa,CAACkG,iBAArC;IACA,QAAIuC,QAAQ,GAAGjC,CAAC,WAAD,CAAajH,IAAb,CAAkB6J,UAAU,CAAC7J,IAA7B,CAAf;IACAkJ,IAAAA,QAAQ,CAACa,QAAT,CAAkBP,aAAlB;IACA,QAAIK,UAAU,CAACvH,QAAf,EACI0E,aAAa,CAACiC,0BAAd,CAAyCC,QAAzC;IACJ,QAAIO,OAAO,GAAGxC,CAAC,CAAC,yGAAD,CAAD;IAEV;IAFU,KAGTf,GAHS,CAGL,OAHK,EAGI,MAHJ,EAGY6D,QAHZ,CAGqBP,aAHrB,EAITrE,QAJS,CAIA1E,aAAa,CAACmG,6BAJd;IAAA,KAKToD,EALS,CAKN,OALM,EAKG,UAACC,OAAD,EACT;IACIpM,MAAAA,kBAAkB;IAClBiM,MAAAA,yBAAyB,CAACG,OAAO,CAACC,aAAT,CAAzB;IACH,KATK,CAAd;IAWA,QAAIlD,aAAa,CAACuC,yBAAlB,EACIvC,aAAa,CAACuC,yBAAd,CAAwCC,aAAxC,EAAuDC,OAAvD;IACJ,WAAO;IACHzN,MAAAA,OADG,mBACKmC,UADL,EACgB;IACfsL,QAAAA,OAAO,CAACU,IAAR,CAAa,UAAb,EAAyBhM,UAAzB;IACH,OAHE;IAIH5F,MAAAA,OAJG,qBAIM;IACLkR,QAAAA,OAAO,CAACW,MAAR;IACH;IANE,KAAP;IAQH,GA5BL;IA6BP;;ICvED,IAAMxF,6BAA2B,GAAG;IAChCmE,EAAAA,gCAAgC,EAAE;IADF,CAApC;;IAIA,SAASsB,sCAAT,CAAgD5J,aAAhD,EAA+D;IAC3D8D,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgBmE,6BAAhB,CAAjB;IACA,SAAO;IACH7I,IAAAA,aADG,yBACWuO,SADX,EACsBC,cADtB,EACsCC,UADtC,EACiD;IAChD,UAAIA,UAAJ,EACIF,SAAS,CAACnF,QAAV,CAAmB1E,aAAa,CAACsE,yBAAjC,EADJ,KAGIuF,SAAS,CAACpF,WAAV,CAAsBzE,aAAa,CAACsE,yBAApC;IACP;IANE,GAAP;IAQH;;IAED,IAAMM,4BAA0B,GAAG;IAC/BgE,EAAAA,kCAAkC,EAAE,KADL;IAE/BoB,EAAAA,2BAA2B,EAAE;IAFE,CAAnC;;IAKA,SAASC,qCAAT,CAA+CjK,aAA/C,EAA8D;IAC1D8D,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgB4E,4BAAhB,CAAjB;IACA,SAAM;IACFtJ,IAAAA,aADE,yBACYuO,SADZ,EACuBC,cADvB,EACuCC,UADvC,EACkD;IAChDD,MAAAA,cAAc,CAACrE,GAAf,CAAmB,OAAnB,EAA4BsE,UAAU,GAAC/J,aAAa,CAACgK,2BAAf,GAA2C,EAAjF;IACH;IAHC,GAAN;IAKH;;IAED,IAAME,8BAA8B,GAAG;IACnCnE,EAAAA,iBAAiB,EAAG;IADe,CAAvC;;IAIA,SAASoE,sBAAT,CAAgC5D,aAAhC,EAA+CvG,aAA/C,EAA8DwG,CAA9D,EAAiE;IAC7D1C,EAAAA,iBAAiB,CAAC9D,aAAD,EAAgBkK,8BAAhB,CAAjB;IACA,SAAO,UAASpD,YAAT,EAAuB5L,MAAvB,EAA8B;IACjC,QAAIkP,aAAa,GAAG5D,CAAC,CAACM,YAAD,CAArB;IACAsD,IAAAA,aAAa,CAAC1F,QAAd,CAAuB1E,aAAa,CAAC+F,iBAArC;IACA,QAAIsE,oBAAoB,GAAE7D,CAAC,oMAA3B;IAIA6D,IAAAA,oBAAoB,CAACf,QAArB,CAA8BxC,YAA9B;IACA,QAAI+C,SAAS,GAAGQ,oBAAoB,CAACC,IAArB,4BAAhB;IACA,QAAIR,cAAc,GAAGO,oBAAoB,CAACC,IAArB,SAArB;IACAR,IAAAA,cAAc,CAACvK,IAAf,CAAoBrE,MAAM,CAACqE,IAA3B;IAEA,QAAIgL,GAAG,GAAG;IACNjN,MAAAA,MADM,kBACC1C,UADD,EACY;IAAEiP,QAAAA,SAAS,CAACH,IAAV,CAAe,SAAf,EAA0B9O,UAA1B;IAAwC,OADtD;IAEN;IACAW,MAAAA,OAHM,mBAGEmC,UAHF,EAGa;IAAEmM,QAAAA,SAAS,CAACH,IAAV,CAAe,UAAf,EAA2BhM,UAA3B;IAAyC,OAHxD;IAINpC,MAAAA,aAJM,yBAIQyO,UAJR,EAImB;IAAExD,QAAAA,aAAa,CAACjL,aAAd,CAA4BuO,SAA5B,EAAuCC,cAAvC,EAAuDC,UAAvD;IAAqE,OAJ1F;IAMNvO,MAAAA,UANM,sBAMKxB,MANL,EAMa;IACf6P,QAAAA,SAAS,CAACN,EAAV,CAAa,QAAb,EAAuBvP,MAAvB;IACAoQ,QAAAA,aAAa,CAACb,EAAd,CAAiB,OAAjB,EAA0B,UAAA3S,KAAK,EAAI;IAC/B,cAAIkQ,YAAY,KAAKlQ,KAAK,CAACiB,MAAvB,IAAiC2O,CAAC,CAACrN,QAAF,CAAW2N,YAAX,EAAyBlQ,KAAK,CAACiB,MAA/B,CAArC,EAA6E;IACzEmC,YAAAA,MAAM;IACT;IACJ,SAJD;IAKH,OAbK;IAcNlC,MAAAA,OAdM,qBAcG;IACL+R,QAAAA,SAAS,CAACF,MAAV;IACAS,QAAAA,aAAa,CAACT,MAAd;IACH;IAjBK,KAAV;IAoBA,WAAOY,GAAP;IACH,GAjCD;IAkCH;;IC1DD,CACI,UAACrK,MAAD,EAASsG,CAAT,EAAe;IACXO,EAAAA,oBAAoB,CAAC,eAAD,EAChB,UAACyD,OAAD,EAAUC,QAAV,EAAoBxK,SAApB,EAAkC;IAC9B,QAAID,aAAa,GAAGwG,CAAC,CAACkE,MAAF,CAAS,EAAT,EAAaD,QAAb,CAApB,CAD8B;;IAE9B,QAAIzK,aAAa,CAAC2K,qBAAlB,EACI3K,aAAa,CAAC2K,qBAAd,CAAoCH,OAApC,EAA6CxK,aAA7C;IAEJ,QAAI4K,QAAQ,GAAEpE,CAAC,CAACgE,OAAD,CAAf;IACA,QAAI3K,cAAc,GAAG,IAArB;IACA,QAAIG,aAAa,CAACH,cAAlB,EACIA,cAAc,GAAGG,aAAa,CAACH,cAA/B,CADJ,KAGA;IACI,UAAI0D,OAAO,GAAG,SAAVA,OAAU,CAASsH,SAAT,EAAmB;IAC7BD,QAAAA,QAAQ,CAACrH,OAAT,CAAiBsH,SAAjB;IACH,OAFD;;IAGA,UAAI7K,aAAa,CAAC2B,OAAlB,EAA0B;IACtB9B,QAAAA,cAAc,GAAGyD,kBAAkB,CAC/BkH,OAD+B,EAE/BxK,aAAa,CAAC2B,OAFiB,EAG/B3B,aAAa,CAACoC,WAHiB,EAI/BpC,aAAa,CAACa,UAJiB,EAK/Bb,aAAa,CAACc,YALiB,EAM/ByC,OAN+B,CAAnC;IAOA,YAAI,CAACvD,aAAa,CAACkD,aAAnB,EACIlD,aAAa,CAACkD,aAAd,GAA4B;IAAA,iBAAOlD,aAAa,CAAC6F,cAArB,0BAAwD2E,OAAO,CAACM,EAAhE;IAAA,SAA5B;IAEP,OAXD,MAWM;IACF,YAAI,CAAC9K,aAAa,CAACiD,KAAnB,EACA;IACI,cAAI8H,UAAU,GAAGvE,CAAC,CAACgE,OAAD,CAAD,CAAWQ,OAAX,CAAmB,aAAnB,CAAjB;;IACA,cAAID,UAAU,CAAC3T,MAAX,IAAqB,CAAzB,EAA4B;IACxB,gBAAI6T,MAAM,GAAGF,UAAU,CAACT,IAAX,kBAA8BE,OAAO,CAACM,EAAtC,SAAb;;IACA,gBAAIG,MAAM,CAAC7T,MAAP,GAAc,CAAlB,EACA;IACI,kBAAI6L,KAAK,GAAGgI,MAAM,CAACC,GAAP,CAAW,CAAX,CAAZ;IACA,kBAAIC,KAAK,GAAGlI,KAAK,CAACG,YAAN,CAAmB,KAAnB,CAAZ;;IACA,kBAAI+H,KAAK,IAAIX,OAAO,CAACM,EAArB,EAAyB;IACrB9K,gBAAAA,aAAa,CAACiD,KAAd,GAAsBA,KAAtB;IACH;IACJ;IACJ;IACJ;;IACDpD,QAAAA,cAAc,GAAG4D,qBAAqB,CAAC+G,OAAD,EAAUjH,OAAV,CAAtC;IACA,YAAI,CAACvD,aAAa,CAACkD,aAAnB,EACIlD,aAAa,CAACkD,aAAd,GAA4B;IAAA,iBAAOlD,aAAa,CAAC6F,cAArB,yBAAuD,CAAE2E,OAAO,CAACM,EAAT,GAAaN,OAAO,CAACM,EAArB,GAAwBN,OAAO,CAACY,IAAjC,EAAuClK,WAAvC,EAAvD;IAAA,SAA5B;IACP;IACJ;IAED,QAAIpB,YAAY,GAAGkD,YAAY,CAAChD,aAAa,CAACiD,KAAf,EAAsBjD,aAAa,CAACkD,aAApC,CAA/B;IAEA,QAAImI,MAAM,GAAGrL,aAAa,CAACqL,MAA3B;IACA,QAAIhT,OAAO,GAAG2H,aAAa,CAAC3H,OAA5B;;IACA,QAAI,CAAC2H,aAAa,CAACsL,OAAnB,EACA;IACI,UAAI/E,aAAa,GAAGvG,aAAa,CAACuG,aAAlC;;IACA,UAAI,CAACA,aAAL,EACA;IACI,YAAI8E,MAAJ,EACI9E,aAAa,GAAGhC,mBAAmB,CAACvE,aAAD,CAAnC,CADJ,KAGIuG,aAAa,GAAGjB,kBAAkB,CAACtF,aAAD,CAAlC;IACP;;IACD3H,MAAAA,OAAO,GAAGiO,UAAU,CAACC,aAAD,EAAgBvG,aAAhB,EAA+BwG,CAA/B,CAApB;IACH;;IAED,QAAIlK,mBAAmB,GAAG0D,aAAa,CAAC1D,mBAAxC;;IACA,QAAI,CAACA,mBAAL,EAAyB;IACrB,UAAIiP,gCAAgC,GAAGvL,aAAa,CAACuL,gCAArD;;IACA,UAAI,CAACA,gCAAL,EACA;IACI,YAAIF,MAAJ,EACIE,gCAAgC,GAAChD,sCAAsC,CAACvI,aAAD,AAAA,CAAvE,CADJ,KAGIuL,gCAAgC,GAAC1C,qCAAqC,CAAC7I,aAAD,AAAA,CAAtE;IACP;;IACD1D,MAAAA,mBAAmB,GAAG4M,sBAAsB,CAACqC,gCAAD,EAAmCvL,aAAnC,EAAkDwG,CAAlD,CAA5C;IACH;;IAED,QAAIpO,mBAAmB,GAAG4H,aAAa,CAACwL,sBAAxC;;IACA,QAAI,CAACpT,mBAAL,EAAyB;IACrB,UAAIqT,gCAAgC,GAAGzL,aAAa,CAACyL,gCAArD;IACA,UAAIJ,MAAJ,EACII,gCAAgC,GAAC7B,sCAAsC,CAAC5J,aAAD,AAAA,CAAvE,CADJ,KAGIyL,gCAAgC,GAACxB,qCAAqC,CAACjK,aAAD,AAAA,CAAtE;IACJ5H,MAAAA,mBAAmB,GAAG+R,sBAAsB,CAACsB,gCAAD,EAAmCzL,aAAnC,EAAkDwG,CAAlD,CAA5C;IACH;;IAED,QAAIzG,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAS5H,SAAT,EAAoBwE,aAApB,EAAmCC,eAAnC,EAAoDrG,WAApD,EAAiEmC,YAAjE,EAA8E;IACvG,aAAO;IACH+N,QAAAA,UAAU,EAACD,CAAC,CAACrO,SAAD,CADT;IAEHqM,QAAAA,cAAc,EAACgC,CAAC,CAAC7J,aAAD,CAFb;IAGHgK,QAAAA,gBAAgB,EAACH,CAAC,CAAC5J,eAAD,CAHf;IAIH8I,QAAAA,YAAY,EAACc,CAAC,CAACjQ,WAAD,CAJX;IAKHmQ,QAAAA,aAAa,EAACF,CAAC,CAAC9N,YAAD;IALZ,OAAP;IAOH,KARD;;IAUA,QAAIgT,WAAW,GAAG,IAAI9L,WAAJ,CACdC,cADc,EAEdxH,OAFc,EAGdiE,mBAHc,EAIdlE,mBAJc,EAKd0H,YALc,EAMdC,sBANc,EAOdC,aAPc,EAQdC,SARc,EASdC,MATc,CAAlB;IAWA,QAAIF,aAAa,CAAC2L,sBAAlB,EACI3L,aAAa,CAAC2L,sBAAd,CAAqCnB,OAArC,EAA8CkB,WAA9C;IAEJA,IAAAA,WAAW,CAACrP,IAAZ;IACA,WAAOqP,WAAP;IACH,GAlHe,EAkHblF,CAlHa,CAApB;IAmHH,CArHL,EAsHEtG,MAtHF,EAsHUsG,CAtHV;;;;"}