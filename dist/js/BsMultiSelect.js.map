{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/Bs4AdapterCss.js","../../js/src/Bs4AdapterJs.js","../../js/src/MultiSelect.js","../../js/src/AddToJQueryPrototype.js","../../js/src/Bs4Adapter.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["class Bs4AdapterCss {\r\n\r\n    constructor(jQuery, hiddenSelect, options) {\r\n        const defaults = {\r\n            containerClass: 'dashboardcode-bsmultiselect',\r\n            dropDownMenuClass: 'dropdown-menu',\r\n            dropDownItemClass: 'px-2',\r\n            dropDownItemHoverClass: 'text-primary bg-light',\r\n            selectedPanelClass: 'form-control',\r\n            selectedPanelFocusClass : 'focus',\r\n            selectedPanelDisabledClass: 'disabled',\r\n            selectedItemClass: 'badge',\r\n            removeSelectedItemButtonClass: 'close',\r\n            filterInputItemClass: '',\r\n            filterInputClass: ''\r\n        };\r\n        this.options = jQuery.extend({}, defaults, options);\r\n        this.jQuery=jQuery;\r\n        this.hiddenSelect=hiddenSelect;\r\n    }\r\n\r\n    GetDropDownItemClass(){\r\n        return this.options.dropDownItemClass;\r\n    }\r\n    \r\n    GetContainerClass(){\r\n        return this.options.containerClass;\r\n    }\r\n\r\n    GetDropDownItemHoverClass(){\r\n        return this.options.dropDownItemHoverClass;\r\n    }\r\n\r\n    Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu){\r\n        $container.addClass(this.options.containerClass);\r\n        $selectedPanel.addClass(this.options.selectedPanelClass);\r\n        $dropDownMenu.addClass(this.options.dropDownMenuClass);\r\n        $filterInputItem.addClass(this.options.filterInputItemClass)\r\n        $filterInput.addClass(this.options.filterInputClass);\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, $button){\r\n        $selectedItem.addClass(this.options.selectedItemClass);\r\n        $button.addClass(this.options.removeSelectedItemButtonClass)\r\n    }\r\n\r\n\r\n    Enable($selectedPanel){\r\n        $selectedPanel.removeClass(this.options.selectedPanelDisabledClass)\r\n    }\r\n\r\n    Disable($selectedPanel){\r\n        $selectedPanel.addClass(this.options.selectedPanelDisabledClass)\r\n    }\r\n\r\n    FocusIn($selectedPanel){\r\n        $selectedPanel.addClass(this.options.selectedPanelFocusClass);\r\n    }\r\n\r\n    FocusOut($selectedPanel){\r\n        $selectedPanel.removeClass(this.options.selectedPanelFocusClass);\r\n    }\r\n}\r\n\r\nexport default Bs4AdapterCss;\r\n","const defContainerClass= 'dashboardcode-bsmultiselect';\r\nconst defDropDownMenuClass= 'dropdown-menu';\r\nconst defDropDownItemHoverClass= 'text-primary bg-light';\r\nconst defSelectedPanelClass = 'form-control';\r\nconst defDropDownItemClass = 'px-2';\r\n\r\nconst defSelectedItemClass = 'badge';\r\nconst defSelectedPanelStyle= {'margin-bottom': '0'};\r\nconst defSelectedItemStyle= {'padding-left': '0px', 'line-height': '1.5em'};\r\nconst defRemoveSelectedItemButtonClass = 'close';\r\nconst defRemoveSelectedItemButtonStyle= {'font-size':'1.5em', 'line-height': '.9em'};\r\n\r\nclass Bs4AdapterJs {\r\n\r\n    constructor(jQuery, hiddenSelect, options) {\r\n        const defaults = {\r\n            selectedPanelDefMinHeight: 'calc(2.25rem + 2px)',\r\n            selectedPanelLgMinHeight:  'calc(2.875rem + 2px)',\r\n            selectedPanelSmMinHeight:  'calc(1.8125rem + 2px)',\r\n            selectedPanelDisabledBackgroundColor: '#e9ecef',\r\n            selectedPanelFocusBorderColor: '#80bdff',\r\n            selectedPanelFocusBoxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)',\r\n            selectedPanelFocusValidBoxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)',\r\n            selectedPanelFocusInvalidBoxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)',\r\n            filterInputColor: '#495057'\r\n        };\r\n        this.options = jQuery.extend({}, defaults, options);\r\n        this.jQuery=jQuery;\r\n        this.hiddenSelect=hiddenSelect;\r\n\r\n    }\r\n\r\n    GetDropDownItemClass(){\r\n        return defDropDownItemClass;\r\n    }\r\n\r\n    GetContainerClass(){\r\n        return defContainerClass;\r\n    }\r\n\r\n    GetDropDownItemHoverClass(){\r\n        return defDropDownItemHoverClass;\r\n    }\r\n\r\n    Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu){\r\n        $container.addClass(defContainerClass);\r\n        $selectedPanel.addClass(defSelectedPanelClass);\r\n        $selectedPanel.css(defSelectedPanelStyle);\r\n\r\n        $dropDownMenu.addClass(defDropDownMenuClass);\r\n        $filterInput.css(\"color\", this.options.filterInputColor);\r\n    }\r\n\r\n    UpdateSize($selectedPanel){\r\n        if ($selectedPanel.hasClass(\"form-control-lg\")){\r\n            $selectedPanel.css(\"min-height\", this.options.selectedPanelLgMinHeight);\r\n        } else if ($selectedPanel.hasClass(\"form-control-sm\")){\r\n            $selectedPanel.css(\"min-height\", this.options.selectedPanelSmMinHeight);\r\n        } else {\r\n            $selectedPanel.css(\"min-height\", this.options.selectedPanelDefMinHeight);\r\n        }\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, $button){\r\n        $selectedItem.addClass(defSelectedItemClass);\r\n        $selectedItem.css(defSelectedItemStyle);\r\n        $button.addClass(defRemoveSelectedItemButtonClass)\r\n        $button.css(defRemoveSelectedItemButtonStyle);\r\n    }\r\n\r\n    Enable($selectedPanel){\r\n        $selectedPanel.css({\"background-color\": \"\"})\r\n    }\r\n\r\n    Disable($selectedPanel){\r\n        $selectedPanel.css({\"background-color\": this.options.selectedPanelDisabledBackgroundColor})\r\n    }\r\n\r\n    FocusIn($selectedPanel){\r\n        if ($selectedPanel.hasClass(\"is-valid\")){\r\n            $selectedPanel.css(\"box-shadow\", this.options.selectedPanelFocusValidBoxShadow);\r\n        } else if ($selectedPanel.hasClass(\"is-invalid\")){\r\n            $selectedPanel.css(\"box-shadow\", this.options.selectedPanelFocusInvalidBoxShadow);\r\n        } else {\r\n            $selectedPanel\r\n                .css(\"box-shadow\", this.options.selectedPanelFocusBoxShadow)\r\n                .css(\"border-color\", this.options.selectedPanelFocusBorderColor);\r\n        }\r\n    }\r\n\r\n    FocusOut($selectedPanel){\r\n            $selectedPanel.css(\"box-shadow\", \"\" ).css(\"border-color\", \"\")\r\n    }\r\n}\r\n\r\nexport default Bs4AdapterJs;\r\n","import Popper from 'popper.js'\r\n\r\nconst defSelectedPanelStyleSys = {'display':'flex', 'flex-wrap':'wrap', 'list-style-type':'none'};  // remove bullets since this is ul\r\nconst defFilterInputStyleSys   = {'width':'2ch', 'border':'0', 'padding':'0', 'outline':'none', 'background-color':'transparent' };\r\nconst defDropDownMenuStyleSys  = {'list-style-type':'none'}; // remove bullets since this is ul\r\n\r\n// jQuery used for:\r\n// $.extend, $.contains, $(\"<div>\"), $(function(){}) aka ready\r\n// $e.trigger, $e.unbind, $e.on; but namespaces are not used;\r\n// events: \"focusin\", \"focusout\", \"mouseover\", \"mouseout\", \"keydown\", \"keyup\", \"click\"\r\n// $e.show, $e.hide, $e.focus, $e.css\r\n// $e.appendTo, $e.remove, $e.find, $e.closest, $e.prev, $e.data, $e.val\r\n\r\nclass MultiSelect {\r\n    constructor(selectElement, options, onDispose, adapter, window, $) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n        // readonly\r\n        this.selectElement = selectElement;\r\n        this.adapter = adapter;\r\n        this.window = window;\r\n        this.onDispose=onDispose;\r\n        this.$ = $;\r\n        \r\n        this.options = $.extend({}, options);\r\n        \r\n        this.container = null;\r\n        this.selectedPanel = null;\r\n        this.filterInputItem = null;\r\n        this.filterInput = null;\r\n        this.dropDownMenu = null;\r\n        this.popper = null;\r\n        // removable handlers\r\n        this.selectedPanelClick  = null;\r\n        this.documentMouseup   = null;\r\n        this.containerMousedown   = null;\r\n        this.documentMouseup2   = null;\r\n        // state\r\n        this.disabled=null;\r\n        this.filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n        this.skipFocusout = false;\r\n        this.hoveredDropDownItem = null;\r\n        this.hoveredDropDownIndex = null;\r\n        this.hasDropDownVisible = false;\r\n\r\n        // jquery adapters\r\n        this.$document= $(window.document);\r\n        this.init();\r\n    }\r\n    updateDropDownPosition(force) {\r\n        let offsetLeft = this.filterInputItem.offsetLeft;\r\n        if (force || this.filterInputItemOffsetLeft!=offsetLeft){\r\n            this.popper.update();\r\n            this.filterInputItemOffsetLeft=offsetLeft;\r\n        }\r\n    }\r\n    hideDropDown() {\r\n        this.dropDownMenu.style.display = 'none';\r\n    }\r\n    showDropDown() {\r\n        this.dropDownMenu.style.display = 'block';\r\n    }\r\n    // Public methods\r\n    resetDropDownMenuHover() {\r\n        if (this.hoveredDropDownItem !== null) {\r\n            this.adapter.HoverOut(this.$(this.hoveredDropDownItem));\r\n            this.hoveredDropDownItem = null;\r\n        }\r\n        this.hoveredDropDownIndex = null;\r\n    }\r\n    filterDropDownMenu() {\r\n        let text = this.filterInput.value.trim().toLowerCase();\r\n        let visible = 0;\r\n        this.$(this.dropDownMenu).find('LI').each((i, dropDownMenuItem) => {\r\n            let $dropDownMenuItem = this.$(dropDownMenuItem);\r\n            if (text == '') {\r\n                $dropDownMenuItem.show();\r\n                visible++;\r\n            }\r\n            else {\r\n                let itemText = $dropDownMenuItem.data(\"option-text\");\r\n                let isSelected = $dropDownMenuItem.data(\"option-selected\");\r\n                if (!isSelected && itemText.indexOf(text)>=0) {\r\n                    $dropDownMenuItem.show();\r\n                    visible++;\r\n                } else {\r\n                    $dropDownMenuItem.hide();\r\n                }\r\n            }\r\n        });\r\n        this.hasDropDownVisible = visible > 0;\r\n        this.resetDropDownMenuHover();\r\n    }\r\n    clearFilterInput(updatePosition) {\r\n        if (this.filterInput.value) {\r\n            this.filterInput.value = '';\r\n            this.input(updatePosition);\r\n        }\r\n    }\r\n    closeDropDown() {\r\n        this.resetDropDownMenuHover();\r\n        this.clearFilterInput(true);\r\n        this.hideDropDown();\r\n    }\r\n    appendDropDownItem(optionElement) {\r\n        let optionId = optionElement.value;\r\n        let itemText = optionElement.text;\r\n        let isSelected = optionElement.selected;\r\n        let $dropDownItem = this.$(\"<LI/>\");\r\n        $dropDownItem.data(\"option-id\", optionId);\r\n        $dropDownItem.data(\"option-text\", itemText.toLowerCase());\r\n        let adoptDropDownItem = this.adapter.CreateDropDownItemContent($dropDownItem, optionId, itemText, isSelected)\r\n        $dropDownItem.appendTo(this.dropDownMenu);\r\n        let appendItem = (doTrigger) => {\r\n            $dropDownItem.data(\"option-selected\", true);\r\n            let $selectedItem = this.$(\"<LI/>\");\r\n            $selectedItem.data(\"option-id\", optionId);\r\n            optionElement.selected = true;\r\n            adoptDropDownItem(true);\r\n            let removeItem = () => {\r\n                $dropDownItem.data(\"option-selected\", false);\r\n                $dropDownItem.data(\"option-toggle\", appendItem);\r\n                $selectedItem.data(\"option-remove\", null);\r\n                $selectedItem.remove();\r\n                optionElement.selected = false;\r\n                adoptDropDownItem(false);\r\n                this.$(this.selectElement).trigger('change');\r\n            };\r\n            let removeItemAndCloseDropDown = () => {\r\n                removeItem();\r\n                this.closeDropDown();\r\n            };\r\n\r\n            this.adapter.CreateSelectedItemContent(\r\n                $selectedItem,\r\n                itemText,\r\n                removeItemAndCloseDropDown,\r\n                this.disabled\r\n            );\r\n            $selectedItem.insertBefore(this.filterInputItem);\r\n            $dropDownItem.data(\"option-toggle\", removeItem);\r\n            $selectedItem.data(\"option-remove\", removeItemAndCloseDropDown);\r\n            if (typeof doTrigger === \"undefined\" || doTrigger===true)\r\n                this.$(this.selectElement).trigger('change');\r\n            return $selectedItem;\r\n        }\r\n        $dropDownItem.data(\"option-toggle\", appendItem );\r\n        \r\n        if (isSelected) {\r\n            appendItem(false);\r\n        }\r\n        let closest = (event) => this.$(event.target).closest(\"LI\");\r\n        // let manageHoverIn = (event) => {\r\n        //     this.adapter.HoverIn(closest(event))\r\n        // }\r\n        // let manageHoverOut = (event) => {\r\n        //     this.adapter.HoverOut(closest(event))\r\n        // }\r\n        $dropDownItem.click(event => {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            let toggleItem = this.$(event.currentTarget).closest(\"LI\").data(\"option-toggle\");\r\n            toggleItem();\r\n            this.filterInput.focus();\r\n        }).mouseover(e => this.adapter.HoverIn(closest(e)))\r\n          .mouseout(e => this.adapter.HoverOut(closest(e)));\r\n    }\r\n    keydownArrow(down) {\r\n        let visibleNodeListArray = this.$(this.dropDownMenu).find('LI:not([style*=\"display: none\"])').toArray();\r\n        if (visibleNodeListArray.length > 0) {\r\n            if (this.hasDropDownVisible) {\r\n                this.updateDropDownPosition(true);\r\n                this.showDropDown();\r\n            }\r\n            if (this.hoveredDropDownItem === null) {\r\n                this.hoveredDropDownIndex = down ? 0 : visibleNodeListArray.length - 1;\r\n            }\r\n            else {\r\n                this.adapter.HoverOut(this.$(this.hoveredDropDownItem));\r\n                if (down) {\r\n                    let newIndex = this.hoveredDropDownIndex + 1;\r\n                    this.hoveredDropDownIndex = newIndex < visibleNodeListArray.length ? newIndex : 0;\r\n                } else {\r\n                    let newIndex = this.hoveredDropDownIndex - 1;\r\n                    this.hoveredDropDownIndex = newIndex >= 0 ? newIndex : visibleNodeListArray.length - 1;\r\n                }\r\n            }\r\n            this.hoveredDropDownItem = visibleNodeListArray[this.hoveredDropDownIndex];\r\n            this.adapter.HoverIn(this.$(this.hoveredDropDownItem));\r\n        }\r\n    }\r\n    input(forceUpdatePosition) {\r\n        this.filterInput.style.width = this.filterInput.value.length*1.3 + 2 + \"ch\";\r\n        this.filterDropDownMenu();\r\n        if (this.hasDropDownVisible) {\r\n            if (forceUpdatePosition) // ignore it if it is called from\r\n                this.updateDropDownPosition(forceUpdatePosition); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.showDropDown();\r\n        } else {\r\n            this.hideDropDown();\r\n        }\r\n    }\r\n    Update(){\r\n        let $selectedPanel = this.$(this.selectedPanel);\r\n        this.adapter.UpdateIsValid($selectedPanel);\r\n        this.UpdateSizeImpl($selectedPanel);\r\n        this.UpdateDisabledImpl(this.$(this.container), $selectedPanel);\r\n    }\r\n    Dispose(){\r\n        if (this.onDispose)\r\n            this.onDispose();\r\n        \r\n            // removable handlers\r\n        this.$document.unbind(\"mouseup\", this.documentMouseup)\r\n                      .unbind(\"mouseup\", this.documentMouseup2);\r\n        \r\n        if (this.adapter !== null) {\r\n            this.adapter.Dispose()\r\n        }\r\n        if (this.popper !== null) {\r\n            this.popper.destroy()\r\n        }\r\n        \r\n        if (this.container !== null) {\r\n            this.$(this.container).remove();\r\n        }\r\n        // this.selectedPanel = null;\r\n        // this.filterInputItem = null;\r\n        // this.filterInput = null;\r\n        // this.dropDownMenu = null;\r\n        // this.selectElement = null;\r\n        // this.options = null;\r\n    }\r\n    UpdateSize(){\r\n        this.UpdateSizeImpl(this.$(this.selectedPanel));\r\n    }\r\n    UpdateDisabled(){\r\n        this.UpdateDisabledImpl(this.$(this.container), this.$(this.selectedPanel));\r\n    }\r\n    UpdateSizeImpl($selectedPanel){\r\n        if (this.adapter.UpdateSize)\r\n            this.adapter.UpdateSize($selectedPanel);\r\n    }\r\n    UpdateDisabledImpl($container, $selectedPanel){\r\n        let disabled = this.selectElement.disabled;\r\n        if (this.disabled!==disabled){\r\n            if (disabled) {\r\n                this.filterInput.style.display = \"none\";\r\n                this.adapter.Disable($selectedPanel);\r\n\r\n                $container.unbind(\"mousedown\", this.containerMousedown);\r\n                this.$document.unbind(\"mouseup\", this.documentMouseup);\r\n\r\n                $selectedPanel.unbind(\"click\", this.selectedPanelClick);\r\n                this.$document.unbind(\"mouseup\", this.documentMouseup2);\r\n                \r\n            } else {\r\n                this.filterInput.style.display = \"inline-block\";\r\n                this.adapter.Enable($selectedPanel);\r\n\r\n                $container.mousedown(this.containerMousedown);    // removable\r\n                this.$document.mouseup(this.documentMouseup); // removable\r\n\r\n                $selectedPanel.click(this.selectedPanelClick);     // removable\r\n                this.$document.mouseup(this.documentMouseup2); // removable\r\n            }\r\n            this.disabled=disabled;\r\n        }\r\n    }\r\n    init() {\r\n        let $selectElement = this.$(this.selectElement);\r\n        $selectElement.hide();\r\n        let $container = this.$(\"<DIV/>\");\r\n        this.container = $container.get(0);\r\n        let $selectedPanel = this.$(\"<UL/>\");\r\n        $selectedPanel.css(defSelectedPanelStyleSys);\r\n        \r\n        this.selectedPanel = $selectedPanel.get(0);\r\n        \r\n        $selectedPanel.appendTo(this.container);\r\n        let $filterInputItem = this.$('<LI/>');\r\n        this.filterInputItem = $filterInputItem.get(0)\r\n        $filterInputItem.appendTo(this.selectedPanel);\r\n        let $filterInput = this.$('<INPUT type=\"search\" autocomplete=\"off\">');\r\n        $filterInput.css(defFilterInputStyleSys);\r\n        $filterInput.appendTo(this.filterInputItem);\r\n        this.filterInput = $filterInput.get(0);\r\n        let $dropDownMenu = this.$(\"<UL/>\")\r\n            .css({\"display\":\"none\"})\r\n            .appendTo($container);\r\n        this.dropDownMenu = $dropDownMenu.get(0);\r\n        \r\n        // prevent heavy understandable styling error\r\n        $dropDownMenu.css(defDropDownMenuStyleSys);\r\n        // create handlers\r\n        this.documentMouseup = () => {\r\n            this.skipFocusout = false;\r\n        }\r\n\r\n        this.containerMousedown = () => {\r\n            this.skipFocusout = true;\r\n        };\r\n        this.documentMouseup2 = event => {\r\n            if (!(this.container === event.target || this.$.contains(this.container, event.target))) {\r\n                this.closeDropDown();\r\n            }\r\n        }\r\n        this.selectedPanelClick = event => {\r\n            if (event.target.nodeName != \"INPUT\")\r\n                this.$(this.filterInput).val('').focus();\r\n            if (this.hasDropDownVisible && this.adapter.IsClickToOpenDropdown(event)){\r\n                this.updateDropDownPosition(true);\r\n                this.showDropDown();\r\n            }\r\n        };\r\n        this.adapter.Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu);\r\n        $container.insertAfter($selectElement);\r\n        \r\n        this.popper = new Popper(this.filterInput, this.dropDownMenu, {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: { enabled:false }\r\n                }\r\n        });\r\n        this.adapter.UpdateIsValid($selectedPanel);\r\n        this.UpdateSizeImpl($selectedPanel);\r\n        this.UpdateDisabledImpl($container, $selectedPanel);\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        // bellow: ready shortcut\r\n        this.$(() => {\r\n            let selectOptions = $selectElement.find('OPTION');\r\n            selectOptions.each(\r\n                (index, optionElement) => {\r\n                    this.appendDropDownItem(optionElement);\r\n                }\r\n            );\r\n            this.hasDropDownVisible = selectOptions.length > 0;\r\n            this.updateDropDownPosition(false);\r\n        });\r\n        $dropDownMenu.click( event => event.stopPropagation());\r\n        $dropDownMenu.mouseover(() => this.resetDropDownMenuHover());\r\n\r\n        $filterInput.focusin(() => this.adapter.FocusIn($selectedPanel))\r\n                    .focusout(() => {\r\n                            if (!this.skipFocusout)\r\n                                this.adapter.FocusOut($selectedPanel)\r\n                            });\r\n        $filterInput.on(\"keydown\", (event) => {\r\n            if (event.which == 38) {\r\n                event.preventDefault();\r\n                this.keydownArrow(false);\r\n            }\r\n            else if (event.which == 40) {\r\n                event.preventDefault()\r\n                this.keydownArrow(true);\r\n            }\r\n            else if (event.which == 13) {\r\n                event.preventDefault();\r\n            }\r\n            else if (event.which == 9) {\r\n                if (this.filterInput.value) {\r\n                    event.preventDefault();\r\n                }\r\n                else {\r\n                    this.closeDropDown();\r\n                }\r\n            }\r\n            else {\r\n                if (event.which == 8) {\r\n                    // NOTE: this will process backspace only if there are no text in the input field\r\n                    // If user will find this inconvinient, we will need to calculate something like this\r\n                    // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n                    if (!this.filterInput.value)\r\n                    {\r\n                        let $penult = this.$(this.selectedPanel).find(\"LI:last\").prev();\r\n                        if ($penult.length){\r\n                            let removeItem = $penult.data(\"option-remove\");\r\n                            removeItem();\r\n                        }\r\n                        this.updateDropDownPosition(false);\r\n                    }\r\n                }\r\n                this.resetDropDownMenuHover();\r\n            }\r\n        });\r\n        $filterInput.on(\"keyup\", (event) => {\r\n            if (event.which == 13 || event.which == 9 ) {\r\n                if (this.hoveredDropDownItem) {\r\n                    let $hoveredDropDownItem = this.$(this.hoveredDropDownItem);\r\n                    let toggleItem =  $hoveredDropDownItem.data(\"option-toggle\");\r\n                    toggleItem();\r\n                    this.closeDropDown();\r\n                } else {\r\n                    let text = this.filterInput.value.trim().toLowerCase();\r\n                    let dropDownItems = this.dropDownMenu.querySelectorAll(\"LI\");\r\n                    let dropDownItem = null;\r\n                    for (let i = 0; i < dropDownItems.length; ++i) {\r\n                        let it = dropDownItems[i];\r\n                        if (it.textContent.trim().toLowerCase() == text)\r\n                        {\r\n                            dropDownItem=it;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (dropDownItem) {\r\n                        let $dropDownItem = this.$(dropDownItem);\r\n                        let isSelected = $dropDownItem.data(\"option-selected\");\r\n                        if (!isSelected){\r\n                            let toggle = $dropDownItem.data(\"option-toggle\");\r\n                            toggle();\r\n                        }\r\n                        this.clearFilterInput(true);\r\n                    }\r\n                }\r\n            }\r\n            else if (event.which == 27) { // escape\r\n                this.closeDropDown();\r\n            }\r\n        });\r\n        $filterInput.on('input', () => {\r\n            this.input(true);\r\n        });\r\n    }\r\n}\r\n\r\nexport default MultiSelect;\r\n","function AddToJQueryPrototype(pluginName, createPlugin, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    if (firstChar.toLowerCase() == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstChar.toLowerCase() + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance for 1st $selected item\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n}\r\n\r\nexport default AddToJQueryPrototype\r\n","class Bs4Adapter {\r\n\r\n    constructor(jQuery, hiddenSelect, adapter){\r\n        this.$=jQuery;\r\n        this.hiddenSelect=hiddenSelect;\r\n        this.adapter = adapter;\r\n        this.containerClass = adapter.GetContainerClass();\r\n        this.dropDownItemHoverClass = adapter.GetDropDownItemHoverClass();\r\n        this.bs4CommonsLabelDispose = null;\r\n    }\r\n\r\n    HandleLabel($selectedPanel){\r\n        let inputId = this.hiddenSelect.id;\r\n        let $formGroup = this.$(this.hiddenSelect).closest('.form-group');\r\n        if ($formGroup.length == 1) {\r\n            let $label = $formGroup.find(`label[for=\"${inputId}\"]`);\r\n            let forId = $label.attr('for');\r\n            let $filterInput = $selectedPanel.find('input');\r\n            if (forId == this.hiddenSelect.id) {\r\n                let id = `${this.containerClass}-generated-filter-id-${this.hiddenSelect.id}`;\r\n                $filterInput.attr('id', id);\r\n                $label.attr('for', id);\r\n                return () => {\r\n                    $label.attr('for', forId);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    // ------------------------------------------\r\n    Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu){\r\n        this.adapter.Init($container, $selectedPanel, $filterInputItem, $filterInput, $dropDownMenu)\r\n        this.bs4CommonsLabelDispose = this.HandleLabel($selectedPanel);\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.bs4CommonsLabelDispose)\r\n            this.bs4CommonsLabelDispose();\r\n    }\r\n\r\n    // ------------------------\r\n    CreateDropDownItemContent(\r\n        $dropDownItem, optionId, itemText, isSelected){\r\n\r\n        let checkBoxId = `${this.containerClass}-${this.hiddenSelect.name.toLowerCase()}-generated-id-${optionId.toLowerCase()}`;\r\n        let checked = isSelected ? \"checked\" : \"\";\r\n\r\n        let $dropDownItemContent= this.$(`<div class=\"custom-control custom-checkbox\">\r\n            <input type=\"checkbox\" class=\"custom-control-input\" id=\"${checkBoxId}\" ${checked}>\r\n            <label class=\"custom-control-label\" for=\"${checkBoxId}\">${itemText}</label>\r\n        </div>`)\r\n        $dropDownItemContent.appendTo($dropDownItem);\r\n        let $checkBox = $dropDownItem.find(`INPUT[type=\"checkbox\"]`);\r\n        let adoptDropDownItem = isSelected => {\r\n            $checkBox.prop('checked', isSelected);\r\n        }\r\n        $dropDownItem.addClass(this.adapter.GetDropDownItemClass());\r\n        return adoptDropDownItem;\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, itemText, removeSelectedItem, disabled){\r\n        this.$(`<span>${itemText}</span>`).appendTo($selectedItem);\r\n        let $button = this.$('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n            .css(\"white-space\", \"nowrap\")\r\n            .on(\"click\", removeSelectedItem)\r\n            .appendTo($selectedItem)\r\n            .prop(\"disabled\", disabled)\r\n        this.adapter.CreateSelectedItemContent($selectedItem, $button)\r\n    }\r\n    // -----------------------\r\n    IsClickToOpenDropdown(event){\r\n        return !(event.target.nodeName == \"BUTTON\" || (event.target.nodeName == \"SPAN\" && event.target.parentElement.nodeName == \"BUTTON\"))\r\n    }\r\n\r\n    UpdateIsValid($selectedPanel){\r\n        let $hiddenSelect = this.$(this.hiddenSelect);\r\n        if ($hiddenSelect.hasClass(\"is-valid\")){\r\n            $selectedPanel.addClass(\"is-valid\");\r\n        }\r\n\r\n        if ($hiddenSelect.hasClass(\"is-invalid\")){\r\n            $selectedPanel.addClass(\"is-invalid\");\r\n        }\r\n    }\r\n\r\n    UpdateSize($selectedPanel){\r\n        if(this.adapter.UpdateSize)\r\n            this.adapter.UpdateSize($selectedPanel)\r\n    }\r\n\r\n\r\n    Enable($selectedPanel){\r\n        this.adapter.Enable($selectedPanel)\r\n        $selectedPanel.find('BUTTON').prop(\"disabled\", false);\r\n    }\r\n\r\n    Disable($selectedPanel){\r\n        this.adapter.Disable($selectedPanel)\r\n        $selectedPanel.find('BUTTON').prop(\"disabled\", true);\r\n    }\r\n\r\n    FocusIn($selectedPanel){\r\n        this.adapter.FocusIn($selectedPanel)\r\n    }\r\n\r\n    FocusOut($selectedPanel){\r\n        this.adapter.FocusOut($selectedPanel)\r\n    }\r\n\r\n    HoverIn($dropDownItem){\r\n        $dropDownItem.addClass(this.dropDownItemHoverClass);\r\n    }\r\n\r\n    HoverOut($dropDownItem){\r\n        $dropDownItem.removeClass(this.dropDownItemHoverClass);\r\n    }\r\n}\r\n\r\nexport default Bs4Adapter;\r\n","import $ from 'jquery'\r\nimport Bs4AdapterCss from './Bs4AdapterCss'\r\nimport Bs4AdapterJs from './Bs4AdapterJs'\r\nimport MultiSelect from './MultiSelect'\r\nimport AddToJQueryPrototype from './AddToJQueryPrototype'\r\nimport Bs4Adapter from './Bs4Adapter';\r\n\r\n(\r\n    (window, $) => {\r\n        AddToJQueryPrototype('BsMultiSelect',\r\n            (element, optionsObject, onDispose) => {\r\n                let adapter = optionsObject && optionsObject.useCss\r\n                ? new Bs4AdapterCss($, element, optionsObject)\r\n                : new Bs4AdapterJs($, element, optionsObject);\r\n                let facade = new Bs4Adapter($, element, adapter);\r\n                return new MultiSelect(element, optionsObject, onDispose, facade, window, $);\r\n            }, $);\r\n    }\r\n)(window, $)\r\n"],"names":["Bs4AdapterCss","jQuery","hiddenSelect","options","defaults","containerClass","dropDownMenuClass","dropDownItemClass","dropDownItemHoverClass","selectedPanelClass","selectedPanelFocusClass","selectedPanelDisabledClass","selectedItemClass","removeSelectedItemButtonClass","filterInputItemClass","filterInputClass","extend","GetDropDownItemClass","GetContainerClass","GetDropDownItemHoverClass","Init","$container","$selectedPanel","$filterInputItem","$filterInput","$dropDownMenu","addClass","CreateSelectedItemContent","$selectedItem","$button","Enable","removeClass","Disable","FocusIn","FocusOut","defContainerClass","defDropDownMenuClass","defDropDownItemHoverClass","defSelectedPanelClass","defDropDownItemClass","defSelectedItemClass","defSelectedPanelStyle","defSelectedItemStyle","defRemoveSelectedItemButtonClass","defRemoveSelectedItemButtonStyle","Bs4AdapterJs","selectedPanelDefMinHeight","selectedPanelLgMinHeight","selectedPanelSmMinHeight","selectedPanelDisabledBackgroundColor","selectedPanelFocusBorderColor","selectedPanelFocusBoxShadow","selectedPanelFocusValidBoxShadow","selectedPanelFocusInvalidBoxShadow","filterInputColor","css","UpdateSize","hasClass","defSelectedPanelStyleSys","defFilterInputStyleSys","defDropDownMenuStyleSys","MultiSelect","selectElement","onDispose","adapter","window","$","Popper","TypeError","container","selectedPanel","filterInputItem","filterInput","dropDownMenu","popper","selectedPanelClick","documentMouseup","containerMousedown","documentMouseup2","disabled","filterInputItemOffsetLeft","skipFocusout","hoveredDropDownItem","hoveredDropDownIndex","hasDropDownVisible","$document","document","init","updateDropDownPosition","force","offsetLeft","update","hideDropDown","style","display","showDropDown","resetDropDownMenuHover","HoverOut","filterDropDownMenu","text","value","trim","toLowerCase","visible","find","each","i","dropDownMenuItem","$dropDownMenuItem","show","itemText","data","isSelected","indexOf","hide","clearFilterInput","updatePosition","input","closeDropDown","appendDropDownItem","optionElement","optionId","selected","$dropDownItem","adoptDropDownItem","CreateDropDownItemContent","appendTo","appendItem","doTrigger","removeItem","remove","trigger","removeItemAndCloseDropDown","insertBefore","closest","event","target","click","preventDefault","stopPropagation","toggleItem","currentTarget","focus","mouseover","HoverIn","e","mouseout","keydownArrow","down","visibleNodeListArray","toArray","length","newIndex","forceUpdatePosition","width","Update","UpdateIsValid","UpdateSizeImpl","UpdateDisabledImpl","Dispose","unbind","destroy","UpdateDisabled","mousedown","mouseup","$selectElement","get","contains","nodeName","val","IsClickToOpenDropdown","insertAfter","placement","modifiers","preventOverflow","enabled","flip","selectOptions","index","focusin","focusout","on","which","$penult","prev","$hoveredDropDownItem","dropDownItems","querySelectorAll","dropDownItem","it","textContent","toggle","AddToJQueryPrototype","pluginName","createPlugin","firstChar","charAt","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","$e","instance","isMethodName","test","optionsObject","removeData","methodName","noConflict","Bs4Adapter","bs4CommonsLabelDispose","HandleLabel","inputId","id","$formGroup","$label","forId","attr","checkBoxId","name","checked","$dropDownItemContent","$checkBox","prop","removeSelectedItem","parentElement","$hiddenSelect","element","useCss","facade"],"mappings":"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"}