{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/MultiSelect.js","../../js/src/LabelAdapter.js","../../js/src/OptionsAdapters.js","../../js/src/Tools.js","../../js/src/Bs4StylingMethodCss.js","../../js/src/Bs4StylingMethodJs.js","../../js/src/Bs4Styling.js","../../js/src/AddToJQueryPrototype.js","../../js/src/Bs4SelectedItemContent.js","../../js/src/Bs4DropDownItemContent.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["import Popper from 'popper.js'\r\n\r\nfunction defSelectedPanelStyleSys(s) {s.display='flex'; s.flexWrap='wrap'; s.listStyleType='none'};  // remove bullets since this is ul\r\nfunction defFilterInputStyleSys(s) {s.width='2ch'; s.border='0'; s.padding='0'; s.outline='none'; s.backgroundColor='transparent' };\r\nfunction defDropDownMenuStyleSys(s) {s.listStyleType='none'}; // remove bullets since this is ul\r\nfunction removeElement(e) {e.parentNode.removeChild(e)}\r\n\r\nfunction filterMultiSelectData(MultiSelectData, isFiltered, visibleIndex) {\r\n    MultiSelectData.visible = isFiltered;\r\n    MultiSelectData.visibleIndex = visibleIndex;\r\n    MultiSelectData.dropDownMenuItemElement.style.display = isFiltered ? 'block': 'none';\r\n} \r\n\r\nfunction resetFilterDropDownMenu(MultiSelectDataList) {\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            filterMultiSelectData(multiSelectData, true, i);\r\n        }\r\n    }\r\n}\r\n\r\nfunction filterDropDownMenu(MultiSelectDataList, text) {\r\n    var list = [];\r\n    var j = 0;\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            if ( multiSelectData.excludedFromSearch || multiSelectData.searchText.indexOf(text)<0 )\r\n            {\r\n                filterMultiSelectData(multiSelectData, false);\r\n            }\r\n            else \r\n            {\r\n                filterMultiSelectData(multiSelectData, true, j++);\r\n                list.push( multiSelectData );\r\n            }\r\n        }\r\n    }\r\n    return list;\r\n}\r\n\r\nclass MultiSelect {\r\n    constructor(optionsAdapter, styling, \r\n        selectedItemContent, dropDownItemContent, \r\n        labelAdapter, createStylingComposite,\r\n        configuration, onDispose, window) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n\r\n        // readonly\r\n        this.optionsAdapter = optionsAdapter;\r\n        this.container = optionsAdapter.container; // part of published api\r\n        this.styling = styling;\r\n        this.selectedItemContent = selectedItemContent;\r\n        this.dropDownItemContent = dropDownItemContent;\r\n        this.labelAdapter = labelAdapter;\r\n        this.createStylingComposite = createStylingComposite;\r\n        this.configuration = configuration;\r\n        this.onDispose = onDispose;\r\n        this.isDisposed = false;\r\n        this.window = window;\r\n        this.document = window.document;\r\n\r\n        this.popper = null;\r\n\r\n        this.visibleCount=10;\r\n\r\n        this.selectedPanel = null;\r\n        this.filterInputItem = null;\r\n        this.filterInput = null;\r\n        this.dropDownMenu = null;\r\n\r\n        this.stylingComposite = null;\r\n\r\n        // removable handlers\r\n        this.selectedPanelClick  = null;\r\n        this.documentMouseup = null;\r\n        this.containerMousedown = null;\r\n        this.documentMouseup2 = null;\r\n\r\n        // state\r\n        this.isComponentDisabled = null;\r\n        this.filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n        \r\n        this.resetMultiSelectDataList();\r\n        this.skipFocusout = false;\r\n        this.hoveredMultiSelectData = null;\r\n        this.hoveredMultiSelectDataIndex = null;\r\n        \r\n    }\r\n\r\n    resetMultiSelectDataList(){\r\n        this.MultiSelectDataList = [];\r\n        this.MultiSelectDataSelectedTail = null;\r\n        this.visibleMultiSelectDataList = null;\r\n    }\r\n\r\n    getVisibleMultiSelectDataList(){\r\n        if (this.visibleMultiSelectDataList)\r\n            return this.visibleMultiSelectDataList;\r\n        else\r\n            return this.MultiSelectDataList;\r\n    }\r\n\r\n    removeSelectedTail(){\r\n        if (this.MultiSelectDataSelectedTail){ \r\n            this.MultiSelectDataSelectedTail.toggle(); // always remove in this case\r\n        }\r\n        this.updateDropDownLocation(false);\r\n    }\r\n\r\n    updateDropDownLocation(force) {\r\n        let offsetLeft = this.filterInputItem.offsetLeft;\r\n        if (force || this.filterInputItemOffsetLeft!=offsetLeft){\r\n            this.popper.update();\r\n            this.filterInputItemOffsetLeft=offsetLeft;\r\n        }\r\n    }\r\n\r\n    hideDropDown() {\r\n        if (this.candidateToHoveredMultiSelectData){\r\n            this.resetCandidateToHoveredMultiSelectData();\r\n        }\r\n        if (this.dropDownMenu.style.display != 'none')\r\n        {\r\n            console.log(\"removed\");\r\n            this.dropDownMenu.style.display = 'none';\r\n            // remove listeners that manages close dropdown on input's focusout and click outside container\r\n            this.container.removeEventListener(\"mousedown\", this.containerMousedown);\r\n            this.document.removeEventListener(\"mouseup\", this.documentMouseup);\r\n            this.document.removeEventListener(\"mouseup\", this.documentMouseup2);\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    showDropDown() {\r\n        if (this.dropDownMenu.style.display != 'block')\r\n        {\r\n            this.inShowDropDown = true;\r\n            setTimeout( () => {  \r\n                this.inShowDropDown = null;\r\n            }, 0)\r\n            this.dropDownMenu.style.display = 'block';\r\n            // add listeners that manages close dropdown on input's focusout and click outside container\r\n            this.container.addEventListener(\"mousedown\", this.containerMousedown);\r\n            this.document.addEventListener(\"mouseup\", this.documentMouseup);\r\n            this.document.addEventListener(\"mouseup\", this.documentMouseup2);\r\n\r\n\r\n        }\r\n    }\r\n\r\n    hoverInInternal(index){\r\n        this.hoveredMultiSelectDataIndex = index;\r\n        this.hoveredMultiSelectData = this.getVisibleMultiSelectDataList()[index];\r\n        this.styling.HoverIn(this.hoveredMultiSelectData.dropDownMenuItemElement);\r\n    }\r\n\r\n    resetDropDownMenuHover() {\r\n        if (this.hoveredMultiSelectData) {\r\n            this.styling.HoverOut(this.hoveredMultiSelectData.dropDownMenuItemElement);\r\n            this.hoveredMultiSelectData = null;\r\n            this.hoveredMultiSelectDataIndex = null;\r\n        }\r\n    }\r\n\r\n    resetFilterAndHideDropDown() {\r\n        //this.resetDropDownMenuHover();\r\n        if (this.filterInput.value) {\r\n            this.filterInput.value = '';\r\n            this.processEmptyInput();\r\n\r\n            // this.resetDropDownMenuHover(); // TODO: second time resetDropDownMenuHover?\r\n        \r\n            // if (this.getVisibleMultiSelectDataList().length == 1) {\r\n            //     this.hoverInInternal(0)\r\n            // }\r\n        }\r\n        this.hideDropDown();\r\n    }\r\n    \r\n    removeSelectedFromList(MultiSelectData){\r\n        if (MultiSelectData.selectedPrev){\r\n            (MultiSelectData.selectedPrev).selectedNext = MultiSelectData.selectedNext;\r\n        }\r\n        if (MultiSelectData.selectedNext){\r\n           (MultiSelectData.selectedNext).selectedPrev = MultiSelectData.selectedPrev;\r\n        }\r\n        if (this.MultiSelectDataSelectedTail == MultiSelectData){\r\n            this.MultiSelectDataSelectedTail = MultiSelectData.selectedPrev;\r\n        }\r\n        MultiSelectData.selectedNext=null;\r\n        MultiSelectData.selectedPrev=null;\r\n    }\r\n\r\n    insertDropDownItem(MultiSelectData, insertToDropDownMenu, isSelected, isOptionDisabled) {\r\n        var dropDownMenuItemElement = this.document.createElement('LI');\r\n        \r\n        // in chrome it happens on \"become visible\" so we need to skip it, \r\n        // for IE11 and edge it doesn't happens, but for IE11 and Edge it doesn't happens on small \r\n        // mouse moves inside the item. \r\n        // https://stackoverflow.com/questions/59022563/browser-events-mouseover-doesnt-happen-when-you-make-element-visible-and-mous\r\n        \r\n        var onDropDownMenuItemElementMouseover = () => \r\n        {\r\n            if (!this.inShowDropDown)\r\n            {\r\n                \r\n                if (this.hoveredMultiSelectData!=MultiSelectData)\r\n                {\r\n                    // mouseleave is not enough to guarantee remove hover styles in situations\r\n                    // when style was setuped without mouse (keyboard arrows)\r\n                    // therefore force reset manually\r\n                    this.resetDropDownMenuHover(); \r\n                    this.hoverInInternal(MultiSelectData.visibleIndex);\r\n                }\r\n            }\r\n            else\r\n            {\r\n                this.candidateToHoveredMultiSelectData = MultiSelectData;\r\n                dropDownMenuItemElement.addEventListener('mousemove', this.processCandidateToHovered);\r\n                dropDownMenuItemElement.addEventListener('mousedown', this.processCandidateToHovered);\r\n            }\r\n        }\r\n\r\n        dropDownMenuItemElement.addEventListener('mouseover', onDropDownMenuItemElementMouseover);\r\n        \r\n        // note 1: mouseleave preferred to mouseout - which fires on each descendant\r\n        // note 2: since I want add aditional info panels to the dropdown put mouseleave on dropdwon would not work\r\n        var onDropDownMenuItemElementMouseleave = () => this.resetDropDownMenuHover();\r\n        dropDownMenuItemElement.addEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n\r\n\r\n        insertToDropDownMenu(dropDownMenuItemElement);\r\n\r\n        let dropDownItemContent = this.dropDownItemContent(dropDownMenuItemElement, MultiSelectData.option); \r\n        MultiSelectData.dropDownMenuItemElement = dropDownMenuItemElement;\r\n        MultiSelectData.DropDownItemContent = dropDownItemContent;\r\n\r\n        MultiSelectData.DisposeDropDownMenuItemElement = ()=> {\r\n            dropDownMenuItemElement.removeEventListener('mouseover',  onDropDownMenuItemElementMouseover);\r\n            dropDownMenuItemElement.removeEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n        }\r\n\r\n        var setDropDownItemContentDisabled = (dropDownItemContent,  isSelected) => {\r\n            dropDownItemContent.disabledStyle(true);\r\n            // do not desable if selected! there should be possibility to unselect \"disabled\"\r\n            dropDownItemContent.disable(!isSelected);\r\n        }\r\n        \r\n        // var setEnabled = (dropDownItemContent) => {\r\n        //     dropDownItemContent.disabledStyle(false);\r\n        //     dropDownItemContent.disable(false);\r\n        // }\r\n\r\n        if (isOptionDisabled)\r\n            setDropDownItemContentDisabled(dropDownItemContent, isSelected )\r\n        // if (isSelected && isOptionDisabled) // do not desable if selected! there should be possibility to unselect \"disabled\"\r\n        //     dropDownItemContent.disabledStyle(true);\r\n        // else if (isOptionDisabled)\r\n        //     dropDownItemContent.disable(true);\r\n\r\n        dropDownItemContent.onSelected(() => {\r\n            MultiSelectData.toggle();\r\n            this.filterInput.focus();\r\n        });\r\n        // ------------------------------------------------------------------------------\r\n        \r\n        var setPreventDefaultMultiSelectEvent = (event)=>{\r\n                this.preventDefaultMultiSelectEvent = event;\r\n            }\r\n       \r\n        \r\n        var createSelectedItem = ()=>{\r\n            var selectedItemElement = this.document.createElement('LI');\r\n            MultiSelectData.selectedItemElement = selectedItemElement;\r\n            if (this.MultiSelectDataSelectedTail){\r\n                this.MultiSelectDataSelectedTail.selectedNext = MultiSelectData;\r\n                MultiSelectData.selectedPrev = this.MultiSelectDataSelectedTail;\r\n            }\r\n            this.MultiSelectDataSelectedTail = MultiSelectData;\r\n\r\n            var removeSelectedItem = () => {\r\n                MultiSelectData.option.selected = false;\r\n                MultiSelectData.excludedFromSearch = isOptionDisabled;\r\n                if (isOptionDisabled)\r\n                {\r\n                    setDropDownItemContentDisabled(dropDownItemContent, false);\r\n                    MultiSelectData.toggle = ()=> {};\r\n                }\r\n                else\r\n                {\r\n                    MultiSelectData.toggle = ()=>{\r\n                        createSelectedItem();\r\n                        this.optionsAdapter.triggerChange();\r\n                    };\r\n                }\r\n                dropDownItemContent.select(false);\r\n                removeElement(selectedItemElement);\r\n                MultiSelectData.SelectedItemContent.dispose();\r\n                MultiSelectData.SelectedItemContent=null;\r\n                MultiSelectData.selectedItemElement=null;\r\n\r\n                this.removeSelectedFromList(MultiSelectData);\r\n                this.optionsAdapter.triggerChange();\r\n            }\r\n\r\n            // what is a problem with calling removeSelectedItem directly (not using  setTimeout(removeSelectedItem, 0)):\r\n            // consider situation \"MultiSelect\" on DROPDOWN (that should be closed on the click outside dropdown)\r\n            // therefore we aslo have document's click's handler where we decide to close or leave the DROPDOWN open.\r\n            // because of the event's bubling process removeSelectedItem runs first. \r\n            // that means the event's target element on which we click (the x button) will be removed from the DOM together with badge \r\n            // before we could analize is it belong to our dropdown or not.\r\n            // important 1: we can't just the stop propogation using stopPropogate because click outside dropdown on the similar \r\n            // component that use stopPropogation will not close dropdown (error, dropdown should be closed)\r\n            // important 2: we can't change the dropdown's event handler to leave dropdown open if event's target is null because of\r\n            // the situation described above: click outside dropdown on the same component.\r\n            // Alternatively it could be possible to use stopPropogate but together create custom click event setting new target that belomgs to DOM (e.g. panel)\r\n    \r\n            let removeSelectedItemAndCloseDropDown = () => {\r\n                removeSelectedItem();\r\n                this.resetFilterAndHideDropDown();\r\n            };\r\n        \r\n            let onRemoveSelectedItemEvent = () => {\r\n                setTimeout( () => {  \r\n                    removeSelectedItemAndCloseDropDown();\r\n                }, 0);\r\n            };\r\n\r\n            MultiSelectData.SelectedItemContent = this.selectedItemContent(\r\n                selectedItemElement,\r\n                MultiSelectData.option,\r\n                onRemoveSelectedItemEvent,\r\n                setPreventDefaultMultiSelectEvent);\r\n    \r\n            var disable = (isDisabled) =>\r\n                MultiSelectData.SelectedItemContent.disable(isDisabled);\r\n            disable(this.isComponentDisabled);\r\n\r\n            MultiSelectData.option.selected = true;\r\n            MultiSelectData.excludedFromSearch = true; // all selected excluded from search\r\n            //MultiSelectData.remove  = removeSelectedItemAndCloseDropDown;\r\n            MultiSelectData.disable = disable;\r\n            this.selectedPanel.insertBefore(selectedItemElement, this.filterInputItem);\r\n\r\n\r\n            MultiSelectData.toggle = () => removeSelectedItem();\r\n            dropDownItemContent.select(true);\r\n            \r\n        }\r\n\r\n        \r\n        \r\n        if (isSelected)\r\n        {\r\n            createSelectedItem();\r\n        }\r\n        else\r\n        {\r\n            MultiSelectData.excludedFromSearch =  isOptionDisabled;\r\n            if (isOptionDisabled)\r\n                MultiSelectData.toggle = () => { }\r\n            else\r\n                MultiSelectData.toggle = () =>  {\r\n                    createSelectedItem();\r\n                    this.optionsAdapter.triggerChange();\r\n                }\r\n        }\r\n        MultiSelectData.removeDropDownMenuItemElement = () => {\r\n            removeElement(dropDownMenuItemElement);\r\n            if (MultiSelectData.selectedItemElement!=null)\r\n                removeElement(MultiSelectData.selectedItemElement);\r\n        }\r\n    }\r\n\r\n    keyDownArrowDown() {\r\n        this.keyDownArrow(true);\r\n    }\r\n    keyDownArrowUp() {\r\n        this.keyDownArrow(false);\r\n    }\r\n    keyDownArrow(down) {\r\n        let visibleMultiSelectDataList = this.getVisibleMultiSelectDataList();\r\n        let length = visibleMultiSelectDataList.length;\r\n        let newIndex=null;\r\n        if (length > 0) {\r\n            if (down) {\r\n                let i = this.hoveredMultiSelectDataIndex==null?0:this.hoveredMultiSelectDataIndex+1;\r\n                while(i<length){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i++;\r\n                }\r\n            } else {\r\n                let i = this.hoveredMultiSelectDataIndex==null?length-1:this.hoveredMultiSelectDataIndex-1;\r\n                while(i>=0){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        \r\n        if (newIndex!=null)\r\n        {\r\n            if (this.hoveredMultiSelectData)\r\n                this.styling.HoverOut(this.hoveredMultiSelectData.dropDownMenuItemElement);\r\n            this.updateDropDownLocation(true);\r\n            this.showDropDown(); \r\n            this.hoverInInternal(newIndex);\r\n        }\r\n    }\r\n\r\n    processEmptyInput(){\r\n        this.filterInput.length=\"2ch\";\r\n        resetFilterDropDownMenu(this.MultiSelectDataList);\r\n        this.visibleMultiSelectDataList = null;\r\n    }\r\n\r\n    Update(){\r\n        this.styling.UpdateIsValid(this.stylingComposite, this.optionsAdapter.getIsValid(), this.optionsAdapter.getIsInvalid());\r\n        this.UpdateSize();\r\n        this.UpdateDisabled();\r\n    }\r\n\r\n    UpdateOption(index){\r\n        let multiSelectData = this.MultiSelectDataList[index];\r\n        let option = multiSelectData.option;\r\n        multiSelectData.searchText = option.text.toLowerCase().trim();\r\n        if (multiSelectData.isHidden != option.isHidden)\r\n        {\r\n            multiSelectData.isHidden=option.isHidden;\r\n            if (multiSelectData.isHidden)\r\n                this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), option.isSelected, option.isDisabled);\r\n            else\r\n                multiSelectData.removeDropDownMenuItemElement();\r\n        }\r\n        else \r\n        {\r\n            if (multiSelectData.isSelected != option.isSelected)\r\n            {\r\n                multiSelectData.isSelected=option.isSelected;\r\n                if (multiSelectData.isSelected)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n            if (multiSelectData.isDisabled != option.isDisabled)\r\n            {\r\n                multiSelectData.isDisabled=option.isDisabled;\r\n                if (multiSelectData.isDisabled)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n        }    \r\n        //multiSelectData.updateOption();\r\n    }\r\n\r\n    UpdateData(){\r\n        // close drop down , remove filter and listeners\r\n        this.resetFilterAndHideDropDown();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.removeDropDownMenuItemElement)\r\n                multiSelectData.removeDropDownMenuItemElement();\r\n        }\r\n        this.resetMultiSelectDataList();\r\n\r\n        // reinitiate\r\n        this.updateDataImpl();\r\n    }\r\n\r\n    updateDataImpl(){\r\n        var createDropDownItems = () => {\r\n            let options = this.optionsAdapter.getOptions();\r\n            var j = 0;\r\n            for(let i = 0; i<options.length; i++) {\r\n                let option = options[i];\r\n\r\n                let isDisabled = option.disabled;\r\n                let isHidden   = option.hidden;\r\n                let isSelected = option.selected;\r\n                \r\n                var MultiSelectData = {\r\n                    searchText: option.text.toLowerCase().trim(),\r\n                    excludedFromSearch: isSelected || isDisabled || isHidden,\r\n                    option: option,\r\n                    isHidden: isHidden,\r\n                    dropDownMenuItemElement: null,\r\n                    dropDownItemContent: null,\r\n                    selectedPrev: null,\r\n                    selectedNext: null,\r\n                    visible: false,\r\n                    toggle: null,\r\n                    selectedItemElement: null,\r\n                    remove: null,\r\n                    disable: null,\r\n                    removeDropDownMenuItemElement: null\r\n                };\r\n\r\n                this.MultiSelectDataList.push(MultiSelectData);\r\n                if (!isHidden){\r\n                    MultiSelectData.visible = true;\r\n                    MultiSelectData.visibleIndex=i;\r\n                    this.insertDropDownItem(MultiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n            } \r\n            this.updateDropDownLocation(false);\r\n        }\r\n\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        if (document.readyState != 'loading'){\r\n            createDropDownItems();\r\n        } else {\r\n            var createDropDownItemsHandler = function(){\r\n                createDropDownItems();\r\n                document.removeEventListener(\"DOMContentLoaded\", createDropDownItemsHandler);\r\n            }\r\n            document.addEventListener('DOMContentLoaded', createDropDownItemsHandler); // IE9+\r\n        }\r\n    }\r\n\r\n    Dispose(){\r\n        this.isDisposed = true;\r\n        if (this.onDispose)\r\n            this.onDispose(); // primary used to remove from jQuery tables\r\n        \r\n        // remove event listeners\r\n        // TODO check if open\r\n        this.hideDropDown();\r\n        \r\n        this.selectedPanel.removeEventListener(\"click\", this.selectedPanelClick); // OPEN dropdown\r\n        this.filterInput.removeEventListener('focusin', this.onFilterInputFocusIn);\r\n        this.filterInput.removeEventListener('focusout', this.onFilterInputFocusOut);\r\n        this.filterInput.removeEventListener('keydown', this.onfilterInputKeyDown);\r\n        this.filterInput.removeEventListener('keyup', this.onFilterInputKeyUp);\r\n        this.filterInput.removeEventListener('input', this.onFilterInputInput);\r\n\r\n        this.labelAdapter.dispose();\r\n\r\n        \r\n        if (this.popper) {\r\n            this.popper.destroy();\r\n        }\r\n        \r\n        if (this.optionsAdapter.dispose) {\r\n            this.optionsAdapter.dispose();\r\n        }\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.DisposeDropDownMenuItemElement)\r\n                multiSelectData.DisposeDropDownMenuItemElement();\r\n            \r\n            if (multiSelectData.SelectedItemContent)\r\n                multiSelectData.SelectedItemContent.dispose();\r\n            if (multiSelectData.DropDownItemContent)\r\n                multiSelectData.DropDownItemContent.dispose();\r\n        }\r\n\r\n        // this.resetMultiSelectDataList();\r\n        // this.onFilterInputInput = null;\r\n        // this.onFilterInputKeyUp = null;\r\n        // this.onfilterInputKeyDown = null;\r\n        // this.onFilterInputFocusOut = null;\r\n        // this.onFilterInputFocusIn = null;\r\n        // this.selectedPanelClick = null;\r\n        // this.containerMousedown = null;\r\n        // this.documentMouseup = null;\r\n        // this.documentMouseup2 = null;\r\n        // this.processCandidateToHovered = null;\r\n    }\r\n\r\n    UpdateSize(){\r\n        if (this.styling.UpdateSize)\r\n            this.styling.UpdateSize(this.stylingComposite);\r\n    }\r\n\r\n    UpdateDisabled(){\r\n        let isComponentDisabled = this.optionsAdapter.getDisabled();\r\n        let iterateAll = (isDisabled)=>{\r\n            let i = this.MultiSelectDataSelectedTail;\r\n            while(i){\r\n                i.disable(isDisabled); \r\n                i = i.selectedPrev;\r\n            }\r\n        }\r\n        if (this.isComponentDisabled!==isComponentDisabled){\r\n            if (isComponentDisabled) {\r\n                this.filterInput.style.display = \"none\";\r\n                this.styling.Disable(this.stylingComposite);\r\n                iterateAll(true);\r\n                    \r\n                this.selectedPanel.removeEventListener(\"click\", this.selectedPanelClick);\r\n            } else {\r\n                this.filterInput.style.display = \"inline-block\";\r\n                this.styling.Enable(this.stylingComposite);\r\n                iterateAll(false);\r\n\r\n                this.selectedPanel.addEventListener(\"click\", this.selectedPanelClick);\r\n            }\r\n            this.isComponentDisabled=isComponentDisabled;\r\n        }\r\n    }\r\n    \r\n    resetCandidateToHoveredMultiSelectData(){\r\n        this.candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousemove', this.processCandidateToHovered);\r\n        this.candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousedown', this.processCandidateToHovered);\r\n        this.candidateToHoveredMultiSelectData = null;\r\n    }\r\n\r\n    init() {\r\n        var document = this.document;\r\n        let container = this.optionsAdapter.container;\r\n        this.selectedPanel = document.createElement('UL');\r\n        defSelectedPanelStyleSys(this.selectedPanel.style); \r\n        container.appendChild(this.selectedPanel);\r\n        \r\n        this.filterInputItem = document.createElement('LI');\r\n        this.selectedPanel.appendChild(this.filterInputItem);\r\n        \r\n        this.filterInput = document.createElement('INPUT'); \r\n        this.filterInput.setAttribute(\"type\",\"search\");\r\n        this.filterInput.setAttribute(\"autocomplete\",\"off\");\r\n        \r\n        defFilterInputStyleSys(this.filterInput.style);\r\n        this.filterInputItem.appendChild(this.filterInput);\r\n\r\n        this.dropDownMenu = document.createElement('UL');\r\n        this.dropDownMenu.style.display=\"none\";\r\n        container.appendChild(this.dropDownMenu);\r\n        \r\n        // prevent heavy understandable styling error\r\n        defDropDownMenuStyleSys(this.dropDownMenu.style);\r\n\r\n        // we want to escape the closing of the menu on a user's click inside the container\r\n        this.containerMousedown = () => {\r\n            this.skipFocusout = true;\r\n            this.skipContainerMousedownEvent = event;\r\n        };\r\n        \r\n        this.processCandidateToHovered = () => {\r\n            if (this.hoveredMultiSelectData!=this.candidateToHoveredMultiSelectData)\r\n            {\r\n                this.resetDropDownMenuHover(); \r\n                this.hoverInInternal(this.candidateToHoveredMultiSelectData.visibleIndex);\r\n            }\r\n            this.resetCandidateToHoveredMultiSelectData();\r\n        }\r\n\r\n\r\n        // document.Mouseup used for better realiability\r\n        // TODO : this.containerMousedown , this.documentMouseup and filterInput.focusOut are actual only when menu is open\r\n        this.documentMouseup = () => {\r\n            this.skipFocusout = false;\r\n        }\r\n\r\n        this.documentMouseup2 = event => {\r\n            if (!(container === event.target || container.contains(event.target))) {\r\n                this.resetFilterAndHideDropDown();\r\n            }\r\n        }\r\n\r\n        this.selectedPanelClick = event => {\r\n            if (event.target != this.filterInput)\r\n            {   \r\n                this.filterInput.value='';\r\n                this.filterInput.focus();\r\n            }\r\n            if (this.getVisibleMultiSelectDataList().length > 0 && this.preventDefaultMultiSelectEvent != event) {\r\n                this.updateDropDownLocation(true);\r\n                this.showDropDown();\r\n            }\r\n            this.preventDefaultMultiSelectEvent=null;\r\n        };\r\n\r\n        this.stylingComposite = this.createStylingComposite(container, this.selectedPanel,\r\n            this.filterInputItem, this.filterInput, this.dropDownMenu);\r\n        \r\n        this.styling.Init(this.stylingComposite);\r\n        \r\n        this.labelAdapter.init(this.filterInput); \r\n\r\n        if (this.optionsAdapter.afterContainerFilled)\r\n            this.optionsAdapter.afterContainerFilled();\r\n\r\n        this.popper = new Popper(this.filterInput, this.dropDownMenu, {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: {enabled:false}\r\n                }\r\n        });\r\n        \r\n        this.styling.UpdateIsValid(this.stylingComposite, this.optionsAdapter.getIsValid(), this.optionsAdapter.getIsInvalid());\r\n        \r\n        this.UpdateSize();\r\n        this.UpdateDisabled();\r\n        \r\n        // there was unmotivated stopPropagation call. commented out.\r\n        // $dropDownMenu.click(  event => { \r\n        //    event.stopPropagation();\r\n        // });\r\n\r\n        // possibly not need ???\r\n        // this.dropDownMenu.addEventListener('mouseover', () => \r\n        //      this.resetDropDownMenuHover());\r\n\r\n        this.onFilterInputFocusIn = ()=>{ \r\n            this.styling.FocusIn(this.stylingComposite)}\r\n        this.filterInput.addEventListener('focusin', this.onFilterInputFocusIn);\r\n        \r\n        this.onFilterInputFocusOut = () => {\r\n            if (!this.skipFocusout)\r\n                this.styling.FocusOut(this.stylingComposite)\r\n            }\r\n        this.filterInput.addEventListener('focusout', this.onFilterInputFocusOut);\r\n\r\n        this.onfilterInputKeyDown = (event) => {\r\n                if ([38, 40, 13].indexOf(event.which)>=0 || (event.which == 9 && this.filterInput.value) ) {\r\n                    event.preventDefault(); // for 9 it enables keyup\r\n                }\r\n    \r\n                if (event.which == 38) {\r\n                    this.keyDownArrowUp();\r\n                }\r\n                else if (event.which == 40) {\r\n                    this.keyDownArrowDown();\r\n                }\r\n                else if (event.which == 9  /*tab*/) { // no keydown for this\r\n                    if (!this.filterInput.value) {\r\n                        this.hideDropDown(); // filter is empty, nothing to reset\r\n                    }\r\n                }\r\n                else if (event.which == 8 /*backspace*/) {\r\n                    // NOTE: this will process backspace only if there are no text in the input field\r\n                    // If user will find this inconvinient, we will need to calculate something like this\r\n                    // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n                    if (!this.filterInput.value)\r\n                    { \r\n                        this.removeSelectedTail();\r\n                    }\r\n                }\r\n    \r\n                if ([38, 40, 13, 9].indexOf(event.which)==-1)\r\n                    this.resetDropDownMenuHover();\r\n            }\r\n        this.filterInput.addEventListener('keydown', this.onfilterInputKeyDown);\r\n\r\n        this.onFilterInputKeyUp = (event) => {\r\n            \r\n            if (event.which == 13 || event.which == 9 ) {\r\n                if (this.hoveredMultiSelectData) {\r\n                    this.hoveredMultiSelectData.toggle();\r\n                    this.resetFilterAndHideDropDown();\r\n                } \r\n            }\r\n            else if (event.which == 27) { // escape\r\n                this.resetFilterAndHideDropDown();\r\n            }\r\n            // TODO may be do it on \"space\" (when there is left only one)?\r\n            else {\r\n                let text = this.filterInput.value.trim().toLowerCase();\r\n                let visibleMultiSelectDataList = this.getVisibleMultiSelectDataList();\r\n                if (text && visibleMultiSelectDataList.length == 1)\r\n                {\r\n                    let fullMatchMultiSelectData=  visibleMultiSelectDataList[0];\r\n                    if (fullMatchMultiSelectData.searchText == text)\r\n                    {\r\n                        fullMatchMultiSelectData.toggle();\r\n                        // clear\r\n                        this.filterInput.value = '';\r\n                        this.processEmptyInput();\r\n                        this.resetDropDownMenuHover();\r\n                        this.hideDropDown();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.filterInput.addEventListener('keyup', this.onFilterInputKeyUp);\r\n        \r\n        this.onFilterInputInput = () => {\r\n            \r\n            var filterInput = this.filterInput;\r\n            var filterInputValue = filterInput.value;\r\n            let text = filterInputValue.trim().toLowerCase();\r\n            if (text == '')\r\n                this.processEmptyInput();\r\n            else\r\n            {\r\n                filterInput.style.width = filterInputValue.length*1.3 + 2 + \"ch\";\r\n                this.visibleMultiSelectDataList = filterDropDownMenu(this.MultiSelectDataList, text);\r\n            }\r\n\r\n            this.inShowDropDown = true;\r\n            setTimeout( () => {  \r\n                 this.inShowDropDown = null;\r\n            }, 0)\r\n\r\n            this.resetDropDownMenuHover();\r\n\r\n            if (this.getVisibleMultiSelectDataList().length == 1) {\r\n                this.hoverInInternal(0)\r\n            }\r\n\r\n            if (this.getVisibleMultiSelectDataList().length > 0) {\r\n                this.updateDropDownLocation(true); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n                this.showDropDown();\r\n            } else {\r\n                this.hideDropDown();\r\n            }\r\n        }\r\n\r\n        this.filterInput.addEventListener('input', this.onFilterInputInput);\r\n\r\n        this.updateDataImpl();\r\n    }\r\n}\r\n\r\nexport default MultiSelect;\r\n","function LabelAdapter(label, createInputId){\r\n    var backupedFor = null; // state saved between init and dispose\r\n    return {\r\n        init(filterInput) {\r\n            if (label) {\r\n                backupedFor = label.getAttribute('for');\r\n                var newId = createInputId();\r\n                filterInput.setAttribute('id', newId);\r\n                label.setAttribute('for',newId);\r\n            }\r\n        },\r\n        dispose(){\r\n            if(backupedFor)\r\n                label.setAttribute('for',backupedFor);\r\n        }\r\n    }\r\n}\r\n\r\nexport default LabelAdapter;","function OptionsAdapterJson(container, options, getDisabled, getIsValid, getIsInvalid, trigger) {\r\n    return {\r\n        container,\r\n        getOptions(){return options},\r\n        dispose(){\r\n            while (container.firstChild) container.removeChild(container.firstChild);\r\n        },\r\n        triggerChange(){\r\n            trigger('multiselect:change');\r\n        },\r\n        getDisabled(){\r\n            return getDisabled?getDisabled():false;\r\n        },\r\n        getIsValid(){\r\n            return getIsValid?getIsValid():false;\r\n        },\r\n        getIsInvalid(){\r\n            return getIsInvalid?getIsInvalid():false;\r\n        }\r\n    }\r\n}\r\n\r\nfunction OptionsAdapterElement(selectElement, trigger) {\r\n    selectElement.style.display='none';\r\n    var container = document.createElement('div');\r\n    return {\r\n        container,\r\n        getOptions(){return selectElement.getElementsByTagName('OPTION')},\r\n        dispose(){\r\n            container.parentNode.removeChild(container);\r\n        },\r\n        afterContainerFilled(){\r\n            selectElement.parentNode.insertBefore(container, selectElement.nextSibling);\r\n        },\r\n        triggerChange(){\r\n            trigger('change');\r\n            trigger('multiselect:change');\r\n        },\r\n        getDisabled(){\r\n            return selectElement.disabled;\r\n        },\r\n        getIsValid(){\r\n            return selectElement.classList.contains('is-valid');\r\n        },\r\n        getIsInvalid(){\r\n            return selectElement.classList.contains('is-invalid');\r\n        }\r\n    }\r\n}\r\n\r\nexport {OptionsAdapterJson, OptionsAdapterElement};\r\n","export function ExtendIfUndefined(destination, source) {\r\n    for (var property in source)\r\n        if (destination[property] === undefined)\r\n            destination[property] = source[property];\r\n}\r\n\r\nexport function ExtendIfUndefinedFluent(destination, source) {\r\n    ExtendIfUndefined(destination, source);\r\n    return destination;\r\n}","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst bs4StylingMethodCssDefaults = {\r\n    selectedPanelFocusClass : 'focus',\r\n    selectedPanelDisabledClass: 'disabled',\r\n    dropDownItemDisabledClass: 'disabled'\r\n};\r\n\r\nfunction Bs4StylingMethodCss(configuration){\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssDefaults);\r\n\r\n    return {\r\n        Enable($selectedPanel){\r\n            $selectedPanel.removeClass(configuration.selectedPanelDisabledClass)\r\n        },\r\n    \r\n        Disable($selectedPanel){\r\n            $selectedPanel.addClass(configuration.selectedPanelDisabledClass)\r\n        },\r\n    \r\n        FocusIn($selectedPanel){\r\n            $selectedPanel.addClass(configuration.selectedPanelFocusClass);\r\n        },\r\n    \r\n        FocusOut($selectedPanel){\r\n            $selectedPanel.removeClass(configuration.selectedPanelFocusClass);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Bs4StylingMethodCss;","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst defSelectedPanelStyle = {'margin-bottom': '0', 'height': 'auto'};\r\n\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedPanelDefMinHeight: 'calc(2.25rem + 2px)',\r\n    selectedPanelLgMinHeight:  'calc(2.875rem + 2px)',\r\n    selectedPanelSmMinHeight:  'calc(1.8125rem + 2px)',\r\n    selectedPanelDisabledBackgroundColor: '#e9ecef',\r\n    selectedPanelFocusBorderColor: '#80bdff',\r\n    selectedPanelFocusBoxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)',\r\n    selectedPanelFocusValidBoxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)',\r\n    selectedPanelFocusInvalidBoxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)',\r\n    filterInputColor: '#495057',\r\n    //selectedItemContentDisabledOpacity: '.65'\r\n};\r\n\r\nfunction Bs4StylingMethodJs(configuration){\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n\r\n    return {\r\n        OnInit(composite){\r\n            composite.$selectedPanel.css(defSelectedPanelStyle);\r\n            composite.$filterInput.css(\"color\", configuration.filterInputColor);\r\n        },\r\n    \r\n        UpdateSize($selectedPanel){\r\n            if ($selectedPanel.hasClass(\"form-control-lg\")){\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelLgMinHeight);\r\n            } else if ($selectedPanel.hasClass(\"form-control-sm\")){\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelSmMinHeight);\r\n            } else {\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelDefMinHeight);\r\n            }\r\n        },\r\n    \r\n        Enable($selectedPanel){\r\n            $selectedPanel.css(\"background-color\", \"\")\r\n        },\r\n    \r\n        Disable($selectedPanel){\r\n            $selectedPanel.css(\"background-color\", configuration.selectedPanelDisabledBackgroundColor)\r\n        },\r\n    \r\n        FocusIn($selectedPanel){\r\n            if ($selectedPanel.hasClass(\"is-valid\")){\r\n                $selectedPanel.css(\"box-shadow\", configuration.selectedPanelFocusValidBoxShadow);\r\n            } else if ($selectedPanel.hasClass(\"is-invalid\")){\r\n                $selectedPanel.css(\"box-shadow\", configuration.selectedPanelFocusInvalidBoxShadow);\r\n            } else {\r\n                $selectedPanel\r\n                    .css(\"box-shadow\", configuration.selectedPanelFocusBoxShadow)\r\n                    .css(\"border-color\", configuration.selectedPanelFocusBorderColor);\r\n            }\r\n        },\r\n    \r\n        FocusOut($selectedPanel){\r\n                $selectedPanel.css(\"box-shadow\", \"\" ).css(\"border-color\", \"\")\r\n        },\r\n    }\r\n}\r\n\r\nexport default Bs4StylingMethodJs;","import  { ExtendIfUndefined } from './Tools';\r\n\r\n// Bs4Styling\r\nconst bs4StylingDefaults = {\r\n    containerClass: 'dashboardcode-bsmultiselect',\r\n    dropDownMenuClass: 'dropdown-menu',\r\n    dropDownItemClass:  'px-2',\r\n    dropDownItemHoverClass: 'text-primary bg-light',\r\n    selectedPanelClass: 'form-control',\r\n    selectedItemClass: 'badge',\r\n    removeSelectedItemButtonClass: 'close',\r\n    filterInputItemClass: '',\r\n    filterInputClass: ''\r\n}\r\n\r\nfunction Bs4Styling(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4StylingDefaults);\r\n\r\n    return {\r\n        Init(composite){\r\n            composite.$container.addClass(configuration.containerClass);\r\n            composite.$selectedPanel.addClass(configuration.selectedPanelClass);\r\n            composite.$dropDownMenu.addClass(configuration.dropDownMenuClass);\r\n            composite.$filterInputItem.addClass(configuration.filterInputItemClass);\r\n            composite.$filterInput.addClass(configuration.filterInputClass);\r\n            if (stylingMethod.OnInit)\r\n                stylingMethod.OnInit(composite)\r\n        },\r\n\r\n        UpdateIsValid(composite, isValid, isInvalid){\r\n            if (isValid)\r\n                composite.$selectedPanel.addClass('is-valid');\r\n\r\n            if (isInvalid)\r\n                composite.$selectedPanel.addClass('is-invalid');\r\n        },\r\n\r\n        UpdateSize(composite){\r\n            if(stylingMethod.UpdateSize)\r\n               stylingMethod.UpdateSize(composite.$selectedPanel)\r\n        },\r\n\r\n        Enable(composite){\r\n            stylingMethod.Enable(composite.$selectedPanel)\r\n        },\r\n\r\n        Disable(composite){\r\n            stylingMethod.Disable(composite.$selectedPanel)\r\n        },\r\n\r\n        FocusIn(composite){\r\n            stylingMethod.FocusIn(composite.$selectedPanel)\r\n        },\r\n\r\n        FocusOut(composite){\r\n            stylingMethod.FocusOut(composite.$selectedPanel)\r\n        },\r\n\r\n        HoverIn(dropDownItem){\r\n            $(dropDownItem).addClass(configuration.dropDownItemHoverClass);\r\n        },\r\n\r\n        HoverOut(dropDownItem){\r\n            $(dropDownItem).removeClass(configuration.dropDownItemHoverClass);\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nexport default Bs4Styling;","function AddToJQueryPrototype(pluginName, createPlugin, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    const firstCharLower = firstChar.toLowerCase();\r\n    if (firstCharLower == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstCharLower + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance for 1st $selected item\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n}\r\n\r\nexport default AddToJQueryPrototype;","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst bs4StylingMethodCssdefaults = {\r\n    selectedItemContentDisabledClass: 'disabled'\r\n};\r\n\r\nfunction Bs4SelectedItemContentStylingMethodCss(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssdefaults);\r\n\r\n    return {\r\n        disableSelectedItemContent($content){\r\n            $content.addClass(configuration.selectedItemContentDisabledClass )\r\n        }\r\n    }\r\n}\r\n\r\nconst defSelectedItemStyle = {'padding-left': '0px', 'line-height': '1.5em'};\r\nconst defRemoveSelectedItemButtonStyle = {'font-size':'1.5em', 'line-height': '.9em'};\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedItemContentDisabledOpacity: '.65'\r\n };\r\n\r\nfunction Bs4SelectedItemContentStylingMethodJs(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n    return {\r\n        disableSelectedItemContent($content){\r\n            $content.css(\"opacity\", configuration.selectedItemContentDisabledOpacity )\r\n        },\r\n    \r\n        createSelectedItemContent($selectedItem, $button){\r\n            $selectedItem.css(defSelectedItemStyle);\r\n            if ($button)\r\n                $button.css(defRemoveSelectedItemButtonStyle);\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4SelectedItemContentDefaults = {\r\n    selectedItemClass: 'badge',\r\n    removeSelectedItemButtonClass: 'close'\r\n};\r\nfunction Bs4SelectedItemContent(stylingMethod, configuration, $) {\r\n        ExtendIfUndefined(configuration, bs4SelectedItemContentDefaults);\r\n        \r\n        return function (selectedItem, optionItem, removeSelectedItem, preventDefaultMultiSelect){\r\n                let $selectedItem = $(selectedItem)\r\n                $selectedItem.addClass(configuration.selectedItemClass);\r\n                let $content = $(`<span/>`).text(optionItem.text);\r\n                $content.appendTo($selectedItem);\r\n                if (optionItem.disabled)\r\n                    stylingMethod.disableSelectedItemContent($content);\r\n                let $button = $('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n                    // bs 'close' class that will be added to button set the float:right, therefore it impossible to configure no-warp policy \r\n                    // with .css(\"white-space\", \"nowrap\") or  .css(\"display\", \"inline-block\"); TODO: migrate to flex? \r\n                    .css(\"float\", \"none\").appendTo($selectedItem)\r\n                    .addClass(configuration.removeSelectedItemButtonClass) // bs close class set the float:right\r\n                    .on(\"click\", (jqEvent) => \r\n                        {   \r\n                            removeSelectedItem(); \r\n                            preventDefaultMultiSelect(jqEvent.originalEvent);\r\n                        });\r\n                \r\n                if (stylingMethod.createSelectedItemContent)\r\n                    stylingMethod.createSelectedItemContent($selectedItem, $button);\r\n                return {\r\n                    disable(isDisabled){ \r\n                        $button.prop('disabled', isDisabled); \r\n                    },\r\n                    dispose(){\r\n                        $button.unbind();\r\n                    }\r\n                };\r\n            }\r\n}\r\n\r\nexport { Bs4SelectedItemContent as Bs4SelectedItemContent, Bs4SelectedItemContentStylingMethodJs, Bs4SelectedItemContentStylingMethodCss};","import  { ExtendIfUndefined} from './Tools';\r\n\r\nconst bs4StylingMethodCssDefaults = {\r\n    selectedItemContentDisabledClass: 'disabled',\r\n};\r\n\r\nfunction Bs4DropDownItemContentStylingMethodCss(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssDefaults);\r\n    return {\r\n        disabledStyle($checkBox, $checkBoxLabel, isDisbaled){\r\n            if (isDisbaled) \r\n                $checkBox.addClass(configuration.dropDownItemDisabledClass);\r\n            else\r\n                $checkBox.removeClass(configuration.dropDownItemDisabledClass);\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedItemContentDisabledOpacity: '.65',\r\n    dropdDownLabelDisabledColor: '#6c757d'\r\n};\r\n\r\nfunction Bs4DropDownItemContentStylingMethodJs(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n    return{\r\n        disabledStyle($checkBox, $checkBoxLabel, isDisbaled){\r\n            $checkBoxLabel.css('color', isDisbaled?configuration.dropdDownLabelDisabledColor:'')\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4DropDownItemContentDefaults = {\r\n    dropDownItemClass:  'px-2',\r\n}\r\n\r\nfunction Bs4DropDownItemContent(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4DropDownItemContentDefaults);\r\n    return function(dropDownItem, option){\r\n        let $dropDownItem = $(dropDownItem);\r\n        $dropDownItem.addClass(configuration.dropDownItemClass);\r\n        let $dropDownItemContent= $(`<div class=\"custom-control custom-checkbox\">\r\n            <input type=\"checkbox\" class=\"custom-control-input\">\r\n            <label class=\"custom-control-label\"></label>\r\n        </div>`);\r\n        $dropDownItemContent.appendTo(dropDownItem);\r\n        let $checkBox = $dropDownItemContent.find(`INPUT[type=\"checkbox\"]`);\r\n        let $checkBoxLabel = $dropDownItemContent.find(`label`);\r\n        $checkBoxLabel.text(option.text);\r\n\r\n        var tmp = { \r\n            select(isSelected){ $checkBox.prop('checked', isSelected); }, \r\n            // --- distinct disable and disabledStyle to provide a possibility to unselect disabled option\r\n            disable(isDisabled){ $checkBox.prop('disabled', isDisabled); },\r\n            disabledStyle(isDisbaled){ stylingMethod.disabledStyle($checkBox, $checkBoxLabel, isDisbaled); },\r\n\r\n            onSelected(toggle) {\r\n                $checkBox.on(\"change\", toggle)\r\n                $dropDownItem.on(\"click\", event => {\r\n                    if (dropDownItem === event.target || $.contains(dropDownItem, event.target)) {\r\n                        toggle();\r\n                    }\r\n                })\r\n            },\r\n            dispose(){\r\n                $checkBox.unbind();\r\n                $dropDownItem.unbind();\r\n            }\r\n        }\r\n        \r\n        return tmp;\r\n    }\r\n}\r\n\r\nexport { Bs4DropDownItemContent, Bs4DropDownItemContentStylingMethodJs, Bs4DropDownItemContentStylingMethodCss };","import $ from 'jquery'\r\n\r\nimport MultiSelect from './MultiSelect'\r\nimport LabelAdapter from './LabelAdapter';\r\nimport {OptionsAdapterJson,OptionsAdapterElement} from './OptionsAdapters';\r\n\r\nimport Bs4StylingMethodCss from './Bs4StylingMethodCss'\r\nimport Bs4StylingMethodJs from './Bs4StylingMethodJs'\r\nimport Bs4Styling from './Bs4Styling';\r\nimport AddToJQueryPrototype from './AddToJQueryPrototype'\r\n\r\nimport { Bs4SelectedItemContent, Bs4SelectedItemContentStylingMethodJs, Bs4SelectedItemContentStylingMethodCss} from './Bs4SelectedItemContent';\r\nimport { Bs4DropDownItemContent, Bs4DropDownItemContentStylingMethodJs, Bs4DropDownItemContentStylingMethodCss} from './Bs4DropDownItemContent';\r\n\r\n(\r\n    (window, $) => {\r\n        AddToJQueryPrototype('BsMultiSelect',\r\n            (element, settings, onDispose) => {\r\n                let configuration = $.extend({}, settings); // settings used per jQuery intialization, configuration per element\r\n                if (configuration.preBuildConfiguration)\r\n                    configuration.preBuildConfiguration(element, configuration);\r\n                \r\n                var $element= $(element);\r\n                let optionsAdapter = null;\r\n                if (configuration.optionsAdapter)\r\n                    optionsAdapter = configuration.optionsAdapter;\r\n                else\r\n                {\r\n                    var trigger = function(eventName){\r\n                        $element.trigger(eventName);\r\n                    }\r\n                    if (configuration.options){\r\n                        optionsAdapter = OptionsAdapterJson(\r\n                            element,\r\n                            configuration.options,\r\n                            configuration.getDisabled,\r\n                            configuration.getIsValid,\r\n                            configuration.getIsInvalid,\r\n                            trigger );\r\n                        if (!configuration.createInputId)\r\n                            configuration.createInputId=()=>`${configuration.containerClass}-generated-filter-${element.id}`;\r\n            \r\n                    }else {\r\n                        if (!configuration.label)\r\n                        {\r\n                            let $formGroup = $(element).closest('.form-group');\r\n                            if ($formGroup.length == 1) {\r\n                                let $label = $formGroup.find(`label[for=\"${element.id}\"]`);\r\n                                if ($label.length>0)\r\n                                {   \r\n                                    let label = $label.get(0);\r\n                                    let forId = label.getAttribute('for');\r\n                                    if (forId == element.id) {\r\n                                        configuration.label = label;\r\n                                    }\r\n                                }   \r\n                            }\r\n                        }\r\n                        optionsAdapter = OptionsAdapterElement(element, trigger);\r\n                        if (!configuration.createInputId)\r\n                            configuration.createInputId=()=>`${configuration.containerClass}-generated-input-${((element.id)?element.id:element.name).toLowerCase()}-id`;\r\n                    }\r\n                }\r\n\r\n                let labelAdapter = LabelAdapter(configuration.label, configuration.createInputId);\r\n\r\n                let useCss = configuration.useCss;\r\n                let styling = configuration.styling;\r\n                if (!configuration.adapter)\r\n                {\r\n                    let stylingMethod = configuration.stylingMethod;\r\n                    if (!stylingMethod)\r\n                    {\r\n                        if (useCss)\r\n                            stylingMethod = Bs4StylingMethodCss(configuration);\r\n                        else\r\n                            stylingMethod = Bs4StylingMethodJs(configuration);\r\n                    }\r\n                    styling = Bs4Styling(stylingMethod, configuration, $);\r\n                }\r\n\r\n                let selectedItemContent = configuration.selectedItemContent;\r\n                if (!selectedItemContent){\r\n                    let selectedItemContentStylingMethod = configuration.selectedItemContentStylingMethod;\r\n                    if (!selectedItemContentStylingMethod)\r\n                    {\r\n                        if (useCss)\r\n                            selectedItemContentStylingMethod=Bs4SelectedItemContentStylingMethodCss(configuration, $);\r\n                        else\r\n                            selectedItemContentStylingMethod=Bs4SelectedItemContentStylingMethodJs(configuration, $);\r\n                    }\r\n                    selectedItemContent = Bs4SelectedItemContent(selectedItemContentStylingMethod, configuration, $);\r\n                }\r\n\r\n                let dropDownItemContent = configuration.bs4DropDownItemContent;\r\n                if (!dropDownItemContent){\r\n                    let dropDownItemContentStylingMethod = configuration.dropDownItemContentStylingMethod;\r\n                    if (useCss)\r\n                        dropDownItemContentStylingMethod=Bs4DropDownItemContentStylingMethodCss(configuration, $);\r\n                    else\r\n                        dropDownItemContentStylingMethod=Bs4DropDownItemContentStylingMethodJs(configuration, $);\r\n                    dropDownItemContent = Bs4DropDownItemContent(dropDownItemContentStylingMethod, configuration, $)\r\n                }\r\n\r\n                let createStylingComposite = function(container, selectedPanel, filterInputItem, filterInput, dropDownMenu){\r\n                    return {\r\n                        $container:$(container),\r\n                        $selectedPanel:$(selectedPanel),\r\n                        $filterInputItem:$(filterInputItem),\r\n                        $filterInput:$(filterInput),\r\n                        $dropDownMenu:$(dropDownMenu)\r\n                    };\r\n                }\r\n\r\n                let multiSelect = new MultiSelect(\r\n                    optionsAdapter,\r\n                    styling,\r\n                    selectedItemContent,\r\n                    dropDownItemContent,\r\n                    labelAdapter,\r\n                    createStylingComposite,\r\n                    configuration,\r\n                    onDispose,\r\n                    window);\r\n\r\n                if (configuration.postBuildConfiguration)\r\n                    configuration.postBuildConfiguration(element, multiSelect);\r\n                \r\n                multiSelect.init();\r\n                return multiSelect;\r\n            }, $);\r\n    }\r\n)(window, $)\r\n"],"names":["defSelectedPanelStyleSys","s","display","flexWrap","listStyleType","defFilterInputStyleSys","width","border","padding","outline","backgroundColor","defDropDownMenuStyleSys","removeElement","e","parentNode","removeChild","filterMultiSelectData","MultiSelectData","isFiltered","visibleIndex","visible","dropDownMenuItemElement","style","resetFilterDropDownMenu","MultiSelectDataList","i","length","multiSelectData","isHidden","filterDropDownMenu","text","list","j","excludedFromSearch","searchText","indexOf","push","MultiSelect","optionsAdapter","styling","selectedItemContent","dropDownItemContent","labelAdapter","createStylingComposite","configuration","onDispose","window","Popper","TypeError","container","isDisposed","document","popper","visibleCount","selectedPanel","filterInputItem","filterInput","dropDownMenu","stylingComposite","selectedPanelClick","documentMouseup","containerMousedown","documentMouseup2","isComponentDisabled","filterInputItemOffsetLeft","resetMultiSelectDataList","skipFocusout","hoveredMultiSelectData","hoveredMultiSelectDataIndex","MultiSelectDataSelectedTail","visibleMultiSelectDataList","getVisibleMultiSelectDataList","removeSelectedTail","toggle","updateDropDownLocation","force","offsetLeft","update","hideDropDown","candidateToHoveredMultiSelectData","resetCandidateToHoveredMultiSelectData","console","log","removeEventListener","showDropDown","inShowDropDown","setTimeout","addEventListener","hoverInInternal","index","HoverIn","resetDropDownMenuHover","HoverOut","resetFilterAndHideDropDown","value","processEmptyInput","removeSelectedFromList","selectedPrev","selectedNext","insertDropDownItem","insertToDropDownMenu","isSelected","isOptionDisabled","createElement","onDropDownMenuItemElementMouseover","processCandidateToHovered","onDropDownMenuItemElementMouseleave","option","DropDownItemContent","DisposeDropDownMenuItemElement","setDropDownItemContentDisabled","disabledStyle","disable","onSelected","focus","setPreventDefaultMultiSelectEvent","event","preventDefaultMultiSelectEvent","createSelectedItem","selectedItemElement","removeSelectedItem","selected","triggerChange","select","SelectedItemContent","dispose","removeSelectedItemAndCloseDropDown","onRemoveSelectedItemEvent","isDisabled","insertBefore","removeDropDownMenuItemElement","keyDownArrowDown","keyDownArrow","keyDownArrowUp","down","newIndex","Update","UpdateIsValid","getIsValid","getIsInvalid","UpdateSize","UpdateDisabled","UpdateOption","toLowerCase","trim","appendChild","UpdateData","updateDataImpl","createDropDownItems","options","getOptions","disabled","hidden","remove","readyState","createDropDownItemsHandler","Dispose","onFilterInputFocusIn","onFilterInputFocusOut","onfilterInputKeyDown","onFilterInputKeyUp","onFilterInputInput","destroy","getDisabled","iterateAll","Disable","Enable","init","setAttribute","skipContainerMousedownEvent","target","contains","Init","afterContainerFilled","placement","modifiers","preventOverflow","enabled","hide","flip","FocusIn","FocusOut","which","preventDefault","fullMatchMultiSelectData","filterInputValue","LabelAdapter","label","createInputId","backupedFor","getAttribute","newId","OptionsAdapterJson","trigger","firstChild","OptionsAdapterElement","selectElement","getElementsByTagName","nextSibling","classList","ExtendIfUndefined","destination","source","property","undefined","bs4StylingMethodCssDefaults","selectedPanelFocusClass","selectedPanelDisabledClass","dropDownItemDisabledClass","Bs4StylingMethodCss","$selectedPanel","removeClass","addClass","defSelectedPanelStyle","bs4StylingMethodJsDefaults","selectedPanelDefMinHeight","selectedPanelLgMinHeight","selectedPanelSmMinHeight","selectedPanelDisabledBackgroundColor","selectedPanelFocusBorderColor","selectedPanelFocusBoxShadow","selectedPanelFocusValidBoxShadow","selectedPanelFocusInvalidBoxShadow","filterInputColor","Bs4StylingMethodJs","OnInit","composite","css","$filterInput","hasClass","bs4StylingDefaults","containerClass","dropDownMenuClass","dropDownItemClass","dropDownItemHoverClass","selectedPanelClass","selectedItemClass","removeSelectedItemButtonClass","filterInputItemClass","filterInputClass","Bs4Styling","stylingMethod","$","$container","$dropDownMenu","$filterInputItem","isValid","isInvalid","dropDownItem","AddToJQueryPrototype","pluginName","createPlugin","firstChar","charAt","firstCharLower","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","each","$e","instance","data","isMethodName","test","optionsObject","removeData","methodName","noConflict","bs4StylingMethodCssdefaults","selectedItemContentDisabledClass","Bs4SelectedItemContentStylingMethodCss","disableSelectedItemContent","$content","defSelectedItemStyle","defRemoveSelectedItemButtonStyle","selectedItemContentDisabledOpacity","Bs4SelectedItemContentStylingMethodJs","createSelectedItemContent","$selectedItem","$button","bs4SelectedItemContentDefaults","Bs4SelectedItemContent","selectedItem","optionItem","preventDefaultMultiSelect","appendTo","on","jqEvent","originalEvent","prop","unbind","Bs4DropDownItemContentStylingMethodCss","$checkBox","$checkBoxLabel","isDisbaled","dropdDownLabelDisabledColor","Bs4DropDownItemContentStylingMethodJs","bs4DropDownItemContentDefaults","Bs4DropDownItemContent","$dropDownItem","$dropDownItemContent","find","tmp","element","settings","extend","preBuildConfiguration","$element","eventName","id","$formGroup","closest","$label","get","forId","name","useCss","adapter","selectedItemContentStylingMethod","bs4DropDownItemContent","dropDownItemContentStylingMethod","multiSelect","postBuildConfiguration"],"mappings":"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"}