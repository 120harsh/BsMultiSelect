{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/JsTools.js","../../js/src/DomTools.js","../../js/src/FilterPanel.js","../../js/src/ChoicesPanel.js","../../js/src/PicksPanel.js","../../js/src/MultiSelectInputAspect.js","../../js/src/PlaceholderAspect.js","../../js/src/EventSkipper.js","../../js/src/MultiSelect.js","../../js/src/LabelAdapter.js","../../js/src/AddToJQueryPrototype.js","../../js/src/OptionsAdapters.js","../../js/src/StylingCorrector.js","../../js/src/Styling.js","../../js/src/BsPickContentGenerator.js","../../js/src/BsChoiceContentGenerator.js","../../js/src/ContainerAdapter.js","../../js/src/BsAppearance.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["export function extendIfUndefined(destination, source) {\r\n    for (var property in source)\r\n        if (destination[property] === undefined)\r\n            destination[property] = source[property];\r\n}\r\n\r\nexport function createEmpty(source, value) {\r\n    var destination={};\r\n    for (var property in source)\r\n         destination[property] = value;\r\n    return destination;\r\n}","export function removeElement(e) {e.parentNode.removeChild(e)}\r\n\r\nexport function findDirectChildByTagName(element, tagName){\r\n    var returnValue = null;\r\n    for (var i = 0; i<element.children.length; i++)\r\n    {\r\n        let tmp = element.children[i];\r\n        if (tmp.tagName==tagName)\r\n        {\r\n            returnValue = tmp;\r\n            break;\r\n        }\r\n    }\r\n    return returnValue;\r\n}\r\n\r\nexport function addClass(element, c){\r\n    element.classList.add(c);\r\n}\r\n\r\nexport function removeClass(element, c){\r\n    element.classList.remove(c);\r\n}\r\n\r\nexport function addClasses(element, classes){\r\n    modifyClasses(classes, e=>addClass(element,e))\r\n}\r\n\r\nexport function removeClasses(element, classes){\r\n    modifyClasses(classes, e=>removeClass(element,e))\r\n}\r\n\r\nexport function setStyles(element, styles){\r\n    for (var property in styles)\r\n        element.style[property] = styles[property];\r\n}\r\n\r\n\r\nfunction modifyClasses(classes, modify){\r\n    if (classes){\r\n        if (Array.isArray(classes))\r\n            classes.forEach(e => modify(e))\r\n        else{\r\n            var array = classes.split(\" \");\r\n            array.forEach(e => modify(e))\r\n        }\r\n    }\r\n}","import {setStyles} from './DomTools';\r\n\r\nconst filterInputStyle = {border:'0px', padding:'0px', outline:'none', backgroundColor:'transparent' };\r\n\r\nexport function FilterPanel(\r\n        createElement,\r\n        insertIntoDom,\r\n        onFocusIn,  // show dropdown\r\n        onFocusOut, // hide dropdown\r\n        onKeyDownArrowUp, \r\n        onKeyDownArrowDown,\r\n        onTabForEmpty,  // tab on empty\r\n        onBackspace, // backspace alike\r\n        onEnterOrTabToCompleate, // \"compleate alike\"\r\n        onKeyDownEsc, \r\n        onKeyUpEsc, // \"esc\" alike\r\n        onInput, // filter\r\n        setEmptyLength\r\n    ) {\r\n    \r\n    var filterInputElement = createElement('INPUT'); \r\n    \r\n    filterInputElement.setAttribute(\"type\",\"search\");\r\n    filterInputElement.setAttribute(\"autocomplete\",\"off\");\r\n\r\n    setStyles(filterInputElement, filterInputStyle);\r\n\r\n    insertIntoDom(filterInputElement);\r\n\r\n    var onfilterInputKeyDown = (event) => {\r\n        if ([38, 40, 13 ,27].indexOf(event.which)>=0 \r\n            || (event.which == 9 && filterInputElement.value) ) {\r\n            event.preventDefault(); \r\n            // preventDefault for tab(9) it enables keyup,\r\n            // prevent form default button (13-enter) \r\n            // but doesn't help with bootsrap modal ESC or ENTER (close behaviour);\r\n            // esc(27) there is just in case\r\n        }\r\n        if (event.which == 27 ) {\r\n            onKeyDownEsc(filterInputElement.value?false:true, event); // support BS do not close modal - event.stopPropagation inside\r\n        }\r\n        else if (event.which == 38) {\r\n            onKeyDownArrowUp();\r\n        }\r\n        else if (event.which == 40) {\r\n            onKeyDownArrowDown();\r\n        }\r\n        else if (event.which == 9  /*tab*/) { // no keydown for this\r\n            if (!filterInputElement.value) {\r\n                 onTabForEmpty(); // filter is empty, nothing to reset\r\n            }\r\n        }\r\n        else if (event.which == 8 /*backspace*/) {\r\n            // NOTE: this will process backspace only if there are no text in the input field\r\n            // If user will find this inconvinient, we will need to calculate something like this\r\n            // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n            if (!filterInputElement.value)\r\n            { \r\n                onBackspace();\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n    \r\n    var onFilterInputKeyUp = (event) => {\r\n        if (event.which == 13 || event.which == 9) {\r\n            onEnterOrTabToCompleate();\r\n        }\r\n        else if (event.which == 27) { // escape\r\n            onKeyUpEsc(); // is it always empty (bs x can still it) \r\n        }\r\n    }\r\n    \r\n    // it can be initated by 3PP functionality\r\n    // sample (1) BS functionality - input x button click - clears input\r\n    // sample (2) BS functionality - esc keydown - clears input\r\n    // and there could be difference in processing: (2) should hide the menu, then reset , when (1) should just reset without hiding.\r\n    var onFilterInputInput = () => {\r\n        var filterInputValue = filterInputElement.value;\r\n        onInput(\r\n            filterInputValue, \r\n            ()=> filterInputElement.style.width = filterInputValue.length*1.3 + 2 + \"ch\"\r\n        );\r\n    }\r\n    \r\n    filterInputElement.addEventListener('focusin', onFocusIn);\r\n    filterInputElement.addEventListener('focusout', onFocusOut);\r\n    filterInputElement.addEventListener('keydown', onfilterInputKeyDown);    \r\n    filterInputElement.addEventListener('keyup', onFilterInputKeyUp);\r\n    filterInputElement.addEventListener('input', onFilterInputInput);\r\n\r\n    // function setEmptyLength(){\r\n    //     inputElement.style.width= \"100%\"; //--\"1rem\";\r\n    // }\r\n    //setEmptyLength();\r\n\r\n    function setEmpty(){\r\n        filterInputElement.value ='';\r\n        setEmptyLength();\r\n    };\r\n    \r\n    return {\r\n        filterInputElement,\r\n        isEmpty(){\r\n            return filterInputElement.value ? false:true;\r\n        },\r\n        setEmpty,\r\n        setEmptyLength,\r\n        setFocus(){\r\n            filterInputElement.focus();\r\n        },\r\n        isEventTarget(event){\r\n            return event.target == filterInputElement;\r\n        },\r\n        dispose(){\r\n            filterInputElement.removeEventListener('focusin', onFocusIn);\r\n            filterInputElement.removeEventListener('focusout', onFocusOut);\r\n            filterInputElement.removeEventListener('keydown', onfilterInputKeyDown);\r\n            filterInputElement.removeEventListener('keyup', onFilterInputKeyUp);\r\n            filterInputElement.removeEventListener('input', onFilterInputInput);\r\n        }\r\n    }\r\n}","import {setStyles} from './DomTools';\r\n\r\nconst choicesStyle = {listStyleType:'none'}; // remove bullets since this is ul\r\n\r\nexport function ChoicesPanel(createElement, choicesElement, onShow, onHide, eventSkipper, dropDownItemContent, \r\n        getVisibleMultiSelectDataList, resetFilter, updateDropDownLocation, filterPanelSetFocus) {\r\n    \r\n    // prevent heavy understandable styling error\r\n    setStyles(choicesElement, choicesStyle);\r\n    var hoveredMultiSelectData=null;\r\n    var hoveredMultiSelectDataIndex = null;\r\n    var candidateToHoveredMultiSelectData=null;\r\n\r\n    function hideDropDown() {\r\n        if (candidateToHoveredMultiSelectData){\r\n            resetCandidateToHoveredMultiSelectData();\r\n        }\r\n        if (choicesElement.style.display != 'none')\r\n        {\r\n            choicesElement.style.display = 'none';\r\n            onHide();\r\n        }\r\n    }\r\n\r\n    function showDropDown() {\r\n        if (choicesElement.style.display != 'block')\r\n        {\r\n            eventSkipper.setSkippable();\r\n            choicesElement.style.display = 'block';\r\n            onShow();\r\n        }\r\n    }\r\n\r\n    var hoverInInternal = function(index){\r\n        hoveredMultiSelectDataIndex = index;\r\n        hoveredMultiSelectData = getVisibleMultiSelectDataList()[index];\r\n        hoveredMultiSelectData.DropDownItemContent.hoverIn()\r\n    }\r\n\r\n    function resetDropDownMenuHover() {\r\n        if (hoveredMultiSelectData) {\r\n            hoveredMultiSelectData.DropDownItemContent.hoverOut()\r\n            hoveredMultiSelectData = null;\r\n            hoveredMultiSelectDataIndex = null;\r\n        }\r\n    }\r\n\r\n    var resetCandidateToHoveredMultiSelectData = function(){\r\n        candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousemove', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousedown', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData = null;\r\n    }\r\n\r\n    var processCandidateToHovered = function() {\r\n        if (hoveredMultiSelectData != candidateToHoveredMultiSelectData)\r\n        {\r\n            resetDropDownMenuHover(); \r\n            hoverInInternal(candidateToHoveredMultiSelectData.visibleIndex);\r\n        }\r\n        if(candidateToHoveredMultiSelectData) \r\n            resetCandidateToHoveredMultiSelectData();\r\n    }\r\n\r\n    function toggleHovered(){\r\n        if (hoveredMultiSelectData) {\r\n            hoveredMultiSelectData.toggle();\r\n            resetDropDownMenuHover();\r\n            hideDropDown(); // always hide 1st\r\n            resetFilter();\r\n        } \r\n    }\r\n\r\n    function keyDownArrow(down) {\r\n        let visibleMultiSelectDataList = getVisibleMultiSelectDataList();\r\n        let length = visibleMultiSelectDataList.length;\r\n        let newIndex=null;\r\n        if (length > 0) {\r\n            if (down) {\r\n                let i = hoveredMultiSelectDataIndex==null?0:hoveredMultiSelectDataIndex+1;\r\n                while(i<length){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i++;\r\n                }\r\n            } else {\r\n                let i = hoveredMultiSelectDataIndex==null?length-1:hoveredMultiSelectDataIndex-1;\r\n                while(i>=0){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        \r\n        if (newIndex!=null)\r\n        {\r\n            if (hoveredMultiSelectData)\r\n                hoveredMultiSelectData.DropDownItemContent.hoverOut()\r\n                //styling.HoverOut(hoveredMultiSelectData.dropDownMenuItemElement);\r\n            updateDropDownLocation();\r\n            showDropDown(); \r\n            hoverInInternal(newIndex);\r\n        }\r\n    }\r\n\r\n    var onDropDownMenuItemElementMouseoverGeneral = function(MultiSelectData, dropDownMenuItemElement)\r\n    {\r\n        if (eventSkipper.isSkippable())\r\n        {\r\n            if(candidateToHoveredMultiSelectData)\r\n                resetCandidateToHoveredMultiSelectData()\r\n\r\n            candidateToHoveredMultiSelectData = MultiSelectData;\r\n            dropDownMenuItemElement.addEventListener('mousemove', processCandidateToHovered);\r\n            dropDownMenuItemElement.addEventListener('mousedown', processCandidateToHovered);\r\n        }\r\n        else\r\n        {\r\n            if (hoveredMultiSelectData!=MultiSelectData)\r\n            {\r\n                // mouseleave is not enough to guarantee remove hover styles in situations\r\n                // when style was setuped without mouse (keyboard arrows)\r\n                // therefore force reset manually\r\n                resetDropDownMenuHover(); \r\n                hoverInInternal(MultiSelectData.visibleIndex);\r\n            }                \r\n        }\r\n    }\r\n\r\n    function insertDropDownItem(MultiSelectData, createSelectedItemGen, setSelected, triggerChange, isSelected, isOptionDisabled) {\r\n        var dropDownMenuItemElement = createElement('LI');\r\n        \r\n        // in chrome it happens on \"become visible\" so we need to skip it, \r\n        // for IE11 and edge it doesn't happens, but for IE11 and Edge it doesn't happens on small \r\n        // mouse moves inside the item. \r\n        // https://stackoverflow.com/questions/59022563/browser-events-mouseover-doesnt-happen-when-you-make-element-visible-and-mous\r\n        \r\n        var onDropDownMenuItemElementMouseover = () => onDropDownMenuItemElementMouseoverGeneral(\r\n            MultiSelectData,\r\n            dropDownMenuItemElement\r\n        )\r\n\r\n        dropDownMenuItemElement.addEventListener('mouseover', onDropDownMenuItemElementMouseover);\r\n        \r\n        // note 1: mouseleave preferred to mouseout - which fires on each descendant\r\n        // note 2: since I want add aditional info panels to the dropdown put mouseleave on dropdwon would not work\r\n        var onDropDownMenuItemElementMouseleave = () => {\r\n            if (!eventSkipper.isSkippable()) {\r\n                resetDropDownMenuHover();\r\n            }\r\n        }\r\n\r\n        dropDownMenuItemElement.addEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n\r\n        choicesElement.appendChild(dropDownMenuItemElement);\r\n\r\n        let content = dropDownItemContent(dropDownMenuItemElement, MultiSelectData.option); \r\n        MultiSelectData.dropDownMenuItemElement = dropDownMenuItemElement;\r\n        MultiSelectData.DropDownItemContent = content;\r\n\r\n        MultiSelectData.DisposeDropDownMenuItemElement = ()=> {\r\n            dropDownMenuItemElement.removeEventListener('mouseover',  onDropDownMenuItemElementMouseover);\r\n            dropDownMenuItemElement.removeEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n        }\r\n\r\n        var setDropDownItemContentDisabled = (content,  isSelected) => {\r\n            content.disabledStyle(true);\r\n            // do not desable if selected! there should be possibility to unselect \"disabled\"\r\n            content.disable(!isSelected);\r\n        }\r\n\r\n        if (isOptionDisabled)\r\n            setDropDownItemContentDisabled(content, isSelected )\r\n\r\n        content.onSelected( () => {\r\n            MultiSelectData.toggle();\r\n            filterPanelSetFocus();\r\n        });\r\n        // ------------------------------------------------------------------------------\r\n        \r\n        var createSelectedItem = () => createSelectedItemGen(\r\n            MultiSelectData,\r\n            isOptionDisabled,\r\n            () => setDropDownItemContentDisabled(content, false)\r\n        );\r\n        \r\n        if (isSelected)\r\n        {\r\n            createSelectedItem();\r\n        }\r\n        else\r\n        {\r\n            MultiSelectData.excludedFromSearch =  isOptionDisabled;\r\n            if (isOptionDisabled)\r\n                MultiSelectData.toggle = () => { }\r\n            else\r\n                MultiSelectData.toggle = () =>  {\r\n                    var confirmed = setSelected(MultiSelectData.option, true);\r\n                    if (confirmed==null || confirmed) {\r\n                        createSelectedItem();\r\n                        triggerChange();\r\n                    }\r\n                }\r\n        }\r\n        // TODO: refactore it\r\n    }\r\n\r\n    var item = {\r\n        hoverInInternal,\r\n        stopAndResetDropDownMenuHover(){\r\n            eventSkipper.setSkippable(); //disable Hover On MouseEnter - filter's changes should remove hover\r\n            resetDropDownMenuHover();\r\n        },\r\n        showDropDown,\r\n        hideDropDown,\r\n        toggleHovered,\r\n        keyDownArrow,\r\n        insertDropDownItem,\r\n        getIsVisble(){\r\n            return choicesElement.style.display != 'none';\r\n        }\r\n        \r\n    }\r\n    return item;\r\n}\r\n","import {removeElement, setStyles} from './DomTools'\r\n\r\nconst picksStyle = {display:'flex', flexWrap:'wrap', listStyleType:'none'};  // remove bullets since this is ul\r\n\r\nexport function PicksPanel (\r\n        setSelected,\r\n        createElement,\r\n        picksElement, \r\n        init, \r\n        pickContentGenerator, \r\n        isComponentDisabled, \r\n        triggerChange, \r\n        onRemove,\r\n        onClick,\r\n        onPicksEmptyChanged, //placeholderAspect.updatePlacehodlerVisibility(); call the same on enable/disable\r\n        processRemoveButtonClick\r\n) \r\n{\r\n    var picksCount = 0;\r\n    function inc(){picksCount++; if (picksCount==1) onPicksEmptyChanged()};\r\n    function dec(){picksCount--; if (picksCount==0) onPicksEmptyChanged()};\r\n    function reset(){picksCount=0; onPicksEmptyChanged()}\r\n    function isEmpty(){return picksCount==0};\r\n\r\n    setStyles(picksElement, picksStyle); \r\n\r\n    var pickFilterElement = createElement('LI'); // detached\r\n        \r\n    picksElement.appendChild(pickFilterElement); // located filter in selectionsPanel\r\n\r\n    init(pickFilterElement);\r\n    var MultiSelectDataSelectedTail = null;\r\n\r\n    function removePicksTail(){\r\n        if (MultiSelectDataSelectedTail){ \r\n            MultiSelectDataSelectedTail.toggle(); // always remove in this case\r\n        }\r\n    }\r\n\r\n    function removeSelectedFromList(MultiSelectData){\r\n        if (MultiSelectData.selectedPrev){\r\n            (MultiSelectData.selectedPrev).selectedNext = MultiSelectData.selectedNext;\r\n        }\r\n        if (MultiSelectData.selectedNext){\r\n           (MultiSelectData.selectedNext).selectedPrev = MultiSelectData.selectedPrev;\r\n        }\r\n        if (MultiSelectDataSelectedTail == MultiSelectData){\r\n            MultiSelectDataSelectedTail = MultiSelectData.selectedPrev;\r\n        }\r\n        MultiSelectData.selectedNext=null;\r\n        MultiSelectData.selectedPrev=null;\r\n    }\r\n\r\n\r\n    function createPick(MultiSelectData, isOptionDisabled, setDropDownItemContentDisabled) {\r\n        \r\n        var pickElement = createElement('LI');\r\n        MultiSelectData.pickElement = pickElement;\r\n        if (MultiSelectDataSelectedTail){\r\n            MultiSelectDataSelectedTail.selectedNext = MultiSelectData;\r\n            MultiSelectData.selectedPrev = MultiSelectDataSelectedTail;\r\n        }\r\n        MultiSelectDataSelectedTail = MultiSelectData;\r\n\r\n        var removeSelectedItem = () => {\r\n            let confirmed = setSelected(MultiSelectData.option, false);\r\n            if (confirmed==null || confirmed) {\r\n                MultiSelectData.excludedFromSearch = isOptionDisabled;\r\n                if (isOptionDisabled)\r\n                {\r\n                    setDropDownItemContentDisabled(MultiSelectData.DropDownItemContent, false);\r\n                    MultiSelectData.toggle = ()=> {};\r\n                }\r\n                else\r\n                {\r\n                    MultiSelectData.toggle = ()=>{\r\n                        let confirmed = setSelected(MultiSelectData.option, true);\r\n                        if (confirmed==null || confirmed){\r\n                            createPick(MultiSelectData, isOptionDisabled, setDropDownItemContentDisabled);\r\n                            triggerChange();\r\n                        }\r\n                    };\r\n                }\r\n                MultiSelectData.DropDownItemContent.select(false);\r\n                removeElement(pickElement);\r\n                MultiSelectData.PickContent.dispose();\r\n                MultiSelectData.PickContent=null;\r\n                MultiSelectData.pickElement=null;\r\n\r\n                removeSelectedFromList(MultiSelectData);\r\n                dec();\r\n                triggerChange();\r\n            }\r\n        }\r\n\r\n        // processRemoveButtonClick removes the \r\n        // what is a problem with calling removeSelectedItem directly (not using  setTimeout(removeSelectedItem, 0)):\r\n        // consider situation \"MultiSelect\" on DROPDOWN (that should be closed on the click outside dropdown)\r\n        // therefore we aslo have document's click's handler where we decide to close or leave the DROPDOWN open.\r\n        // because of the event's bubling process removeSelectedItem runs first. \r\n        // that means the event's target element on which we click (the x button) will be removed from the DOM together with badge \r\n        // before we could analize is it belong to our dropdown or not.\r\n        // important 1: we can't just the stop propogation using stopPropogate because click outside dropdown on the similar \r\n        // component that use stopPropogation will not close dropdown (error, dropdown should be closed)\r\n        // important 2: we can't change the dropdown's event handler to leave dropdown open if event's target is null because of\r\n        // the situation described above: click outside dropdown on the same component.\r\n        // Alternatively it could be possible to use stopPropogate but together create custom click event setting new target that belomgs to DOM (e.g. panel)\r\n\r\n        let removeSelectedItemAndCloseDropDown = () => {\r\n            removeSelectedItem();\r\n            onRemove();\r\n        };\r\n    \r\n        let onRemoveSelectedItemEvent = (event) => {\r\n            processRemoveButtonClick(() => removeSelectedItemAndCloseDropDown(), event);\r\n        };\r\n\r\n        MultiSelectData.PickContent = pickContentGenerator(\r\n            pickElement,\r\n            MultiSelectData.option,\r\n            onRemoveSelectedItemEvent);\r\n\r\n        var disable = (isDisabled) =>\r\n            MultiSelectData.PickContent.disable(isDisabled);\r\n        disable(isComponentDisabled);\r\n\r\n        MultiSelectData.excludedFromSearch = true; // all selected excluded from search\r\n        MultiSelectData.disable = disable;\r\n        picksElement.insertBefore(pickElement, pickFilterElement);\r\n         \r\n        MultiSelectData.toggle = () => removeSelectedItem();\r\n        MultiSelectData.DropDownItemContent.select(true);\r\n        inc();\r\n    }\r\n\r\n    var picksClick = event => {\r\n        onClick(event);\r\n    };\r\n\r\n    function iterateAll(isDisabled){\r\n        let i = MultiSelectDataSelectedTail;\r\n        while(i){\r\n            i.disable(isDisabled); \r\n            i = i.selectedPrev;\r\n        }\r\n    }\r\n\r\n    var item = {\r\n        pickFilterElement,\r\n        createPick,\r\n        removePicksTail,\r\n        resetMultiSelectDataSelectedTail() {\r\n            reset();\r\n            MultiSelectDataSelectedTail = null;\r\n        },\r\n        isEmpty,\r\n        enable(){\r\n            isComponentDisabled= false;\r\n            iterateAll(false);\r\n            picksElement.addEventListener(\"click\", picksClick);\r\n\r\n        },\r\n        disable(){\r\n            isComponentDisabled= true;\r\n            iterateAll(true);\r\n            picksElement.removeEventListener(\"click\", picksClick);\r\n\r\n        },\r\n        dispose(){\r\n            var toRemove = picksElement.firstChild;\r\n            while( toRemove ) {\r\n                picksElement.removeChild( toRemove );\r\n                toRemove = picksElement.firstChild;\r\n            }\r\n            picksElement.removeEventListener(\"click\", picksClick); // OPEN dropdown\r\n        }\r\n        \r\n    }\r\n    return item;\r\n}","export function MultiSelectInputAspect (\r\n    window,\r\n    appendToContainer, \r\n    choiceFilterInputElement, \r\n    picksElement,\r\n    choicesElement, \r\n    showDropDown,\r\n    hideDropDownAndResetFilter,\r\n    isDropDownMenuEmpty,\r\n    Popper\r\n    ) {\r\n        appendToContainer();\r\n        var document = window.document;\r\n\r\n    var skipFocusout = false;\r\n    \r\n    // we want to escape the closing of the menu (because of focus out from) on a user's click inside the container\r\n    var skipoutMousedown = function() {\r\n         skipFocusout = true;\r\n    }\r\n\r\n    var documentMouseup = function(event) {\r\n        // if click outside container - close dropdown\r\n        if (  !(choicesElement === event.target \r\n                || picksElement === event.target \r\n                || choicesElement.contains(event.target)\r\n                || picksElement.contains(event.target)\r\n               )\r\n            ) {\r\n            hideDropDownAndResetFilter();\r\n        }\r\n    }\r\n\r\n    var popper = new Popper( \r\n        choiceFilterInputElement, \r\n        choicesElement, \r\n        {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: {enabled:false}\r\n            }\r\n        }\r\n    );\r\n\r\n    var filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n    var preventDefaultClickEvent = null;\r\n\r\n    function alignAndShowDropDown(event){\r\n        if (preventDefaultClickEvent != event) {\r\n            if (!isDropDownMenuEmpty())\r\n            {\r\n                alignToFilterInputItemLocation(true);\r\n                showDropDown();\r\n            }\r\n        }\r\n        preventDefaultClickEvent=null;\r\n    }\r\n    \r\n    function alignToFilterInputItemLocation(force) {\r\n        let offsetLeft = choiceFilterInputElement.offsetLeft;\r\n        if (force || filterInputItemOffsetLeft != offsetLeft){ // position changed\r\n            popper.update();\r\n            filterInputItemOffsetLeft = offsetLeft;\r\n        }\r\n    }\r\n\r\n    return {\r\n        dispose(){\r\n            popper.destroy();\r\n        },\r\n        alignToFilterInputItemLocation,\r\n        alignAndShowDropDown,\r\n        processUncheck(uncheckOption, event){\r\n            // we can't remove item on \"click\" in the same loop iteration - it is unfrendly for 3PP event handlers (they will get detached element)\r\n            // never remove elements in the same event iteration\r\n\r\n            window.setTimeout(()=>uncheckOption(),0)\r\n            preventDefaultClickEvent = event; // setPreventDefaultMultiSelectEvent\r\n        },\r\n        onDropDownShow(){\r\n            // add listeners that manages close dropdown on input's focusout and click outside container\r\n            //container.removeEventListener(\"mousedown\", containerMousedown);\r\n\r\n            picksElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            choicesElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            document.addEventListener(\"mouseup\", documentMouseup);\r\n            \r\n        },\r\n        onDropDownHide(){\r\n            picksElement.removeEventListener(\"mousedown\", skipoutMousedown);\r\n            choicesElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            document.removeEventListener(\"mouseup\", documentMouseup);\r\n        },\r\n        getSkipFocusout : function() {\r\n             return skipFocusout;\r\n        },\r\n        resetSkipFocusout : function() {\r\n             skipFocusout=false;\r\n        }\r\n    }\r\n}","export function PlaceholderAspect(placeholderText, picksIsEmpty, filterIsEmpty, picksElement, inputElement ){\r\n    function setEmptyInputWidth(isVisible){\r\n        if(isVisible)\r\n            inputElement.style.width=\"100%\"\r\n        else\r\n            inputElement.style.width=\"2ch\";\r\n    }\r\n\r\n    function showPlacehodler(isVisible){\r\n        if (isVisible)\r\n        {\r\n            inputElement.placeholder = placeholderText?placeholderText:\"\";\r\n            picksElement.style.display= \"block\";\r\n        }\r\n        else\r\n        {\r\n            inputElement.placeholder = \"\";\r\n            picksElement.style.display= \"flex\";\r\n        }\r\n        setEmptyInputWidth(isVisible);\r\n    }\r\n    showPlacehodler(true);\r\n\r\n    return {\r\n        init(){\r\n        },\r\n        updatePlacehodlerVisibility(){\r\n            showPlacehodler(picksIsEmpty() && filterIsEmpty());\r\n        },\r\n        updateEmptyInputWidth(){\r\n            setEmptyInputWidth(picksIsEmpty() && filterIsEmpty())\r\n        },\r\n        setDisabled(isDisabled)\r\n        { \r\n            inputElement.disabled = isDisabled;\r\n        }\r\n    }\r\n}","export function EventSkipper(window) {\r\n    var isSkippable = false;\r\n    return {\r\n        isSkippable(){\r\n            return isSkippable;\r\n        },\r\n        setSkippable(){\r\n            isSkippable = true;\r\n            window.setTimeout( \r\n                () => {  \r\n                    isSkippable = false;\r\n                }, 0)\r\n        }\r\n    }\r\n}","import Popper from 'popper.js'\r\nimport {FilterPanel} from './FilterPanel'\r\nimport {ChoicesPanel} from './ChoicesPanel'\r\nimport {PicksPanel} from './PicksPanel'\r\nimport {MultiSelectInputAspect} from './MultiSelectInputAspect'\r\nimport {PlaceholderAspect} from './PlaceholderAspect'\r\n\r\nimport {EventSkipper} from './EventSkipper'\r\nimport {removeElement} from './DomTools'\r\n\r\nfunction filterMultiSelectData(MultiSelectData, isFiltered, visibleIndex) {\r\n    MultiSelectData.visible = isFiltered;\r\n    MultiSelectData.visibleIndex = visibleIndex;\r\n    MultiSelectData.dropDownMenuItemElement.style.display = isFiltered ? 'block': 'none';\r\n} \r\n\r\nfunction resetDropDownMenu(MultiSelectDataList) {\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            filterMultiSelectData(multiSelectData, true, i);\r\n        }\r\n    }\r\n}\r\n\r\nfunction collectFilterDropDownMenu(MultiSelectDataList, text) {\r\n    var list = [];\r\n    var j = 0;\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            if ( multiSelectData.excludedFromSearch || multiSelectData.searchText.indexOf(text)<0 )\r\n            {\r\n                filterMultiSelectData(multiSelectData, false);\r\n            }\r\n            else \r\n            {\r\n                filterMultiSelectData(multiSelectData, true, j++);\r\n                list.push( multiSelectData );\r\n            }\r\n        }\r\n    }\r\n    return list;\r\n}\r\n\r\nexport class MultiSelect {\r\n\r\n    constructor(optionsAdapter, setSelected, containerAdapter, styling, \r\n        pickContentGenerator, choiceContentGenerator, \r\n        labelAdapter, createStylingComposite, placeholderText,\r\n        configuration, onUpdate, onDispose, window) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n        this.onUpdate = onUpdate;\r\n        this.onDispose = onDispose; \r\n\r\n        // readonly\r\n        this.optionsAdapter = optionsAdapter;\r\n        this.containerAdapter = containerAdapter;\r\n        this.styling = styling;\r\n        this.pickContentGenerator = pickContentGenerator;\r\n        this.choiceContentGenerator = choiceContentGenerator;\r\n        this.labelAdapter = labelAdapter;\r\n        this.createStylingComposite = createStylingComposite;\r\n        this.configuration = configuration;\r\n        this.placeholderText = placeholderText;\r\n        this.setSelected=setSelected; // should I rebind this for callbacks? setSelected.bind(this);\r\n        this.window = window;\r\n\r\n        this.visibleCount=10;\r\n\r\n        this.choicesPanel = null;\r\n\r\n        this.stylingComposite = null;\r\n\r\n        this.isComponentDisabled = null;\r\n                \r\n        this.resetMultiSelectDataList();\r\n    }\r\n\r\n    resetMultiSelectDataList(){\r\n        this.MultiSelectDataList = [];\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    \r\n    getVisibleMultiSelectDataList(){\r\n        if (this.filteredMultiSelectDataList)\r\n            return this.filteredMultiSelectDataList;\r\n        else\r\n            return this.MultiSelectDataList;\r\n    }\r\n\r\n    resetFilter(){\r\n        if (!this.filterPanel.isEmpty()) {\r\n            this.filterPanel.setEmpty();\r\n            this.processEmptyInput();\r\n            this.placeholderAspect.updatePlacehodlerVisibility();\r\n        }\r\n    }\r\n\r\n    processEmptyInput(){\r\n        this.filterPanel.setEmptyLength();\r\n        resetDropDownMenu(this.MultiSelectDataList);\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    // -----------------------------------------------------------------------------------------------------------------------\r\n    GetContainer(){\r\n        return this.containerAdapter.containerElement;\r\n    }\r\n\r\n    Update(){\r\n        this.onUpdate();\r\n        this.UpdateDisabled();\r\n        this.UpdateData();\r\n    }\r\n\r\n    /*\r\n    UpdateOption(index){\r\n        let multiSelectData = this.MultiSelectDataList[index];\r\n        let option = multiSelectData.option;\r\n        multiSelectData.searchText = option.text.toLowerCase().trim();\r\n        if (multiSelectData.isHidden != option.isHidden)\r\n        {\r\n            multiSelectData.isHidden=option.isHidden;\r\n            if (multiSelectData.isHidden)\r\n                this.optionsPanel.insertDropDownItem(multiSelectData, \r\n                    (p1,p2,p3)=>this.picksPanel.createPick(p1,p2,p3),\r\n                    ()=>this.optionsAdapter.triggerChange(),\r\n                    option.isSelected, option.isDisabled);\r\n            else\r\n                multiSelectData.removeDropDownMenuItemElement();\r\n        }\r\n        else \r\n        {\r\n            if (multiSelectData.isSelected != option.isSelected)\r\n            {\r\n                multiSelectData.isSelected=option.isSelected;\r\n                if (multiSelectData.isSelected)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n            if (multiSelectData.isDisabled != option.isDisabled)\r\n            {\r\n                multiSelectData.isDisabled=option.isDisabled;\r\n                if (multiSelectData.isDisabled)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n        }    \r\n        //multiSelectData.updateOption();\r\n    }*/\r\n\r\n    DeselectAll(){\r\n        this.choicesPanel.hideDropDown(); // always hide 1st\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.pickElement)\r\n                multiSelectData.toggle();\r\n        }\r\n        this.resetFilter();\r\n        \r\n    }\r\n\r\n    SelectAll(){\r\n        this.choicesPanel.hideDropDown(); // always hide 1st\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (!multiSelectData.excludedFromSearch)\r\n                multiSelectData.toggle();\r\n        }\r\n        this.resetFilter();\r\n    }\r\n\r\n    empty(){\r\n        // close drop down , remove filter and listeners\r\n        this.choicesPanel.hideDropDown(); // always hide 1st\r\n        this.resetFilter();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.dropDownMenuItemElement)\r\n                removeElement(multiSelectData.dropDownMenuItemElement);\r\n            if (multiSelectData.pickElement)\r\n                removeElement(multiSelectData.pickElement);\r\n        }\r\n        this.resetMultiSelectDataList();\r\n        this.picksPanel.resetMultiSelectDataSelectedTail();// this.MultiSelectDataSelectedTail = null;\r\n    }\r\n\r\n    UpdateData(){\r\n        this.empty();\r\n        // reinitiate\r\n        this.updateDataImpl();\r\n        \r\n    }\r\n\r\n    updateDataImpl(){\r\n        var createDropDownItems = () => {\r\n            let options = this.optionsAdapter.getOptions();\r\n            var j = 0;\r\n            for(let i = 0; i<options.length; i++) {\r\n                let option = options[i];\r\n\r\n                let isSelected = option.selected;\r\n\r\n                let isDisabled = (option.disabled)?option.disabled:false;\r\n                let isHidden   = (option.hidden)?option.hidden:false;\r\n                \r\n                var MultiSelectData = {\r\n                    searchText: option.text.toLowerCase().trim(),\r\n                    excludedFromSearch: isSelected || isDisabled || isHidden,\r\n                    option: option,\r\n                    isHidden: isHidden,\r\n                    dropDownMenuItemElement: null,\r\n                    dropDownItemContent: null,\r\n                    selectedPrev: null,\r\n                    selectedNext: null,\r\n                    visible: false,\r\n                    toggle: null,\r\n                    pickElement: null,\r\n                    remove: null,\r\n                    disable: null,\r\n                    removeDropDownMenuItemElement: null\r\n                };\r\n\r\n                this.MultiSelectDataList.push(MultiSelectData);\r\n                if (!isHidden){\r\n                    MultiSelectData.visible = true;\r\n                    MultiSelectData.visibleIndex=i;\r\n                    this.choicesPanel.insertDropDownItem(\r\n                        MultiSelectData, \r\n                        (p1,p2,p3) => this.picksPanel.createPick(p1,p2,p3),\r\n                        (o,i) => this.setSelected(o,i),\r\n                        () => this.optionsAdapter.triggerChange(), \r\n                        isSelected, \r\n                        isDisabled);\r\n                }\r\n            } \r\n            this.aspect.alignToFilterInputItemLocation(false);\r\n            //this.placeholderAspect.updatePlacehodlerVisibility();\r\n        }\r\n\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        if (document.readyState != 'loading'){\r\n            createDropDownItems();\r\n        } else {\r\n            var createDropDownItemsHandler = function(){\r\n                createDropDownItems();\r\n                document.removeEventListener(\"DOMContentLoaded\", createDropDownItemsHandler);\r\n            }\r\n            document.addEventListener('DOMContentLoaded', createDropDownItemsHandler); // IE9+\r\n        }\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.onDispose)\r\n            this.onDispose(); // primary used to remove from jQuery tables\r\n        \r\n        // remove event listeners\r\n        // TODO check if open\r\n        this.choicesPanel.hideDropDown();\r\n        if (this.optionsAdapter.dispose)\r\n            this.optionsAdapter.dispose();\r\n        this.picksPanel.dispose();\r\n        this.filterPanel.dispose();\r\n        \r\n        this.labelAdapter.dispose();\r\n        \r\n        this.aspect.dispose();\r\n        \r\n        this.containerAdapter.dispose();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            multiSelectData.toggle = null;\r\n            multiSelectData.remove = null; \r\n            multiSelectData.removeDropDownMenuItemElement = null;\r\n            if (multiSelectData.DisposeDropDownMenuItemElement)\r\n                multiSelectData.DisposeDropDownMenuItemElement();\r\n            \r\n            if (multiSelectData.PickContent)\r\n                multiSelectData.PickContent.dispose();\r\n            if (multiSelectData.DropDownItemContent)\r\n                multiSelectData.DropDownItemContent.dispose();\r\n        }\r\n    }\r\n\r\n    UpdateDisabled(){\r\n        let isComponentDisabled = this.optionsAdapter.getDisabled();\r\n        if (this.isComponentDisabled!==isComponentDisabled){\r\n            if (isComponentDisabled) {\r\n                this.picksPanel.disable();\r\n                this.placeholderAspect.setDisabled(true);\r\n                this.styling.Disable(this.stylingComposite);\r\n            } else {\r\n                this.picksPanel.enable();\r\n                this.placeholderAspect.setDisabled(false);\r\n                this.styling.Enable(this.stylingComposite);\r\n            }\r\n            this.isComponentDisabled=isComponentDisabled;\r\n        }\r\n    }\r\n \r\n    input(filterInputValue, resetLength){\r\n        let text = filterInputValue.trim().toLowerCase();\r\n        var isEmpty=false;\r\n        if (text == '')\r\n            isEmpty=true;\r\n        else\r\n        {\r\n            // check if exact match, otherwise new search\r\n            this.filteredMultiSelectDataList = collectFilterDropDownMenu(this.MultiSelectDataList, text);\r\n            if (this.filteredMultiSelectDataList.length == 1)\r\n            {\r\n                let fullMatchMultiSelectData =  this.filteredMultiSelectDataList[0];\r\n                if (fullMatchMultiSelectData.searchText == text)\r\n                {\r\n                    fullMatchMultiSelectData.toggle();\r\n                    this.filterPanel.setEmpty(); // clear\r\n                    isEmpty=true;\r\n                }\r\n            }\r\n        }\r\n        if (isEmpty)\r\n            this.processEmptyInput();\r\n        else\r\n            resetLength();  \r\n        \r\n        \r\n        this.choicesPanel.stopAndResetDropDownMenuHover();\r\n        if (this.getVisibleMultiSelectDataList().length == 1) {\r\n            this.choicesPanel.hoverInInternal(0)\r\n        }\r\n\r\n        if (this.getVisibleMultiSelectDataList().length > 0) {\r\n            this.aspect.alignToFilterInputItemLocation(true); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.choicesPanel.showDropDown();\r\n        } else {\r\n            this.choicesPanel.hideDropDown();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        var document = this.window.document;\r\n        var createElement = (name) => document.createElement(name);\r\n\r\n        var lazyfilterItemInputElementAtach=null;\r\n        \r\n        this.filterPanel = FilterPanel(\r\n            createElement,\r\n            (filterItemInputElement) => {\r\n                lazyfilterItemInputElementAtach = (filterItemElement)=>{\r\n                    filterItemElement.appendChild(filterItemInputElement);\r\n                    this.labelAdapter.init(filterItemInputElement); \r\n                };\r\n            },\r\n            () => {\r\n                this.styling.FocusIn(this.stylingComposite)\r\n            },  // focus in - show dropdown\r\n            () => {\r\n                if (!this.aspect.getSkipFocusout()) // skip initiated by mouse click (we manage it different way)\r\n                {\r\n                    this.resetFilter(); // if do not do this we will return to filtered list without text filter in input\r\n                    this.styling.FocusOut(this.stylingComposite)\r\n                }\r\n                this.aspect.resetSkipFocusout();\r\n            }, // focus out - hide dropdown\r\n            () => this.choicesPanel.keyDownArrow(false), // arrow up\r\n            () => this.choicesPanel.keyDownArrow(true),  // arrow down\r\n            () => this.choicesPanel.hideDropDown(),  // tab on empty\r\n            () => {\r\n                this.picksPanel.removePicksTail();\r\n                this.aspect.alignToFilterInputItemLocation(false);\r\n            }, // backspace - \"remove last\"\r\n            () => { \r\n                if (this.choicesPanel.getIsVisble())\r\n                    this.choicesPanel.toggleHovered() }, // tab/enter \"compleate hovered\"\r\n            (isEmpty, event) => {\r\n                if (!isEmpty || this.choicesPanel.getIsVisble()) // supports bs modal - stop esc (close modal) propogation\r\n                    event.stopPropagation();\r\n            }, // esc keydown\r\n            () => {\r\n                this.choicesPanel.hideDropDown(); // always hide 1st\r\n                this.resetFilter();\r\n            }, // esc keyup \r\n            (filterInputValue, resetLength) =>\r\n            { \r\n                this.placeholderAspect.updatePlacehodlerVisibility();\r\n                this.input(filterInputValue, resetLength) \r\n            }, // filter\r\n            () => {\r\n                this.placeholderAspect.updateEmptyInputWidth();\r\n            }\r\n        );\r\n        \r\n        this.picksPanel =  PicksPanel(\r\n            this.setSelected,\r\n            createElement,\r\n            this.containerAdapter.picksElement,\r\n            (filterItemElement) => {\r\n                lazyfilterItemInputElementAtach(filterItemElement);\r\n            },\r\n            this.pickContentGenerator,\r\n            this.isComponentDisabled,\r\n            () => this.optionsAdapter.triggerChange(),\r\n            () => {\r\n                this.choicesPanel.hideDropDown(); // always hide 1st\r\n                this.resetFilter();\r\n            },\r\n            (event) => {\r\n                if (!this.filterPanel.isEventTarget(event))\r\n                     this.filterPanel.setFocus();\r\n                this.aspect.alignAndShowDropDown(event); \r\n            },\r\n            ()=> this.placeholderAspect.updatePlacehodlerVisibility(),\r\n            (doUncheck, event) => {\r\n                this.aspect.processUncheck(doUncheck, event);\r\n            }\r\n        );\r\n\r\n        this.choicesPanel = ChoicesPanel(\r\n            createElement,\r\n            this.containerAdapter.choicesElement,\r\n            () => this.aspect.onDropDownShow(),\r\n            () => this.aspect.onDropDownHide(),\r\n            EventSkipper(this.window),\r\n            this.choiceContentGenerator,\r\n            () => this.getVisibleMultiSelectDataList(),\r\n            () => this.resetFilter(),\r\n            () => this.aspect.alignToFilterInputItemLocation(true),\r\n            () => this.filterPanel.setFocus()\r\n        );\r\n\r\n        this.placeholderAspect = PlaceholderAspect(\r\n            this.placeholderText, \r\n            () => this.picksPanel.isEmpty(), \r\n            () => this.filterPanel.isEmpty(), \r\n            this.containerAdapter.picksElement, \r\n            this.filterPanel.filterInputElement\r\n        )\r\n\r\n        this.placeholderAspect.init();\r\n        this.placeholderAspect.updateEmptyInputWidth();\r\n        \r\n\r\n        this.aspect =  MultiSelectInputAspect(\r\n            this.window,\r\n            ()=>this.containerAdapter.appendToContainer(), \r\n            this.picksPanel.pickFilterElement, \r\n            this.containerAdapter.picksElement, \r\n            this.containerAdapter.choicesElement, \r\n            () => this.choicesPanel.showDropDown(),\r\n            () => {  \r\n                this.choicesPanel.hideDropDown();\r\n                this.resetFilter();\r\n            },\r\n            () => this.getVisibleMultiSelectDataList().length==0, \r\n            Popper\r\n        );\r\n        \r\n        this.stylingComposite = this.createStylingComposite(\r\n            this.picksPanel.pickFilterElement, \r\n            this.filterPanel.filterInputElement, \r\n            this.containerAdapter.choicesElement);\r\n        \r\n        this.styling.Init(this.stylingComposite);\r\n\r\n        this.containerAdapter.attachContainer();\r\n\r\n        this.onUpdate();\r\n        this.UpdateDisabled(); // should be done after updateDataImpl\r\n        this.updateDataImpl();\r\n\r\n        if (this.optionsAdapter.subscribeToReset)\r\n            this.optionsAdapter.subscribeToReset(()=> this.window.setTimeout( ()=>this.UpdateData() ) );\r\n    }\r\n}","export function LabelAdapter(labelElement, createInputId){\r\n    var backupedForAttribute = null; // state saved between init and dispose\r\n    return {\r\n        init(filterInputElement) {\r\n            if (labelElement) {\r\n                backupedForAttribute = labelElement.getAttribute('for');\r\n                var newId = createInputId();\r\n                filterInputElement.setAttribute('id', newId);\r\n                labelElement.setAttribute('for',newId);\r\n            }\r\n        },\r\n        dispose(){\r\n            if(backupedForAttribute)\r\n                labelElement.setAttribute('for',backupedForAttribute);\r\n        }\r\n    }\r\n}","export function addToJQueryPrototype(pluginName, createPlugin, defaults, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    const firstCharLower = firstChar.toLowerCase();\r\n    if (firstCharLower == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstCharLower + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance (for 1st $selected item)\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n\r\n    $.fn[prototypableName].defaults = defaults;\r\n}\r\n\r\n","function OptionsAdapterElement(selectElement, getDisabled, getSize, getIsValid, getIsInvalid, trigger, form) {\r\n    var backup;\r\n    return {\r\n        getOptions(){\r\n            return selectElement.getElementsByTagName('OPTION')\r\n        },\r\n        triggerChange(){\r\n            trigger('change')\r\n            trigger('multiselect:change')\r\n        },\r\n        getDisabled,\r\n        getSize,\r\n        getIsValid,\r\n        getIsInvalid,\r\n        subscribeToReset(handler){\r\n            backup = handler;\r\n            if (form)\r\n                form.addEventListener('reset', backup)\r\n        },\r\n        dispose(){\r\n            if (form && backup)\r\n                form.removeEventListener('reset', backup)\r\n        }\r\n    }\r\n}\r\n\r\nfunction OptionsAdapterJson(options, getDisabled, getSize, getIsValid, getIsInvalid, trigger) {\r\n    return {\r\n        getOptions(){\r\n            return options\r\n        },\r\n        triggerChange(){\r\n            trigger('multiselect:change')\r\n        },\r\n        getDisabled(){\r\n            return getDisabled?getDisabled():false\r\n        },\r\n        getSize(){\r\n            return getSize?getSize():null\r\n        },\r\n        getIsValid(){\r\n            return getIsValid?getIsValid():false\r\n        },\r\n        getIsInvalid(){\r\n            return getIsInvalid?getIsInvalid():false\r\n        }\r\n    }\r\n}\r\n\r\nexport {OptionsAdapterJson, OptionsAdapterElement}","import {setStyles} from './DomTools';\r\nimport {createEmpty} from './JsTools';\r\n\r\nexport function StylingCorrector(configuration){\r\n    var resetDisable = createEmpty(configuration.picksStyleDisabled, \"\");\r\n    var resetFocus = createEmpty(configuration.picksStyleFocus, \"\");\r\n    return {\r\n        init(elements){\r\n            setStyles(elements.picks, configuration.picksStyle);\r\n            setStyles(elements.input, configuration.filterInputStyle);\r\n        },\r\n    \r\n        enable(picksElement){\r\n            setStyles(picksElement, resetDisable)\r\n        },\r\n    \r\n        disable(picksElement){\r\n            setStyles(picksElement, configuration.picksStyleDisabled);\r\n        },\r\n    \r\n        focusIn(picksElement){\r\n            setStyles(picksElement, configuration.picksStyleFocus)\r\n        },\r\n    \r\n        focusOut(picksElement){\r\n            setStyles(picksElement, resetFocus)\r\n        }\r\n    }\r\n}","import {addClasses, removeClasses} from './DomTools';\r\n\r\nexport function Styling(configuration, stylingCorrector) {\r\n    return {\r\n        Init(elements){\r\n            addClasses(elements.container, configuration.containerClass);\r\n            addClasses(elements.picks, configuration.picksClass);\r\n            addClasses(elements.choices, configuration.choicesClass);\r\n            addClasses(elements.pickFilter, configuration.pickFilterClass);\r\n            addClasses(elements.input, configuration.filterInputClass);\r\n            if (stylingCorrector && stylingCorrector.init)\r\n                stylingCorrector.init(elements)\r\n        },\r\n\r\n        Enable(elements){\r\n            removeClasses(elements.picks, configuration.picksClassDisabled);\r\n            if (stylingCorrector && stylingCorrector.enable)\r\n                stylingCorrector.enable(elements.picks)\r\n        },\r\n\r\n        Disable(elements){\r\n            addClasses(elements.picks, configuration.picksClassDisabled);\r\n            if (stylingCorrector && stylingCorrector.disable)\r\n                stylingCorrector.disable(elements.picks)\r\n        },\r\n\r\n        FocusIn(elements){\r\n            addClasses(elements.picks, configuration.picksClassFocus);\r\n            if (stylingCorrector && stylingCorrector.focusIn)\r\n                stylingCorrector.focusIn(elements.picks)\r\n        },\r\n\r\n        FocusOut(elements){\r\n            removeClasses(elements.picks, configuration.picksClassFocus);\r\n            if (stylingCorrector && stylingCorrector.focusOut)\r\n                stylingCorrector.focusOut(elements.picks)\r\n        }\r\n    }\r\n}","import  {addClasses, setStyles} from './DomTools';\r\n\r\nexport function BsPickContentStylingCorrector(configuration) {\r\n    return {\r\n        disablePickContent(content){\r\n            setStyles(content, configuration.pickContentStyleDisabled);\r\n        },\r\n    \r\n        createPickContent(selectedItem, button){\r\n            setStyles(selectedItem, configuration.pickStyle);\r\n            setStyles(button, configuration.pickButtonStyle);\r\n        }\r\n    }\r\n}\r\n\r\nexport function BsPickContentGenerator(configuration, stylingCorrector, $) {\r\n    return function (selectedItem, optionItem, removeSelectedItem){\r\n            let $selectedItem = $(selectedItem)\r\n            addClasses(selectedItem, configuration.pickClass);\r\n            let $content = $(`<span/>`).text(optionItem.text);\r\n            let content = $content.get(0); \r\n            $content.appendTo($selectedItem);\r\n            if (optionItem.disabled ){\r\n                addClasses(content, configuration.pickContentClassDisabled)\r\n                if (stylingCorrector && stylingCorrector.disablePickContent)\r\n                    stylingCorrector.disablePickContent(content);\r\n            }\r\n\r\n            let $button = $('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n                // bs 'close' class that will be added to button set the float:right, therefore it impossible to configure no-warp policy \r\n                // with .css(\"white-space\", \"nowrap\") or  .css(\"display\", \"inline-block\"); TODO: migrate to flex? \r\n                .css(\"float\", \"none\").appendTo($selectedItem)\r\n                .addClass(configuration.pickRemoveButtonClass) // bs close class set the float:right\r\n                .on(\"click\", \r\n                    jqEvent =>    \r\n                        removeSelectedItem(jqEvent.originalEvent)\r\n                    );\r\n            if (stylingCorrector && stylingCorrector.createPickContent)\r\n                stylingCorrector.createPickContent(selectedItem, $button.get(0));\r\n            return {\r\n                disable(isDisabled){ \r\n                    $button.prop('disabled', isDisabled); \r\n                },\r\n                dispose(){\r\n                    $button.unbind();\r\n                }\r\n            };\r\n        }\r\n}","import {addClasses, removeClasses, setStyles} from './DomTools';\r\nimport {createEmpty} from './JsTools'\r\n\r\nexport function BsChoiceContentStylingCorrector(configuration) {\r\n    var resetStyle = createEmpty(resetStyle, configuration.choiceLabelStyleDisabled, '');\r\n    return{\r\n        disabledStyle(checkBox, checkBoxLabel, isDisbaled){\r\n            setStyles(checkBoxLabel, isDisbaled? configuration.choiceLabelStyleDisabled : resetStyle)\r\n        }\r\n    }\r\n}\r\n\r\nexport function BsChoiceContentGenerator(configuration, stylingCorrector, $) {\r\n   \r\n    return function(choiceElement, option){\r\n        let $choiceElement = $(choiceElement);\r\n        $choiceElement.addClass(configuration.choiceClass);\r\n        let $choiceContent= $(`<div class=\"custom-control custom-checkbox\">\r\n            <input type=\"checkbox\" class=\"custom-control-input\">\r\n            <label class=\"custom-control-label justify-content-start\"></label>\r\n        </div>`);\r\n        $choiceContent.appendTo(choiceElement);\r\n        let $checkBox = $choiceContent.find(`INPUT[type=\"checkbox\"]`);\r\n        let $checkBoxLabel = $choiceContent.find(`label`);\r\n        $checkBoxLabel.text(option.text);\r\n\r\n        var tmp = { \r\n            select(isSelected){ $checkBox.prop('checked', isSelected); }, \r\n            // --- distinct disable and disabledStyle to provide a possibility to unselect disabled option\r\n            disable(isDisabled){ $checkBox.prop('disabled', isDisabled); },\r\n            disabledStyle(isDisbaled){ \r\n                if (isDisbaled) \r\n                    $checkBox.addClass(configuration.choiceCheckBoxClassDisabled);\r\n                else\r\n                    $checkBox.removeClass(configuration.choiceCheckBoxClassDisabled);\r\n                if (stylingCorrector && stylingCorrector.disabledStyle)\r\n                    stylingCorrector.disabledStyle($checkBox.get(0), $checkBoxLabel.get(0), isDisbaled); \r\n            },\r\n            hoverIn(){\r\n                addClasses(choiceElement, configuration.choiceClassHover);\r\n            },\r\n            hoverOut(){\r\n                removeClasses(choiceElement, configuration.choiceClassHover);\r\n            },\r\n            onSelected(toggle) {\r\n                $checkBox.on(\"change\", toggle)\r\n                $choiceElement.on(\"click\", event => {\r\n                    if (choiceElement === event.target || $.contains(choiceElement, event.target)) {\r\n                        toggle();\r\n                    }\r\n                })\r\n            },\r\n            dispose(){\r\n                $checkBox.unbind();\r\n                $choiceElement.unbind();\r\n            }\r\n        }\r\n        \r\n        return tmp;\r\n    }\r\n}","export function ContainerAdapter(createElement, selectElement, containerElement, picksElement) { // select\r\n    var ownContainerElement = false;\r\n    var ownPicksElement = false;\r\n    \r\n    if (!containerElement){\r\n        containerElement = createElement('div');\r\n        ownContainerElement= true;\r\n    }\r\n    if (!picksElement){\r\n        picksElement = createElement('UL');\r\n        ownPicksElement = true;\r\n    }\r\n\r\n    var choicesElement = createElement('UL');\r\n    choicesElement.style.display=\"none\";\r\n    \r\n    var backupDisplay = null;\r\n    if (selectElement)\r\n    { \r\n        backupDisplay = selectElement.style.display;\r\n        selectElement.style.display='none';\r\n    }\r\n    \r\n    return {\r\n        containerElement,\r\n        picksElement,\r\n        choicesElement,\r\n        init(){\r\n            if (ownPicksElement)\r\n                containerElement.appendChild(picksElement);\r\n        },\r\n        appendToContainer(){\r\n            if (ownContainerElement || !selectElement)            \r\n            {\r\n                if (ownPicksElement)\r\n                    containerElement.appendChild(picksElement);\r\n                containerElement.appendChild(choicesElement);\r\n            }\r\n            else\r\n            {\r\n                if (selectElement)\r\n                {\r\n                    selectElement.parentNode.insertBefore(choicesElement, selectElement.nextSibling);\r\n                    if (ownPicksElement)\r\n                        selectElement.parentNode.insertBefore(picksElement, choicesElement);\r\n                }\r\n            }\r\n        },\r\n        attachContainer(){\r\n            if (ownContainerElement)\r\n                selectElement.parentNode.insertBefore(containerElement, selectElement.nextSibling);\r\n        },\r\n        dispose(){\r\n            if (ownContainerElement)\r\n                containerElement.parentNode.removeChild(containerElement);\r\n            if (ownPicksElement)\r\n                picksElement.parentNode.removeChild(picksElement);\r\n            choicesElement.parentNode.removeChild(choicesElement);\r\n            if (selectElement)\r\n                selectElement.style.display = backupDisplay;\r\n        }\r\n    }\r\n}","import {addClass, removeClass, setStyles} from './DomTools';\r\n\r\nfunction updateIsValid(picksElement, isValid, isInvalid){\r\n    if (isValid)\r\n        addClass(picksElement,'is-valid');\r\n    else\r\n        removeClass(picksElement,'is-valid');\r\n    \r\n    if (isInvalid)\r\n        addClass(picksElement,'is-invalid');\r\n    else\r\n        removeClass(picksElement,'is-invalid');\r\n}\r\n\r\n\r\nfunction updateSize(picksElement, size){\r\n    if (size==\"custom-select-lg\"){\r\n        addClass(picksElement,'form-control-lg');\r\n        removeClass(picksElement,'form-control-sm');\r\n    }\r\n    else if (size==\"custom-select-sm\"){\r\n        removeClass(picksElement,'form-control-lg');\r\n        addClass(picksElement,'form-control-sm');\r\n    }\r\n    else{\r\n        removeClass(picksElement,'form-control-lg');\r\n        removeClass(picksElement,'form-control-sm');\r\n    }\r\n}\r\n\r\nfunction updateSizeJs(picksElement, picksStyleLg, picksStyleSm, picksStyleDef, size){\r\n    updateSize(picksElement, size);\r\n    if (size==\"custom-select-lg\" || size==\"input-group-lg\"){\r\n        setStyles(picksElement, picksStyleLg);\r\n    } else if (size==\"custom-select-sm\" || size==\"input-group-sm\"){\r\n        setStyles(picksElement, picksStyleSm);\r\n    } else {\r\n        setStyles(picksElement, picksStyleDef);\r\n    }\r\n}\r\n\r\nfunction updateIsValidForAdapter(picksElement, optionsAdapter){\r\n    updateIsValid(picksElement, optionsAdapter.getIsValid(), optionsAdapter.getIsInvalid())\r\n}\r\n\r\nfunction updateSizeForAdapter(picksElement, optionsAdapter){\r\n    updateSize(picksElement, optionsAdapter.getSize())\r\n}\r\n\r\nfunction updateSizeJsForAdapter(picksElement, picksStyleLg, picksStyleSm, picksStyleDef, optionsAdapter){\r\n    updateSizeJs(picksElement, picksStyleLg, picksStyleSm, picksStyleDef,  optionsAdapter.getSize())\r\n}\r\n\r\nexport function createBsAppearance(picksElement, configuration, optionsAdapter){\r\n    var updateIsValid = () => updateIsValidForAdapter(picksElement, optionsAdapter);\r\n    if (configuration.useCss){\r\n        return Object.create({\r\n            updateIsValid,\r\n            updateSize: () => updateSizeForAdapter(picksElement, optionsAdapter)\r\n        });\r\n    }else{\r\n        const {picksStyleLg, picksStyleSm, picksStyleDef} = configuration;\r\n        return Object.create({\r\n            updateIsValid,\r\n            updateSize: () => updateSizeJsForAdapter(picksElement, \r\n                picksStyleLg, picksStyleSm, picksStyleDef, optionsAdapter)\r\n        });\r\n    }\r\n}","import $ from 'jquery'\r\n\r\nimport {extendIfUndefined} from './JsTools';\r\nimport {MultiSelect} from './MultiSelect'\r\nimport {LabelAdapter} from './LabelAdapter';\r\nimport {addToJQueryPrototype} from './AddToJQueryPrototype'\r\n\r\nimport {OptionsAdapterJson,OptionsAdapterElement} from './OptionsAdapters';\r\n\r\nimport {StylingCorrector} from './StylingCorrector'\r\nimport {Styling} from './Styling';\r\n\r\nimport {BsPickContentGenerator, BsPickContentStylingCorrector} from './BsPickContentGenerator';\r\nimport {BsChoiceContentGenerator, BsChoiceContentStylingCorrector} from './BsChoiceContentGenerator';\r\nimport {ContainerAdapter} from './ContainerAdapter';\r\n\r\nimport {createBsAppearance} from './BsAppearance';\r\nimport {findDirectChildByTagName, setStyles} from './DomTools';\r\n\r\nconst classesDefaults = {\r\n    containerClass: 'dashboardcode-bsmultiselect',\r\n    choicesClass: 'dropdown-menu',\r\n\r\n    choiceClassHover: 'text-primary bg-light', // TODO looks like bullshit\r\n    choiceClassSelected: '', // not used? should be used in OptionsPanel.js\r\n    choiceClassDisabled: '', // not used? should be used in OptionsPanel.js\r\n\r\n    picksClass: 'form-control',  \r\n    picksClassFocus: 'focus', // internal, not bs4, used in scss\r\n    picksClassDisabled: 'disabled', // internal, not bs4, used in scss\r\n\r\n    pickClassDisabled: '', // not used? should be used in PicksPanel.js\r\n    \r\n    pickFilterClass: '', \r\n    filterInputClass: '',\r\n\r\n    // used in BsPickContentStylingCorrector\r\n    pickClass: 'badge',\r\n    pickRemoveButtonClass: 'close',\r\n    pickContentClassDisabled: 'disabled', // internal, not bs4, used in scss\r\n\r\n    // used in BsChoiceContentStylingCorrector\r\n    choiceClass:  'px-2',\r\n    choiceCheckBoxClassDisabled: 'disabled' // internal, not bs4, used in scss\r\n\r\n};\r\n\r\nconst stylingDefaults = {\r\n    // used in StylingCorrector\r\n    picksStyle: {marginBottom: 0, height: 'auto'},\r\n    picksStyleDisabled: {backgroundColor: '#e9ecef'},\r\n\r\n    picksStyleFocus: {borderColor: '#80bdff', boxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)'},\r\n    picksStyleFocusValid: {boxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)'},\r\n    picksStyleFocusInvalid: {boxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)'},\r\n    \r\n    filterInputStyle: {color: 'inherit' /*#495057 for default BS*/, fontWeight : 'inherit'},\r\n\r\n    // used in BsAppearance\r\n    picksStyleDef: {minHeight: 'calc(2.25rem + 2px)'},\r\n    picksStyleLg:  {minHeight: 'calc(2.875rem + 2px)'},\r\n    picksStyleSm:  {minHeight: 'calc(1.8125rem + 2px)'},\r\n\r\n    // used in BsPickContentStylingCorrector\r\n    pickStyle: {paddingLeft: '0px', lineHeight: '1.5em'},\r\n    pickButtonStyle: {fontSize:'1.5em', lineHeight: '.9em'},\r\n    pickContentStyleDisabled: {opacity: '.65'},\r\n\r\n    // used in BsChoiceContentStylingCorrector\r\n    choiceLabelStyleDisabled: {color: '#6c757d'}\r\n};\r\n\r\n(\r\n    (window, $) => {\r\n        function createPlugin(element, settings, onDispose){\r\n            let configuration = $.extend({}, settings); // settings used per jQuery intialization, configuration per element\r\n            if (configuration.buildConfiguration)\r\n                configuration.buildConfiguration(element, configuration);\r\n            \r\n            let useCss = configuration.useCss;\r\n            let styling = configuration.styling;\r\n            if (!configuration.adapter)\r\n            {\r\n                let stylingCorrector = configuration.stylingCorrector;\r\n                if (!stylingCorrector)\r\n                {\r\n                    if (!useCss)\r\n                    {\r\n                        extendIfUndefined(configuration, stylingDefaults);\r\n                        stylingCorrector = StylingCorrector(configuration);\r\n                        var defFocusIn = stylingCorrector.focusIn;\r\n                        stylingCorrector.focusIn = (picksElement) => {\r\n                            if (picksElement.classList.contains(\"is-valid\")){\r\n                                setStyles(picksElement, configuration.picksStyleFocusValid)\r\n                            } else if (picksElement.classList.contains(\"is-invalid\")){\r\n                                setStyles(picksElement, configuration.picksStyleFocusInvalid)\r\n                            } else {\r\n                                defFocusIn(picksElement)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                extendIfUndefined(configuration, classesDefaults);\r\n                styling = Styling(configuration, stylingCorrector);\r\n            }\r\n\r\n            let optionsAdapter = null;\r\n            let containerAdapter = null;\r\n            if (configuration.optionsAdapter)\r\n                optionsAdapter = configuration.optionsAdapter;\r\n            else\r\n            {\r\n                var createElement = function(name){\r\n                    return window.document.createElement(name);\r\n                }\r\n                var trigger = function(eventName){\r\n                    $(element).trigger(eventName);\r\n                }\r\n                if (configuration.options){\r\n                    optionsAdapter = OptionsAdapterJson(\r\n                        configuration.options,\r\n                        configuration.getDisabled,\r\n                        configuration.getSize,\r\n                        configuration.getIsValid,\r\n                        configuration.getIsInvalid,\r\n                        trigger );\r\n                    if (!configuration.createInputId)\r\n                        configuration.createInputId = () => `${configuration.containerClass}-generated-filter-${element.id}`;\r\n                    // find direct child by tagName\r\n                    var picksElement = findDirectChildByTagName(element, \"UL\");\r\n                    containerAdapter = ContainerAdapter(createElement, null, element, picksElement);\r\n                } \r\n                else  \r\n                {\r\n                    var selectElement = null;\r\n                    var containerElement = null;\r\n                    if (element.tagName==\"SELECT\")\r\n                        selectElement = element;\r\n                    else \r\n                    { \r\n                        selectElement = findDirectChildByTagName(element, \"SELECT\");\r\n                        if (!selectElement)\r\n                            throw \"There are no SELECT element or options in the configuraion\";\r\n                        containerElement = element;\r\n                    }\r\n\r\n                    if (!containerElement && configuration.containerClass)\r\n                    {\r\n                        var $container = $(selectElement).closest('.'+configuration.containerClass);\r\n                        if ($container.length>0)\r\n                            containerElement =  $container.get(0);\r\n                    }\r\n\r\n                    if (!configuration.label)\r\n                    {\r\n                        let $formGroup = $(selectElement).closest('.form-group');\r\n                        if ($formGroup.length == 1) {\r\n                            let $label = $formGroup.find(`label[for=\"${selectElement.id}\"]`);\r\n                            if ($label.length>0)\r\n                            {   \r\n                                let label = $label.get(0);\r\n                                let forId = label.getAttribute('for');\r\n                                if (forId == selectElement.id) {\r\n                                    configuration.label = label;\r\n                                }\r\n                            }   \r\n                        }\r\n                    }\r\n                    var $form = $(selectElement).closest('form');\r\n                    var form = null;\r\n                    if ($form.length == 1) {\r\n                        form = $form.get(0);\r\n                    }\r\n                    \r\n                    if (!configuration.getDisabled) {\r\n                        var $fieldset = $(selectElement).closest('fieldset');\r\n                    \r\n                        if ($fieldset.length == 1) {\r\n                            var fieldset = $fieldset.get(0);\r\n                            configuration.getDisabled = () => selectElement.disabled || fieldset.disabled;\r\n                        }else{\r\n                            configuration.getDisabled = () => selectElement.disabled;\r\n                        }\r\n                    }\r\n\r\n                    if (!configuration.getSize) {\r\n                        configuration.getSize = function(){\r\n                            var value=null;\r\n                            if (selectElement.classList.contains('custom-select-lg') || selectElement.classList.contains('form-control-lg') )\r\n                                value='custom-select-lg';\r\n                            else if (selectElement.classList.contains('custom-select-sm')  || selectElement.classList.contains('form-control-sm')  )\r\n                                value='custom-select-sm';\r\n                            else if (containerElement && containerElement.classList.contains('input-group-lg'))\r\n                                value='input-group-lg';\r\n                            else if (containerElement && containerElement.classList.contains('input-group-sm'))\r\n                                value='input-group-sm';\r\n                            return value;\r\n                        }\r\n                    }\r\n                    if (!configuration.getIsValid) {\r\n                        configuration.getIsValid = function()\r\n                        { return selectElement.classList.contains('is-valid')}\r\n                    }\r\n                    if (!configuration.getIsInvalid) {\r\n                        configuration.getIsInvalid = function()\r\n                        { return selectElement.classList.contains('is-invalid')}\r\n                    }\r\n                    optionsAdapter = OptionsAdapterElement(selectElement, configuration.getDisabled, \r\n                        configuration.getSize, \r\n                        configuration.getIsValid, configuration.getIsInvalid,\r\n                        trigger, form);\r\n\r\n                    if (!configuration.createInputId)\r\n                        configuration.createInputId = () => `${configuration.containerClass}-generated-input-${((selectElement.id)?selectElement.id:selectElement.name).toLowerCase()}-id`;\r\n\r\n                    \r\n                    var picksElement = null;\r\n                    if (containerElement)\r\n                        picksElement = findDirectChildByTagName(containerElement, \"UL\");\r\n                    containerAdapter = ContainerAdapter(createElement, selectElement, containerElement, picksElement);\r\n                    \r\n                }\r\n            }\r\n            let labelAdapter = LabelAdapter(configuration.label, configuration.createInputId);\r\n\r\n            let pickContentGenerator = configuration.pickContentGenerator;\r\n            if (!pickContentGenerator){\r\n                let pickContentStylingCorrector = configuration.pickContentStylingCorrector;\r\n                if (!pickContentStylingCorrector)\r\n                {\r\n                    if (!useCss){\r\n                        var  {pickStyle, pickButtonStyle, pickContentStyleDisabled} = stylingDefaults;\r\n                        extendIfUndefined(configuration,  {pickStyle, pickButtonStyle, pickContentStyleDisabled});\r\n                        pickContentStylingCorrector=BsPickContentStylingCorrector(configuration, $);\r\n                    }\r\n                }\r\n                \r\n                var  {pickClass, pickRemoveButtonClass, pickContentClassDisabled} = classesDefaults;\r\n                extendIfUndefined(configuration, {pickClass, pickRemoveButtonClass, pickContentClassDisabled});\r\n                pickContentGenerator = BsPickContentGenerator(configuration, pickContentStylingCorrector, $);\r\n            }\r\n\r\n            let choiceContentGenerator = configuration.choiceContentGenerator;\r\n            if (!choiceContentGenerator){\r\n                let choiceContentStylingCorrector = configuration.choiceContentStylingCorrector;\r\n                if (!useCss){\r\n                    var {choiceLabelStyleDisabled} = stylingDefaults;\r\n                    extendIfUndefined(configuration, {choiceLabelStyleDisabled});\r\n                    choiceContentStylingCorrector=BsChoiceContentStylingCorrector(configuration, $);\r\n                }\r\n                \r\n                var  {choiceClass, choiceCheckBoxClassDisabled} = classesDefaults;\r\n                extendIfUndefined(configuration, {choiceClass, choiceCheckBoxClassDisabled});\r\n                choiceContentGenerator = BsChoiceContentGenerator(configuration, choiceContentStylingCorrector, $)\r\n            }\r\n\r\n            let createStylingComposite = function(pickFilterElement, inputElement, choicesElement){\r\n                return {\r\n                    container: containerAdapter.containerElement,\r\n                    picks: containerAdapter.picksElement,\r\n                    pickFilter: pickFilterElement,\r\n                    input: inputElement,\r\n                    choices: choicesElement\r\n                };\r\n            }\r\n            var placeholderText = configuration.placeholder;\r\n            if (!placeholderText)\r\n            {\r\n                if (selectElement)\r\n                {\r\n                    placeholderText = $(selectElement).data(\"bsmultiselect-placeholder\");\r\n                    if (!placeholderText)\r\n                        placeholderText = $(selectElement).data(\"placeholder\");\r\n                }\r\n                else if (containerElement)                 \r\n                {\r\n                    placeholderText = $(containerElement).data(\"bsmultiselect-placeholder\");\r\n                    if (!placeholderText)\r\n                        placeholderText = $(containerElement).data(\"placeholder\");\r\n                }\r\n            }\r\n            \r\n            let setSelected = configuration.setSelected;\r\n            if (!setSelected){\r\n                setSelected = (option, value)=> { option.selected = value;}\r\n            }\r\n\r\n            var bsAppearance =  createBsAppearance(containerAdapter.picksElement, configuration, optionsAdapter);\r\n\r\n            var onUpdate = () => {\r\n                bsAppearance.updateSize();\r\n                bsAppearance.updateIsValid();\r\n            }\r\n\r\n            let multiSelect = new MultiSelect(\r\n                optionsAdapter,\r\n                setSelected,\r\n                containerAdapter,\r\n                styling,\r\n                pickContentGenerator,\r\n                choiceContentGenerator,\r\n                labelAdapter,\r\n                createStylingComposite,\r\n                placeholderText,\r\n                configuration,\r\n                onUpdate,\r\n                onDispose,\r\n                window);\r\n            \r\n            multiSelect.UpdateSize = bsAppearance.updateSize;\r\n            multiSelect.UpdateIsValid = bsAppearance.updateIsValid;\r\n            \r\n            if (configuration.init)\r\n                configuration.init(element, multiSelect);\r\n            \r\n            multiSelect.init();\r\n\r\n            return multiSelect;\r\n        };\r\n        var defaults = {\r\n            classes: classesDefaults,\r\n            styling: stylingDefaults\r\n        };\r\n        addToJQueryPrototype('BsMultiSelect', createPlugin, defaults, $);\r\n    }\r\n)(window, $)\r\n"],"names":["extendIfUndefined","destination","source","property","undefined","createEmpty","value","removeElement","e","parentNode","removeChild","findDirectChildByTagName","element","tagName","returnValue","i","children","length","tmp","addClass","c","classList","add","removeClass","remove","addClasses","classes","modifyClasses","removeClasses","setStyles","styles","style","modify","Array","isArray","forEach","array","split","filterInputStyle","border","padding","outline","backgroundColor","FilterPanel","createElement","insertIntoDom","onFocusIn","onFocusOut","onKeyDownArrowUp","onKeyDownArrowDown","onTabForEmpty","onBackspace","onEnterOrTabToCompleate","onKeyDownEsc","onKeyUpEsc","onInput","setEmptyLength","filterInputElement","setAttribute","onfilterInputKeyDown","event","indexOf","which","preventDefault","onFilterInputKeyUp","onFilterInputInput","filterInputValue","width","addEventListener","setEmpty","isEmpty","setFocus","focus","isEventTarget","target","dispose","removeEventListener","choicesStyle","listStyleType","ChoicesPanel","choicesElement","onShow","onHide","eventSkipper","dropDownItemContent","getVisibleMultiSelectDataList","resetFilter","updateDropDownLocation","filterPanelSetFocus","hoveredMultiSelectData","hoveredMultiSelectDataIndex","candidateToHoveredMultiSelectData","hideDropDown","resetCandidateToHoveredMultiSelectData","display","showDropDown","setSkippable","hoverInInternal","index","DropDownItemContent","hoverIn","resetDropDownMenuHover","hoverOut","dropDownMenuItemElement","processCandidateToHovered","visibleIndex","toggleHovered","toggle","keyDownArrow","down","visibleMultiSelectDataList","newIndex","visible","onDropDownMenuItemElementMouseoverGeneral","MultiSelectData","isSkippable","insertDropDownItem","createSelectedItemGen","setSelected","triggerChange","isSelected","isOptionDisabled","onDropDownMenuItemElementMouseover","onDropDownMenuItemElementMouseleave","appendChild","content","option","DisposeDropDownMenuItemElement","setDropDownItemContentDisabled","disabledStyle","disable","onSelected","createSelectedItem","excludedFromSearch","confirmed","item","stopAndResetDropDownMenuHover","getIsVisble","picksStyle","flexWrap","PicksPanel","picksElement","init","pickContentGenerator","isComponentDisabled","onRemove","onClick","onPicksEmptyChanged","processRemoveButtonClick","picksCount","inc","dec","reset","pickFilterElement","MultiSelectDataSelectedTail","removePicksTail","removeSelectedFromList","selectedPrev","selectedNext","createPick","pickElement","removeSelectedItem","select","PickContent","removeSelectedItemAndCloseDropDown","onRemoveSelectedItemEvent","isDisabled","insertBefore","picksClick","iterateAll","resetMultiSelectDataSelectedTail","enable","toRemove","firstChild","MultiSelectInputAspect","window","appendToContainer","choiceFilterInputElement","hideDropDownAndResetFilter","isDropDownMenuEmpty","Popper","document","skipFocusout","skipoutMousedown","documentMouseup","contains","popper","placement","modifiers","preventOverflow","enabled","hide","flip","filterInputItemOffsetLeft","preventDefaultClickEvent","alignAndShowDropDown","alignToFilterInputItemLocation","force","offsetLeft","update","destroy","processUncheck","uncheckOption","setTimeout","onDropDownShow","onDropDownHide","getSkipFocusout","resetSkipFocusout","PlaceholderAspect","placeholderText","picksIsEmpty","filterIsEmpty","inputElement","setEmptyInputWidth","isVisible","showPlacehodler","placeholder","updatePlacehodlerVisibility","updateEmptyInputWidth","setDisabled","disabled","EventSkipper","filterMultiSelectData","isFiltered","resetDropDownMenu","MultiSelectDataList","multiSelectData","isHidden","collectFilterDropDownMenu","text","list","j","searchText","push","MultiSelect","optionsAdapter","containerAdapter","styling","choiceContentGenerator","labelAdapter","createStylingComposite","configuration","onUpdate","onDispose","TypeError","visibleCount","choicesPanel","stylingComposite","resetMultiSelectDataList","filteredMultiSelectDataList","filterPanel","processEmptyInput","placeholderAspect","GetContainer","containerElement","Update","UpdateDisabled","UpdateData","DeselectAll","SelectAll","empty","picksPanel","updateDataImpl","createDropDownItems","options","getOptions","selected","hidden","toLowerCase","trim","removeDropDownMenuItemElement","p1","p2","p3","o","aspect","readyState","createDropDownItemsHandler","Dispose","getDisabled","Disable","Enable","input","resetLength","fullMatchMultiSelectData","name","lazyfilterItemInputElementAtach","filterItemInputElement","filterItemElement","FocusIn","FocusOut","stopPropagation","doUncheck","Init","attachContainer","subscribeToReset","LabelAdapter","labelElement","createInputId","backupedForAttribute","getAttribute","newId","addToJQueryPrototype","pluginName","createPlugin","defaults","$","firstChar","charAt","firstCharLower","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","each","$e","instance","data","isMethodName","test","optionsObject","removeData","methodName","noConflict","OptionsAdapterElement","selectElement","getSize","getIsValid","getIsInvalid","trigger","form","backup","getElementsByTagName","handler","OptionsAdapterJson","StylingCorrector","resetDisable","picksStyleDisabled","resetFocus","picksStyleFocus","elements","picks","focusIn","focusOut","Styling","stylingCorrector","container","containerClass","picksClass","choices","choicesClass","pickFilter","pickFilterClass","filterInputClass","picksClassDisabled","picksClassFocus","BsPickContentStylingCorrector","disablePickContent","pickContentStyleDisabled","createPickContent","selectedItem","button","pickStyle","pickButtonStyle","BsPickContentGenerator","optionItem","$selectedItem","pickClass","$content","get","appendTo","pickContentClassDisabled","$button","css","pickRemoveButtonClass","on","jqEvent","originalEvent","prop","unbind","BsChoiceContentStylingCorrector","resetStyle","choiceLabelStyleDisabled","checkBox","checkBoxLabel","isDisbaled","BsChoiceContentGenerator","choiceElement","$choiceElement","choiceClass","$choiceContent","$checkBox","find","$checkBoxLabel","choiceCheckBoxClassDisabled","choiceClassHover","ContainerAdapter","ownContainerElement","ownPicksElement","backupDisplay","nextSibling","updateIsValid","isValid","isInvalid","updateSize","size","updateSizeJs","picksStyleLg","picksStyleSm","picksStyleDef","updateIsValidForAdapter","updateSizeForAdapter","updateSizeJsForAdapter","createBsAppearance","useCss","Object","create","classesDefaults","choiceClassSelected","choiceClassDisabled","pickClassDisabled","stylingDefaults","marginBottom","height","borderColor","boxShadow","picksStyleFocusValid","picksStyleFocusInvalid","color","fontWeight","minHeight","paddingLeft","lineHeight","fontSize","opacity","settings","extend","buildConfiguration","adapter","defFocusIn","eventName","id","$container","closest","label","$formGroup","$label","forId","$form","$fieldset","fieldset","pickContentStylingCorrector","choiceContentStylingCorrector","bsAppearance","multiSelect","UpdateSize","UpdateIsValid"],"mappings":";;;;;;;;;;;;;;IAAO,SAASA,iBAAT,CAA2BC,WAA3B,EAAwCC,MAAxC,EAAgD;IACnD,OAAK,IAAIC,QAAT,IAAqBD,MAArB;IACI,QAAID,WAAW,CAACE,QAAD,CAAX,KAA0BC,SAA9B,EACIH,WAAW,CAACE,QAAD,CAAX,GAAwBD,MAAM,CAACC,QAAD,CAA9B;IAFR;IAGH;AAED,IAAO,SAASE,WAAT,CAAqBH,MAArB,EAA6BI,KAA7B,EAAoC;IACvC,MAAIL,WAAW,GAAC,EAAhB;;IACA,OAAK,IAAIE,QAAT,IAAqBD,MAArB;IACKD,IAAAA,WAAW,CAACE,QAAD,CAAX,GAAwBG,KAAxB;IADL;;IAEA,SAAOL,WAAP;IACH;;ICXM,SAASM,aAAT,CAAuBC,CAAvB,EAA0B;IAACA,EAAAA,CAAC,CAACC,UAAF,CAAaC,WAAb,CAAyBF,CAAzB;IAA4B;AAE9D,IAAO,SAASG,wBAAT,CAAkCC,OAAlC,EAA2CC,OAA3C,EAAmD;IACtD,MAAIC,WAAW,GAAG,IAAlB;;IACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAACH,OAAO,CAACI,QAAR,CAAiBC,MAAnC,EAA2CF,CAAC,EAA5C,EACA;IACI,QAAIG,GAAG,GAAGN,OAAO,CAACI,QAAR,CAAiBD,CAAjB,CAAV;;IACA,QAAIG,GAAG,CAACL,OAAJ,IAAaA,OAAjB,EACA;IACIC,MAAAA,WAAW,GAAGI,GAAd;IACA;IACH;IACJ;;IACD,SAAOJ,WAAP;IACH;AAED,IAAO,SAASK,QAAT,CAAkBP,OAAlB,EAA2BQ,CAA3B,EAA6B;IAChCR,EAAAA,OAAO,CAACS,SAAR,CAAkBC,GAAlB,CAAsBF,CAAtB;IACH;AAED,IAAO,SAASG,WAAT,CAAqBX,OAArB,EAA8BQ,CAA9B,EAAgC;IACnCR,EAAAA,OAAO,CAACS,SAAR,CAAkBG,MAAlB,CAAyBJ,CAAzB;IACH;AAED,IAAO,SAASK,UAAT,CAAoBb,OAApB,EAA6Bc,OAA7B,EAAqC;IACxCC,EAAAA,aAAa,CAACD,OAAD,EAAU,UAAAlB,CAAC;IAAA,WAAEW,QAAQ,CAACP,OAAD,EAASJ,CAAT,CAAV;IAAA,GAAX,CAAb;IACH;AAED,IAAO,SAASoB,aAAT,CAAuBhB,OAAvB,EAAgCc,OAAhC,EAAwC;IAC3CC,EAAAA,aAAa,CAACD,OAAD,EAAU,UAAAlB,CAAC;IAAA,WAAEe,WAAW,CAACX,OAAD,EAASJ,CAAT,CAAb;IAAA,GAAX,CAAb;IACH;AAED,IAAO,SAASqB,SAAT,CAAmBjB,OAAnB,EAA4BkB,MAA5B,EAAmC;IACtC,OAAK,IAAI3B,QAAT,IAAqB2B,MAArB;IACIlB,IAAAA,OAAO,CAACmB,KAAR,CAAc5B,QAAd,IAA0B2B,MAAM,CAAC3B,QAAD,CAAhC;IADJ;IAEH;;IAGD,SAASwB,aAAT,CAAuBD,OAAvB,EAAgCM,MAAhC,EAAuC;IACnC,MAAIN,OAAJ,EAAY;IACR,QAAIO,KAAK,CAACC,OAAN,CAAcR,OAAd,CAAJ,EACIA,OAAO,CAACS,OAAR,CAAgB,UAAA3B,CAAC;IAAA,aAAIwB,MAAM,CAACxB,CAAD,CAAV;IAAA,KAAjB,EADJ,KAEI;IACA,UAAI4B,KAAK,GAAGV,OAAO,CAACW,KAAR,CAAc,GAAd,CAAZ;IACAD,MAAAA,KAAK,CAACD,OAAN,CAAc,UAAA3B,CAAC;IAAA,eAAIwB,MAAM,CAACxB,CAAD,CAAV;IAAA,OAAf;IACH;IACJ;IACJ;;IC7CD,IAAM8B,gBAAgB,GAAG;IAACC,EAAAA,MAAM,EAAC,KAAR;IAAeC,EAAAA,OAAO,EAAC,KAAvB;IAA8BC,EAAAA,OAAO,EAAC,MAAtC;IAA8CC,EAAAA,eAAe,EAAC;IAA9D,CAAzB;AAEA,IAAO,SAASC,WAAT,CACCC,aADD,EAECC,aAFD,EAGCC,SAHD;IAICC,UAJD;IAKCC,gBALD,EAMCC,kBAND,EAOCC,aAPD;IAQCC,WARD;IASCC,uBATD;IAUCC,YAVD,EAWCC,UAXD;IAYCC,OAZD;IAaCC,cAbD,EAcD;IAEF,MAAIC,kBAAkB,GAAGb,aAAa,CAAC,OAAD,CAAtC;IAEAa,EAAAA,kBAAkB,CAACC,YAAnB,CAAgC,MAAhC,EAAuC,QAAvC;IACAD,EAAAA,kBAAkB,CAACC,YAAnB,CAAgC,cAAhC,EAA+C,KAA/C;IAEA7B,EAAAA,SAAS,CAAC4B,kBAAD,EAAqBnB,gBAArB,CAAT;IAEAO,EAAAA,aAAa,CAACY,kBAAD,CAAb;;IAEA,MAAIE,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,KAAD,EAAW;IAClC,QAAI,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb,EAAiBC,OAAjB,CAAyBD,KAAK,CAACE,KAA/B,KAAuC,CAAvC,IACIF,KAAK,CAACE,KAAN,IAAe,CAAf,IAAoBL,kBAAkB,CAACnD,KAD/C,EACwD;IACpDsD,MAAAA,KAAK,CAACG,cAAN,GADoD;IAGpD;IACA;IACA;IACH;;IACD,QAAIH,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAwB;IACpBT,MAAAA,YAAY,CAACI,kBAAkB,CAACnD,KAAnB,GAAyB,KAAzB,GAA+B,IAAhC,EAAsCsD,KAAtC,CAAZ,CADoB;IAEvB,KAFD,MAGK,IAAIA,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAuB;IACxBd,MAAAA,gBAAgB;IACnB,KAFI,MAGA,IAAIY,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAuB;IACxBb,MAAAA,kBAAkB;IACrB,KAFI,MAGA,IAAIW,KAAK,CAACE,KAAN,IAAe;IAAG;IAAtB,MAA+B;IAAE;IAClC,YAAI,CAACL,kBAAkB,CAACnD,KAAxB,EAA+B;IAC1B4C,UAAAA,aAAa,GADa;IAE9B;IACJ,OAJI,MAKA,IAAIU,KAAK,CAACE,KAAN,IAAe;IAAE;IAArB,MAAoC;IACrC;IACA;IACA;IACA,YAAI,CAACL,kBAAkB,CAACnD,KAAxB,EACA;IACI6C,UAAAA,WAAW;IACd;IACJ;IAGJ,GAlCD;;IAoCA,MAAIa,kBAAkB,GAAG,SAArBA,kBAAqB,CAACJ,KAAD,EAAW;IAChC,QAAIA,KAAK,CAACE,KAAN,IAAe,EAAf,IAAqBF,KAAK,CAACE,KAAN,IAAe,CAAxC,EAA2C;IACvCV,MAAAA,uBAAuB;IAC1B,KAFD,MAGK,IAAIQ,KAAK,CAACE,KAAN,IAAe,EAAnB,EAAuB;IAAE;IAC1BR,MAAAA,UAAU,GADc;IAE3B;IACJ,GAPD,CA/CE;IAyDF;IACA;IACA;;;IACA,MAAIW,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;IAC3B,QAAIC,gBAAgB,GAAGT,kBAAkB,CAACnD,KAA1C;IACAiD,IAAAA,OAAO,CACHW,gBADG,EAEH;IAAA,aAAKT,kBAAkB,CAAC1B,KAAnB,CAAyBoC,KAAzB,GAAiCD,gBAAgB,CAACjD,MAAjB,GAAwB,GAAxB,GAA8B,CAA9B,GAAkC,IAAxE;IAAA,KAFG,CAAP;IAIH,GAND;;IAQAwC,EAAAA,kBAAkB,CAACW,gBAAnB,CAAoC,SAApC,EAA+CtB,SAA/C;IACAW,EAAAA,kBAAkB,CAACW,gBAAnB,CAAoC,UAApC,EAAgDrB,UAAhD;IACAU,EAAAA,kBAAkB,CAACW,gBAAnB,CAAoC,SAApC,EAA+CT,oBAA/C;IACAF,EAAAA,kBAAkB,CAACW,gBAAnB,CAAoC,OAApC,EAA6CJ,kBAA7C;IACAP,EAAAA,kBAAkB,CAACW,gBAAnB,CAAoC,OAApC,EAA6CH,kBAA7C,EAxEE;IA2EF;IACA;IACA;;IAEA,WAASI,QAAT,GAAmB;IACfZ,IAAAA,kBAAkB,CAACnD,KAAnB,GAA0B,EAA1B;IACAkD,IAAAA,cAAc;IACjB;IAED,SAAO;IACHC,IAAAA,kBAAkB,EAAlBA,kBADG;IAEHa,IAAAA,OAFG,qBAEM;IACL,aAAOb,kBAAkB,CAACnD,KAAnB,GAA2B,KAA3B,GAAiC,IAAxC;IACH,KAJE;IAKH+D,IAAAA,QAAQ,EAARA,QALG;IAMHb,IAAAA,cAAc,EAAdA,cANG;IAOHe,IAAAA,QAPG,sBAOO;IACNd,MAAAA,kBAAkB,CAACe,KAAnB;IACH,KATE;IAUHC,IAAAA,aAVG,yBAUWb,KAVX,EAUiB;IAChB,aAAOA,KAAK,CAACc,MAAN,IAAgBjB,kBAAvB;IACH,KAZE;IAaHkB,IAAAA,OAbG,qBAaM;IACLlB,MAAAA,kBAAkB,CAACmB,mBAAnB,CAAuC,SAAvC,EAAkD9B,SAAlD;IACAW,MAAAA,kBAAkB,CAACmB,mBAAnB,CAAuC,UAAvC,EAAmD7B,UAAnD;IACAU,MAAAA,kBAAkB,CAACmB,mBAAnB,CAAuC,SAAvC,EAAkDjB,oBAAlD;IACAF,MAAAA,kBAAkB,CAACmB,mBAAnB,CAAuC,OAAvC,EAAgDZ,kBAAhD;IACAP,MAAAA,kBAAkB,CAACmB,mBAAnB,CAAuC,OAAvC,EAAgDX,kBAAhD;IACH;IAnBE,GAAP;IAqBH;;ICzHD,IAAMY,YAAY,GAAG;IAACC,EAAAA,aAAa,EAAC;IAAf,CAArB;;AAEA,IAAO,SAASC,YAAT,CAAsBnC,aAAtB,EAAqCoC,cAArC,EAAqDC,MAArD,EAA6DC,MAA7D,EAAqEC,YAArE,EAAmFC,mBAAnF,EACCC,6BADD,EACgCC,WADhC,EAC6CC,sBAD7C,EACqEC,mBADrE,EAC0F;IAE7F;IACA3D,EAAAA,SAAS,CAACmD,cAAD,EAAiBH,YAAjB,CAAT;IACA,MAAIY,sBAAsB,GAAC,IAA3B;IACA,MAAIC,2BAA2B,GAAG,IAAlC;IACA,MAAIC,iCAAiC,GAAC,IAAtC;;IAEA,WAASC,YAAT,GAAwB;IACpB,QAAID,iCAAJ,EAAsC;IAClCE,MAAAA,sCAAsC;IACzC;;IACD,QAAIb,cAAc,CAACjD,KAAf,CAAqB+D,OAArB,IAAgC,MAApC,EACA;IACId,MAAAA,cAAc,CAACjD,KAAf,CAAqB+D,OAArB,GAA+B,MAA/B;IACAZ,MAAAA,MAAM;IACT;IACJ;;IAED,WAASa,YAAT,GAAwB;IACpB,QAAIf,cAAc,CAACjD,KAAf,CAAqB+D,OAArB,IAAgC,OAApC,EACA;IACIX,MAAAA,YAAY,CAACa,YAAb;IACAhB,MAAAA,cAAc,CAACjD,KAAf,CAAqB+D,OAArB,GAA+B,OAA/B;IACAb,MAAAA,MAAM;IACT;IACJ;;IAED,MAAIgB,eAAe,GAAG,SAAlBA,eAAkB,CAASC,KAAT,EAAe;IACjCR,IAAAA,2BAA2B,GAAGQ,KAA9B;IACAT,IAAAA,sBAAsB,GAAGJ,6BAA6B,GAAGa,KAAH,CAAtD;IACAT,IAAAA,sBAAsB,CAACU,mBAAvB,CAA2CC,OAA3C;IACH,GAJD;;IAMA,WAASC,sBAAT,GAAkC;IAC9B,QAAIZ,sBAAJ,EAA4B;IACxBA,MAAAA,sBAAsB,CAACU,mBAAvB,CAA2CG,QAA3C;IACAb,MAAAA,sBAAsB,GAAG,IAAzB;IACAC,MAAAA,2BAA2B,GAAG,IAA9B;IACH;IACJ;;IAED,MAAIG,sCAAsC,GAAG,SAAzCA,sCAAyC,GAAU;IACnDF,IAAAA,iCAAiC,CAACY,uBAAlC,CAA0D3B,mBAA1D,CAA8E,WAA9E,EAA2F4B,yBAA3F;IACAb,IAAAA,iCAAiC,CAACY,uBAAlC,CAA0D3B,mBAA1D,CAA8E,WAA9E,EAA2F4B,yBAA3F;IACAb,IAAAA,iCAAiC,GAAG,IAApC;IACH,GAJD;;IAMA,MAAIa,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAW;IACvC,QAAIf,sBAAsB,IAAIE,iCAA9B,EACA;IACIU,MAAAA,sBAAsB;IACtBJ,MAAAA,eAAe,CAACN,iCAAiC,CAACc,YAAnC,CAAf;IACH;;IACD,QAAGd,iCAAH,EACIE,sCAAsC;IAC7C,GARD;;IAUA,WAASa,aAAT,GAAwB;IACpB,QAAIjB,sBAAJ,EAA4B;IACxBA,MAAAA,sBAAsB,CAACkB,MAAvB;IACAN,MAAAA,sBAAsB;IACtBT,MAAAA,YAAY,GAHY;;IAIxBN,MAAAA,WAAW;IACd;IACJ;;IAED,WAASsB,YAAT,CAAsBC,IAAtB,EAA4B;IACxB,QAAIC,0BAA0B,GAAGzB,6BAA6B,EAA9D;IACA,QAAIpE,MAAM,GAAG6F,0BAA0B,CAAC7F,MAAxC;IACA,QAAI8F,QAAQ,GAAC,IAAb;;IACA,QAAI9F,MAAM,GAAG,CAAb,EAAgB;IACZ,UAAI4F,IAAJ,EAAU;IACN,YAAI9F,CAAC,GAAG2E,2BAA2B,IAAE,IAA7B,GAAkC,CAAlC,GAAoCA,2BAA2B,GAAC,CAAxE;;IACA,eAAM3E,CAAC,GAACE,MAAR,EAAe;IACX,cAAI6F,0BAA0B,CAAC/F,CAAD,CAA1B,CAA8BiG,OAAlC,EAA0C;IACtCD,YAAAA,QAAQ,GAAChG,CAAT;IACA;IACH;;IACDA,UAAAA,CAAC;IACJ;IACJ,OATD,MASO;IACH,YAAIA,EAAC,GAAG2E,2BAA2B,IAAE,IAA7B,GAAkCzE,MAAM,GAAC,CAAzC,GAA2CyE,2BAA2B,GAAC,CAA/E;;IACA,eAAM3E,EAAC,IAAE,CAAT,EAAW;IACP,cAAI+F,0BAA0B,CAAC/F,EAAD,CAA1B,CAA8BiG,OAAlC,EAA0C;IACtCD,YAAAA,QAAQ,GAAChG,EAAT;IACA;IACH;;IACDA,UAAAA,EAAC;IACJ;IACJ;IACJ;;IAED,QAAIgG,QAAQ,IAAE,IAAd,EACA;IACI,UAAItB,sBAAJ,EACIA,sBAAsB,CAACU,mBAAvB,CAA2CG,QAA3C,GAFR;;IAIIf,MAAAA,sBAAsB;IACtBQ,MAAAA,YAAY;IACZE,MAAAA,eAAe,CAACc,QAAD,CAAf;IACH;IACJ;;IAED,MAAIE,yCAAyC,GAAG,SAA5CA,yCAA4C,CAASC,eAAT,EAA0BX,uBAA1B,EAChD;IACI,QAAIpB,YAAY,CAACgC,WAAb,EAAJ,EACA;IACI,UAAGxB,iCAAH,EACIE,sCAAsC;IAE1CF,MAAAA,iCAAiC,GAAGuB,eAApC;IACAX,MAAAA,uBAAuB,CAACnC,gBAAxB,CAAyC,WAAzC,EAAsDoC,yBAAtD;IACAD,MAAAA,uBAAuB,CAACnC,gBAAxB,CAAyC,WAAzC,EAAsDoC,yBAAtD;IACH,KARD,MAUA;IACI,UAAIf,sBAAsB,IAAEyB,eAA5B,EACA;IACI;IACA;IACA;IACAb,QAAAA,sBAAsB;IACtBJ,QAAAA,eAAe,CAACiB,eAAe,CAACT,YAAjB,CAAf;IACH;IACJ;IACJ,GAtBD;;IAwBA,WAASW,kBAAT,CAA4BF,eAA5B,EAA6CG,qBAA7C,EAAoEC,WAApE,EAAiFC,aAAjF,EAAgGC,UAAhG,EAA4GC,gBAA5G,EAA8H;IAC1H,QAAIlB,uBAAuB,GAAG3D,aAAa,CAAC,IAAD,CAA3C,CAD0H;IAI1H;IACA;IACA;;IAEA,QAAI8E,kCAAkC,GAAG,SAArCA,kCAAqC;IAAA,aAAMT,yCAAyC,CACpFC,eADoF,EAEpFX,uBAFoF,CAA/C;IAAA,KAAzC;;IAKAA,IAAAA,uBAAuB,CAACnC,gBAAxB,CAAyC,WAAzC,EAAsDsD,kCAAtD,EAb0H;IAgB1H;;IACA,QAAIC,mCAAmC,GAAG,SAAtCA,mCAAsC,GAAM;IAC5C,UAAI,CAACxC,YAAY,CAACgC,WAAb,EAAL,EAAiC;IAC7Bd,QAAAA,sBAAsB;IACzB;IACJ,KAJD;;IAMAE,IAAAA,uBAAuB,CAACnC,gBAAxB,CAAyC,YAAzC,EAAuDuD,mCAAvD;IAEA3C,IAAAA,cAAc,CAAC4C,WAAf,CAA2BrB,uBAA3B;IAEA,QAAIsB,OAAO,GAAGzC,mBAAmB,CAACmB,uBAAD,EAA0BW,eAAe,CAACY,MAA1C,CAAjC;IACAZ,IAAAA,eAAe,CAACX,uBAAhB,GAA0CA,uBAA1C;IACAW,IAAAA,eAAe,CAACf,mBAAhB,GAAsC0B,OAAtC;;IAEAX,IAAAA,eAAe,CAACa,8BAAhB,GAAiD,YAAK;IAClDxB,MAAAA,uBAAuB,CAAC3B,mBAAxB,CAA4C,WAA5C,EAA0D8C,kCAA1D;IACAnB,MAAAA,uBAAuB,CAAC3B,mBAAxB,CAA4C,YAA5C,EAA0D+C,mCAA1D;IACH,KAHD;;IAKA,QAAIK,8BAA8B,GAAG,SAAjCA,8BAAiC,CAACH,OAAD,EAAWL,UAAX,EAA0B;IAC3DK,MAAAA,OAAO,CAACI,aAAR,CAAsB,IAAtB,EAD2D;;IAG3DJ,MAAAA,OAAO,CAACK,OAAR,CAAgB,CAACV,UAAjB;IACH,KAJD;;IAMA,QAAIC,gBAAJ,EACIO,8BAA8B,CAACH,OAAD,EAAUL,UAAV,CAA9B;IAEJK,IAAAA,OAAO,CAACM,UAAR,CAAoB,YAAM;IACtBjB,MAAAA,eAAe,CAACP,MAAhB;IACAnB,MAAAA,mBAAmB;IACtB,KAHD,EA7C0H;;IAmD1H,QAAI4C,kBAAkB,GAAG,SAArBA,kBAAqB;IAAA,aAAMf,qBAAqB,CAChDH,eADgD,EAEhDO,gBAFgD,EAGhD;IAAA,eAAMO,8BAA8B,CAACH,OAAD,EAAU,KAAV,CAApC;IAAA,OAHgD,CAA3B;IAAA,KAAzB;;IAMA,QAAIL,UAAJ,EACA;IACIY,MAAAA,kBAAkB;IACrB,KAHD,MAKA;IACIlB,MAAAA,eAAe,CAACmB,kBAAhB,GAAsCZ,gBAAtC;IACA,UAAIA,gBAAJ,EACIP,eAAe,CAACP,MAAhB,GAAyB,YAAM,EAA/B,CADJ,KAGIO,eAAe,CAACP,MAAhB,GAAyB,YAAO;IAC5B,YAAI2B,SAAS,GAAGhB,WAAW,CAACJ,eAAe,CAACY,MAAjB,EAAyB,IAAzB,CAA3B;;IACA,YAAIQ,SAAS,IAAE,IAAX,IAAmBA,SAAvB,EAAkC;IAC9BF,UAAAA,kBAAkB;IAClBb,UAAAA,aAAa;IAChB;IACJ,OAND;IAOP,KA1EyH;;IA4E7H;;IAED,MAAIgB,IAAI,GAAG;IACPtC,IAAAA,eAAe,EAAfA,eADO;IAEPuC,IAAAA,6BAFO,2CAEwB;IAC3BrD,MAAAA,YAAY,CAACa,YAAb,GAD2B;;IAE3BK,MAAAA,sBAAsB;IACzB,KALM;IAMPN,IAAAA,YAAY,EAAZA,YANO;IAOPH,IAAAA,YAAY,EAAZA,YAPO;IAQPc,IAAAA,aAAa,EAAbA,aARO;IASPE,IAAAA,YAAY,EAAZA,YATO;IAUPQ,IAAAA,kBAAkB,EAAlBA,kBAVO;IAWPqB,IAAAA,WAXO,yBAWM;IACT,aAAOzD,cAAc,CAACjD,KAAf,CAAqB+D,OAArB,IAAgC,MAAvC;IACH;IAbM,GAAX;IAgBA,SAAOyC,IAAP;IACH;;IClOD,IAAMG,UAAU,GAAG;IAAC5C,EAAAA,OAAO,EAAC,MAAT;IAAiB6C,EAAAA,QAAQ,EAAC,MAA1B;IAAkC7D,EAAAA,aAAa,EAAC;IAAhD,CAAnB;;AAEA,IAAO,SAAS8D,UAAT,CACCtB,WADD,EAEC1E,aAFD,EAGCiG,YAHD,EAICC,IAJD,EAKCC,oBALD,EAMCC,mBAND,EAOCzB,aAPD,EAQC0B,QARD,EASCC,OATD,EAUCC,mBAVD;IAWCC,wBAXD,EAaP;IACI,MAAIC,UAAU,GAAG,CAAjB;;IACA,WAASC,GAAT,GAAc;IAACD,IAAAA,UAAU;IAAI,QAAIA,UAAU,IAAE,CAAhB,EAAmBF,mBAAmB;IAAG;;IACtE,WAASI,GAAT,GAAc;IAACF,IAAAA,UAAU;IAAI,QAAIA,UAAU,IAAE,CAAhB,EAAmBF,mBAAmB;IAAG;;IACtE,WAASK,KAAT,GAAgB;IAACH,IAAAA,UAAU,GAAC,CAAX;IAAcF,IAAAA,mBAAmB;IAAG;;IACrD,WAAS7E,OAAT,GAAkB;IAAC,WAAO+E,UAAU,IAAE,CAAnB;IAAqB;IAExCxH,EAAAA,SAAS,CAACgH,YAAD,EAAeH,UAAf,CAAT;IAEA,MAAIe,iBAAiB,GAAG7G,aAAa,CAAC,IAAD,CAArC,CATJ;;IAWIiG,EAAAA,YAAY,CAACjB,WAAb,CAAyB6B,iBAAzB,EAXJ;;IAaIX,EAAAA,IAAI,CAACW,iBAAD,CAAJ;IACA,MAAIC,2BAA2B,GAAG,IAAlC;;IAEA,WAASC,eAAT,GAA0B;IACtB,QAAID,2BAAJ,EAAgC;IAC5BA,MAAAA,2BAA2B,CAAC/C,MAA5B,GAD4B;IAE/B;IACJ;;IAED,WAASiD,sBAAT,CAAgC1C,eAAhC,EAAgD;IAC5C,QAAIA,eAAe,CAAC2C,YAApB,EAAiC;IAC5B3C,MAAAA,eAAe,CAAC2C,YAAjB,CAA+BC,YAA/B,GAA8C5C,eAAe,CAAC4C,YAA9D;IACH;;IACD,QAAI5C,eAAe,CAAC4C,YAApB,EAAiC;IAC7B5C,MAAAA,eAAe,CAAC4C,YAAjB,CAA+BD,YAA/B,GAA8C3C,eAAe,CAAC2C,YAA9D;IACF;;IACD,QAAIH,2BAA2B,IAAIxC,eAAnC,EAAmD;IAC/CwC,MAAAA,2BAA2B,GAAGxC,eAAe,CAAC2C,YAA9C;IACH;;IACD3C,IAAAA,eAAe,CAAC4C,YAAhB,GAA6B,IAA7B;IACA5C,IAAAA,eAAe,CAAC2C,YAAhB,GAA6B,IAA7B;IACH;;IAGD,WAASE,UAAT,CAAoB7C,eAApB,EAAqCO,gBAArC,EAAuDO,8BAAvD,EAAuF;IAEnF,QAAIgC,WAAW,GAAGpH,aAAa,CAAC,IAAD,CAA/B;IACAsE,IAAAA,eAAe,CAAC8C,WAAhB,GAA8BA,WAA9B;;IACA,QAAIN,2BAAJ,EAAgC;IAC5BA,MAAAA,2BAA2B,CAACI,YAA5B,GAA2C5C,eAA3C;IACAA,MAAAA,eAAe,CAAC2C,YAAhB,GAA+BH,2BAA/B;IACH;;IACDA,IAAAA,2BAA2B,GAAGxC,eAA9B;;IAEA,QAAI+C,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;IAC3B,UAAI3B,SAAS,GAAGhB,WAAW,CAACJ,eAAe,CAACY,MAAjB,EAAyB,KAAzB,CAA3B;;IACA,UAAIQ,SAAS,IAAE,IAAX,IAAmBA,SAAvB,EAAkC;IAC9BpB,QAAAA,eAAe,CAACmB,kBAAhB,GAAqCZ,gBAArC;;IACA,YAAIA,gBAAJ,EACA;IACIO,UAAAA,8BAA8B,CAACd,eAAe,CAACf,mBAAjB,EAAsC,KAAtC,CAA9B;;IACAe,UAAAA,eAAe,CAACP,MAAhB,GAAyB,YAAK,EAA9B;IACH,SAJD,MAMA;IACIO,UAAAA,eAAe,CAACP,MAAhB,GAAyB,YAAI;IACzB,gBAAI2B,SAAS,GAAGhB,WAAW,CAACJ,eAAe,CAACY,MAAjB,EAAyB,IAAzB,CAA3B;;IACA,gBAAIQ,SAAS,IAAE,IAAX,IAAmBA,SAAvB,EAAiC;IAC7ByB,cAAAA,UAAU,CAAC7C,eAAD,EAAkBO,gBAAlB,EAAoCO,8BAApC,CAAV;IACAT,cAAAA,aAAa;IAChB;IACJ,WAND;IAOH;;IACDL,QAAAA,eAAe,CAACf,mBAAhB,CAAoC+D,MAApC,CAA2C,KAA3C;IACA3J,QAAAA,aAAa,CAACyJ,WAAD,CAAb;IACA9C,QAAAA,eAAe,CAACiD,WAAhB,CAA4BxF,OAA5B;IACAuC,QAAAA,eAAe,CAACiD,WAAhB,GAA4B,IAA5B;IACAjD,QAAAA,eAAe,CAAC8C,WAAhB,GAA4B,IAA5B;IAEAJ,QAAAA,sBAAsB,CAAC1C,eAAD,CAAtB;IACAqC,QAAAA,GAAG;IACHhC,QAAAA,aAAa;IAChB;IACJ,KA7BD,CAVmF;IA0CnF;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;;IAEA,QAAI6C,kCAAkC,GAAG,SAArCA,kCAAqC,GAAM;IAC3CH,MAAAA,kBAAkB;IAClBhB,MAAAA,QAAQ;IACX,KAHD;;IAKA,QAAIoB,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACzG,KAAD,EAAW;IACvCwF,MAAAA,wBAAwB,CAAC;IAAA,eAAMgB,kCAAkC,EAAxC;IAAA,OAAD,EAA6CxG,KAA7C,CAAxB;IACH,KAFD;;IAIAsD,IAAAA,eAAe,CAACiD,WAAhB,GAA8BpB,oBAAoB,CAC9CiB,WAD8C,EAE9C9C,eAAe,CAACY,MAF8B,EAG9CuC,yBAH8C,CAAlD;;IAKA,QAAInC,OAAO,GAAG,SAAVA,OAAU,CAACoC,UAAD;IAAA,aACVpD,eAAe,CAACiD,WAAhB,CAA4BjC,OAA5B,CAAoCoC,UAApC,CADU;IAAA,KAAd;;IAEApC,IAAAA,OAAO,CAACc,mBAAD,CAAP;IAEA9B,IAAAA,eAAe,CAACmB,kBAAhB,GAAqC,IAArC,CAxEmF;;IAyEnFnB,IAAAA,eAAe,CAACgB,OAAhB,GAA0BA,OAA1B;IACAW,IAAAA,YAAY,CAAC0B,YAAb,CAA0BP,WAA1B,EAAuCP,iBAAvC;;IAEAvC,IAAAA,eAAe,CAACP,MAAhB,GAAyB;IAAA,aAAMsD,kBAAkB,EAAxB;IAAA,KAAzB;;IACA/C,IAAAA,eAAe,CAACf,mBAAhB,CAAoC+D,MAApC,CAA2C,IAA3C;IACAZ,IAAAA,GAAG;IACN;;IAED,MAAIkB,UAAU,GAAG,SAAbA,UAAa,CAAA5G,KAAK,EAAI;IACtBsF,IAAAA,OAAO,CAACtF,KAAD,CAAP;IACH,GAFD;;IAIA,WAAS6G,UAAT,CAAoBH,UAApB,EAA+B;IAC3B,QAAIvJ,CAAC,GAAG2I,2BAAR;;IACA,WAAM3I,CAAN,EAAQ;IACJA,MAAAA,CAAC,CAACmH,OAAF,CAAUoC,UAAV;IACAvJ,MAAAA,CAAC,GAAGA,CAAC,CAAC8I,YAAN;IACH;IACJ;;IAED,MAAItB,IAAI,GAAG;IACPkB,IAAAA,iBAAiB,EAAjBA,iBADO;IAEPM,IAAAA,UAAU,EAAVA,UAFO;IAGPJ,IAAAA,eAAe,EAAfA,eAHO;IAIPe,IAAAA,gCAJO,8CAI4B;IAC/BlB,MAAAA,KAAK;IACLE,MAAAA,2BAA2B,GAAG,IAA9B;IACH,KAPM;IAQPpF,IAAAA,OAAO,EAAPA,OARO;IASPqG,IAAAA,MATO,oBASC;IACJ3B,MAAAA,mBAAmB,GAAE,KAArB;IACAyB,MAAAA,UAAU,CAAC,KAAD,CAAV;IACA5B,MAAAA,YAAY,CAACzE,gBAAb,CAA8B,OAA9B,EAAuCoG,UAAvC;IAEH,KAdM;IAePtC,IAAAA,OAfO,qBAeE;IACLc,MAAAA,mBAAmB,GAAE,IAArB;IACAyB,MAAAA,UAAU,CAAC,IAAD,CAAV;IACA5B,MAAAA,YAAY,CAACjE,mBAAb,CAAiC,OAAjC,EAA0C4F,UAA1C;IAEH,KApBM;IAqBP7F,IAAAA,OArBO,qBAqBE;IACL,UAAIiG,QAAQ,GAAG/B,YAAY,CAACgC,UAA5B;;IACA,aAAOD,QAAP,EAAkB;IACd/B,QAAAA,YAAY,CAACnI,WAAb,CAA0BkK,QAA1B;IACAA,QAAAA,QAAQ,GAAG/B,YAAY,CAACgC,UAAxB;IACH;;IACDhC,MAAAA,YAAY,CAACjE,mBAAb,CAAiC,OAAjC,EAA0C4F,UAA1C,EANK;IAOR;IA5BM,GAAX;IA+BA,SAAOjC,IAAP;IACH;;ICnLM,SAASuC,sBAAT,CACHC,MADG,EAEHC,iBAFG,EAGHC,wBAHG,EAIHpC,YAJG,EAKH7D,cALG,EAMHe,YANG,EAOHmF,0BAPG,EAQHC,mBARG,EASHC,MATG,EAUD;IACEJ,EAAAA,iBAAiB;IACjB,MAAIK,QAAQ,GAAGN,MAAM,CAACM,QAAtB;IAEJ,MAAIC,YAAY,GAAG,KAAnB,CAJE;;IAOF,MAAIC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAW;IAC7BD,IAAAA,YAAY,GAAG,IAAf;IACJ,GAFD;;IAIA,MAAIE,eAAe,GAAG,SAAlBA,eAAkB,CAAS5H,KAAT,EAAgB;IAClC;IACA,QAAM,EAAEoB,cAAc,KAAKpB,KAAK,CAACc,MAAzB,IACGmE,YAAY,KAAKjF,KAAK,CAACc,MAD1B,IAEGM,cAAc,CAACyG,QAAf,CAAwB7H,KAAK,CAACc,MAA9B,CAFH,IAGGmE,YAAY,CAAC4C,QAAb,CAAsB7H,KAAK,CAACc,MAA5B,CAHL,CAAN,EAKM;IACFwG,MAAAA,0BAA0B;IAC7B;IACJ,GAVD;;IAYA,MAAIQ,MAAM,GAAG,IAAIN,MAAJ,CACTH,wBADS,EAETjG,cAFS,EAGT;IACI2G,IAAAA,SAAS,EAAE,cADf;IAEIC,IAAAA,SAAS,EAAE;IACPC,MAAAA,eAAe,EAAE;IAACC,QAAAA,OAAO,EAAC;IAAT,OADV;IAEPC,MAAAA,IAAI,EAAE;IAACD,QAAAA,OAAO,EAAC;IAAT,OAFC;IAGPE,MAAAA,IAAI,EAAE;IAACF,QAAAA,OAAO,EAAC;IAAT;IAHC;IAFf,GAHS,CAAb;IAaA,MAAIG,yBAAyB,GAAG,IAAhC,CApCE;;IAqCF,MAAIC,wBAAwB,GAAG,IAA/B;;IAEA,WAASC,oBAAT,CAA8BvI,KAA9B,EAAoC;IAChC,QAAIsI,wBAAwB,IAAItI,KAAhC,EAAuC;IACnC,UAAI,CAACuH,mBAAmB,EAAxB,EACA;IACIiB,QAAAA,8BAA8B,CAAC,IAAD,CAA9B;IACArG,QAAAA,YAAY;IACf;IACJ;;IACDmG,IAAAA,wBAAwB,GAAC,IAAzB;IACH;;IAED,WAASE,8BAAT,CAAwCC,KAAxC,EAA+C;IAC3C,QAAIC,UAAU,GAAGrB,wBAAwB,CAACqB,UAA1C;;IACA,QAAID,KAAK,IAAIJ,yBAAyB,IAAIK,UAA1C,EAAqD;IAAE;IACnDZ,MAAAA,MAAM,CAACa,MAAP;IACAN,MAAAA,yBAAyB,GAAGK,UAA5B;IACH;IACJ;;IAED,SAAO;IACH3H,IAAAA,OADG,qBACM;IACL+G,MAAAA,MAAM,CAACc,OAAP;IACH,KAHE;IAIHJ,IAAAA,8BAA8B,EAA9BA,8BAJG;IAKHD,IAAAA,oBAAoB,EAApBA,oBALG;IAMHM,IAAAA,cANG,0BAMYC,aANZ,EAM2B9I,KAN3B,EAMiC;IAChC;IACA;IAEAmH,MAAAA,MAAM,CAAC4B,UAAP,CAAkB;IAAA,eAAID,aAAa,EAAjB;IAAA,OAAlB,EAAsC,CAAtC;IACAR,MAAAA,wBAAwB,GAAGtI,KAA3B,CALgC;IAMnC,KAZE;IAaHgJ,IAAAA,cAbG,4BAaa;IACZ;IACA;IAEA/D,MAAAA,YAAY,CAACzE,gBAAb,CAA8B,WAA9B,EAA2CmH,gBAA3C;IACAvG,MAAAA,cAAc,CAACZ,gBAAf,CAAgC,WAAhC,EAA6CmH,gBAA7C;IACAF,MAAAA,QAAQ,CAACjH,gBAAT,CAA0B,SAA1B,EAAqCoH,eAArC;IAEH,KArBE;IAsBHqB,IAAAA,cAtBG,4BAsBa;IACZhE,MAAAA,YAAY,CAACjE,mBAAb,CAAiC,WAAjC,EAA8C2G,gBAA9C;IACAvG,MAAAA,cAAc,CAACZ,gBAAf,CAAgC,WAAhC,EAA6CmH,gBAA7C;IACAF,MAAAA,QAAQ,CAACzG,mBAAT,CAA6B,SAA7B,EAAwC4G,eAAxC;IACH,KA1BE;IA2BHsB,IAAAA,eAAe,EAAG,2BAAW;IACxB,aAAOxB,YAAP;IACJ,KA7BE;IA8BHyB,IAAAA,iBAAiB,EAAG,6BAAW;IAC1BzB,MAAAA,YAAY,GAAC,KAAb;IACJ;IAhCE,GAAP;IAkCH;;ICtGM,SAAS0B,iBAAT,CAA2BC,eAA3B,EAA4CC,YAA5C,EAA0DC,aAA1D,EAAyEtE,YAAzE,EAAuFuE,YAAvF,EAAqG;IACxG,WAASC,kBAAT,CAA4BC,SAA5B,EAAsC;IAClC,QAAGA,SAAH,EACIF,YAAY,CAACrL,KAAb,CAAmBoC,KAAnB,GAAyB,MAAzB,CADJ,KAGIiJ,YAAY,CAACrL,KAAb,CAAmBoC,KAAnB,GAAyB,KAAzB;IACP;;IAED,WAASoJ,eAAT,CAAyBD,SAAzB,EAAmC;IAC/B,QAAIA,SAAJ,EACA;IACIF,MAAAA,YAAY,CAACI,WAAb,GAA2BP,eAAe,GAACA,eAAD,GAAiB,EAA3D;IACApE,MAAAA,YAAY,CAAC9G,KAAb,CAAmB+D,OAAnB,GAA4B,OAA5B;IACH,KAJD,MAMA;IACIsH,MAAAA,YAAY,CAACI,WAAb,GAA2B,EAA3B;IACA3E,MAAAA,YAAY,CAAC9G,KAAb,CAAmB+D,OAAnB,GAA4B,MAA5B;IACH;;IACDuH,IAAAA,kBAAkB,CAACC,SAAD,CAAlB;IACH;;IACDC,EAAAA,eAAe,CAAC,IAAD,CAAf;IAEA,SAAO;IACHzE,IAAAA,IADG,kBACG,EADH;IAGH2E,IAAAA,2BAHG,yCAG0B;IACzBF,MAAAA,eAAe,CAACL,YAAY,MAAMC,aAAa,EAAhC,CAAf;IACH,KALE;IAMHO,IAAAA,qBANG,mCAMoB;IACnBL,MAAAA,kBAAkB,CAACH,YAAY,MAAMC,aAAa,EAAhC,CAAlB;IACH,KARE;IASHQ,IAAAA,WATG,uBASSrD,UATT,EAUH;IACI8C,MAAAA,YAAY,CAACQ,QAAb,GAAwBtD,UAAxB;IACH;IAZE,GAAP;IAcH;;ICrCM,SAASuD,YAAT,CAAsB9C,MAAtB,EAA8B;IACjC,MAAI5D,YAAW,GAAG,KAAlB;IACA,SAAO;IACHA,IAAAA,WADG,yBACU;IACT,aAAOA,YAAP;IACH,KAHE;IAIHnB,IAAAA,YAJG,0BAIW;IACVmB,MAAAA,YAAW,GAAG,IAAd;IACA4D,MAAAA,MAAM,CAAC4B,UAAP,CACI,YAAM;IACFxF,QAAAA,YAAW,GAAG,KAAd;IACH,OAHL,EAGO,CAHP;IAIH;IAVE,GAAP;IAYH;;ICJD,SAAS2G,qBAAT,CAA+B5G,eAA/B,EAAgD6G,UAAhD,EAA4DtH,YAA5D,EAA0E;IACtES,EAAAA,eAAe,CAACF,OAAhB,GAA0B+G,UAA1B;IACA7G,EAAAA,eAAe,CAACT,YAAhB,GAA+BA,YAA/B;IACAS,EAAAA,eAAe,CAACX,uBAAhB,CAAwCxE,KAAxC,CAA8C+D,OAA9C,GAAwDiI,UAAU,GAAG,OAAH,GAAY,MAA9E;IACH;;IAED,SAASC,iBAAT,CAA2BC,mBAA3B,EAAgD;IAC5C,OAAI,IAAIlN,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACkN,mBAAmB,CAAChN,MAAnC,EAA2CF,CAAC,EAA5C,EACA;IACI,QAAImN,eAAe,GAAGD,mBAAmB,CAAClN,CAAD,CAAzC;;IACA,QAAK,CAACmN,eAAe,CAACC,QAAtB,EACA;IACIL,MAAAA,qBAAqB,CAACI,eAAD,EAAkB,IAAlB,EAAwBnN,CAAxB,CAArB;IACH;IACJ;IACJ;;IAED,SAASqN,yBAAT,CAAmCH,mBAAnC,EAAwDI,IAAxD,EAA8D;IAC1D,MAAIC,IAAI,GAAG,EAAX;IACA,MAAIC,CAAC,GAAG,CAAR;;IACA,OAAI,IAAIxN,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACkN,mBAAmB,CAAChN,MAAnC,EAA2CF,CAAC,EAA5C,EACA;IACI,QAAImN,eAAe,GAAGD,mBAAmB,CAAClN,CAAD,CAAzC;;IACA,QAAK,CAACmN,eAAe,CAACC,QAAtB,EACA;IACI,UAAKD,eAAe,CAAC7F,kBAAhB,IAAsC6F,eAAe,CAACM,UAAhB,CAA2B3K,OAA3B,CAAmCwK,IAAnC,IAAyC,CAApF,EACA;IACIP,QAAAA,qBAAqB,CAACI,eAAD,EAAkB,KAAlB,CAArB;IACH,OAHD,MAKA;IACIJ,QAAAA,qBAAqB,CAACI,eAAD,EAAkB,IAAlB,EAAwBK,CAAC,EAAzB,CAArB;IACAD,QAAAA,IAAI,CAACG,IAAL,CAAWP,eAAX;IACH;IACJ;IACJ;;IACD,SAAOI,IAAP;IACH;;AAED,QAAaI,WAAb;IAAA;IAAA;IAEI,uBAAYC,cAAZ,EAA4BrH,WAA5B,EAAyCsH,gBAAzC,EAA2DC,OAA3D,EACI9F,oBADJ,EAC0B+F,sBAD1B,EAEIC,YAFJ,EAEkBC,sBAFlB,EAE0C/B,eAF1C,EAGIgC,aAHJ,EAGmBC,QAHnB,EAG6BC,SAH7B,EAGwCpE,MAHxC,EAGgD;IAC5C,QAAI,OAAOK,MAAP,KAAkB,WAAtB,EAAmC;IAC/B,YAAM,IAAIgE,SAAJ,CAAc,uEAAd,CAAN;IACH;;IACD,SAAKF,QAAL,GAAgBA,QAAhB;IACA,SAAKC,SAAL,GAAiBA,SAAjB,CAL4C;;IAQ5C,SAAKR,cAAL,GAAsBA,cAAtB;IACA,SAAKC,gBAAL,GAAwBA,gBAAxB;IACA,SAAKC,OAAL,GAAeA,OAAf;IACA,SAAK9F,oBAAL,GAA4BA,oBAA5B;IACA,SAAK+F,sBAAL,GAA8BA,sBAA9B;IACA,SAAKC,YAAL,GAAoBA,YAApB;IACA,SAAKC,sBAAL,GAA8BA,sBAA9B;IACA,SAAKC,aAAL,GAAqBA,aAArB;IACA,SAAKhC,eAAL,GAAuBA,eAAvB;IACA,SAAK3F,WAAL,GAAiBA,WAAjB,CAjB4C;;IAkB5C,SAAKyD,MAAL,GAAcA,MAAd;IAEA,SAAKsE,YAAL,GAAkB,EAAlB;IAEA,SAAKC,YAAL,GAAoB,IAApB;IAEA,SAAKC,gBAAL,GAAwB,IAAxB;IAEA,SAAKvG,mBAAL,GAA2B,IAA3B;IAEA,SAAKwG,wBAAL;IACH;;IAlCL;;IAAA,SAoCIA,wBApCJ,GAoCI,oCAA0B;IACtB,SAAKvB,mBAAL,GAA2B,EAA3B;IACA,SAAKwB,2BAAL,GAAmC,IAAnC;IACH,GAvCL;;IAAA,SA0CIpK,6BA1CJ,GA0CI,yCAA+B;IAC3B,QAAI,KAAKoK,2BAAT,EACI,OAAO,KAAKA,2BAAZ,CADJ,KAGI,OAAO,KAAKxB,mBAAZ;IACP,GA/CL;;IAAA,SAiDI3I,WAjDJ,GAiDI,uBAAa;IACT,QAAI,CAAC,KAAKoK,WAAL,CAAiBpL,OAAjB,EAAL,EAAiC;IAC7B,WAAKoL,WAAL,CAAiBrL,QAAjB;IACA,WAAKsL,iBAAL;IACA,WAAKC,iBAAL,CAAuBnC,2BAAvB;IACH;IACJ,GAvDL;;IAAA,SAyDIkC,iBAzDJ,GAyDI,6BAAmB;IACf,SAAKD,WAAL,CAAiBlM,cAAjB;IACAwK,IAAAA,iBAAiB,CAAC,KAAKC,mBAAN,CAAjB;IACA,SAAKwB,2BAAL,GAAmC,IAAnC;IACH,GA7DL;IAAA;;IAAA,SAgEII,YAhEJ,GAgEI,wBAAc;IACV,WAAO,KAAKjB,gBAAL,CAAsBkB,gBAA7B;IACH,GAlEL;;IAAA,SAoEIC,MApEJ,GAoEI,kBAAQ;IACJ,SAAKb,QAAL;IACA,SAAKc,cAAL;IACA,SAAKC,UAAL;IACH;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA1EJ;;IAAA,SAwHIC,WAxHJ,GAwHI,uBAAa;IACT,SAAKZ,YAAL,CAAkB1J,YAAlB,GADS;;IAGT,SAAI,IAAI7E,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKkN,mBAAL,CAAyBhN,MAAxC,EAAgDF,CAAC,EAAjD,EACA;IACI,UAAImN,eAAe,GAAG,KAAKD,mBAAL,CAAyBlN,CAAzB,CAAtB;IACA,UAAImN,eAAe,CAAClE,WAApB,EACIkE,eAAe,CAACvH,MAAhB;IACP;;IACD,SAAKrB,WAAL;IAEH,GAnIL;;IAAA,SAqII6K,SArIJ,GAqII,qBAAW;IACP,SAAKb,YAAL,CAAkB1J,YAAlB,GADO;;IAGP,SAAI,IAAI7E,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKkN,mBAAL,CAAyBhN,MAAxC,EAAgDF,CAAC,EAAjD,EACA;IACI,UAAImN,eAAe,GAAG,KAAKD,mBAAL,CAAyBlN,CAAzB,CAAtB;IACA,UAAI,CAACmN,eAAe,CAAC7F,kBAArB,EACI6F,eAAe,CAACvH,MAAhB;IACP;;IACD,SAAKrB,WAAL;IACH,GA/IL;;IAAA,SAiJI8K,KAjJJ,GAiJI,iBAAO;IACH;IACA,SAAKd,YAAL,CAAkB1J,YAAlB,GAFG;;IAGH,SAAKN,WAAL;;IAEA,SAAI,IAAIvE,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKkN,mBAAL,CAAyBhN,MAAxC,EAAgDF,CAAC,EAAjD,EACA;IACI,UAAImN,eAAe,GAAG,KAAKD,mBAAL,CAAyBlN,CAAzB,CAAtB;IACA,UAAImN,eAAe,CAAC3H,uBAApB,EACIhG,aAAa,CAAC2N,eAAe,CAAC3H,uBAAjB,CAAb;IACJ,UAAI2H,eAAe,CAAClE,WAApB,EACIzJ,aAAa,CAAC2N,eAAe,CAAClE,WAAjB,CAAb;IACP;;IACD,SAAKwF,wBAAL;IACA,SAAKa,UAAL,CAAgB3F,gCAAhB,GAdG;IAeN,GAhKL;;IAAA,SAkKIuF,UAlKJ,GAkKI,sBAAY;IACR,SAAKG,KAAL,GADQ;;IAGR,SAAKE,cAAL;IAEH,GAvKL;;IAAA,SAyKIA,cAzKJ,GAyKI,0BAAgB;IAAA;;IACZ,QAAIC,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;IAC5B,UAAIC,OAAO,GAAG,KAAI,CAAC7B,cAAL,CAAoB8B,UAApB,EAAd;;IAEA,WAAI,IAAI1P,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAACyP,OAAO,CAACvP,MAAzB,EAAiCF,CAAC,EAAlC,EAAsC;IAClC,YAAI+G,MAAM,GAAG0I,OAAO,CAACzP,CAAD,CAApB;IAEA,YAAIyG,UAAU,GAAGM,MAAM,CAAC4I,QAAxB;IAEA,YAAIpG,UAAU,GAAIxC,MAAM,CAAC8F,QAAR,GAAkB9F,MAAM,CAAC8F,QAAzB,GAAkC,KAAnD;IACA,YAAIO,QAAQ,GAAMrG,MAAM,CAAC6I,MAAR,GAAgB7I,MAAM,CAAC6I,MAAvB,GAA8B,KAA/C;IAEA,YAAIzJ,eAAe,GAAG;IAClBsH,UAAAA,UAAU,EAAE1G,MAAM,CAACuG,IAAP,CAAYuC,WAAZ,GAA0BC,IAA1B,EADM;IAElBxI,UAAAA,kBAAkB,EAAEb,UAAU,IAAI8C,UAAd,IAA4B6D,QAF9B;IAGlBrG,UAAAA,MAAM,EAAEA,MAHU;IAIlBqG,UAAAA,QAAQ,EAAEA,QAJQ;IAKlB5H,UAAAA,uBAAuB,EAAE,IALP;IAMlBnB,UAAAA,mBAAmB,EAAE,IANH;IAOlByE,UAAAA,YAAY,EAAE,IAPI;IAQlBC,UAAAA,YAAY,EAAE,IARI;IASlB9C,UAAAA,OAAO,EAAE,KATS;IAUlBL,UAAAA,MAAM,EAAE,IAVU;IAWlBqD,UAAAA,WAAW,EAAE,IAXK;IAYlBxI,UAAAA,MAAM,EAAE,IAZU;IAalB0G,UAAAA,OAAO,EAAE,IAbS;IAclB4I,UAAAA,6BAA6B,EAAE;IAdb,SAAtB;;IAiBA,QAAA,KAAI,CAAC7C,mBAAL,CAAyBQ,IAAzB,CAA8BvH,eAA9B;;IACA,YAAI,CAACiH,QAAL,EAAc;IACVjH,UAAAA,eAAe,CAACF,OAAhB,GAA0B,IAA1B;IACAE,UAAAA,eAAe,CAACT,YAAhB,GAA6B1F,CAA7B;;IACA,UAAA,KAAI,CAACuO,YAAL,CAAkBlI,kBAAlB,CACIF,eADJ,EAEI,UAAC6J,EAAD,EAAIC,EAAJ,EAAOC,EAAP;IAAA,mBAAc,KAAI,CAACZ,UAAL,CAAgBtG,UAAhB,CAA2BgH,EAA3B,EAA8BC,EAA9B,EAAiCC,EAAjC,CAAd;IAAA,WAFJ,EAGI,UAACC,CAAD,EAAGnQ,CAAH;IAAA,mBAAS,KAAI,CAACuG,WAAL,CAAiB4J,CAAjB,EAAmBnQ,CAAnB,CAAT;IAAA,WAHJ,EAII;IAAA,mBAAM,KAAI,CAAC4N,cAAL,CAAoBpH,aAApB,EAAN;IAAA,WAJJ,EAKIC,UALJ,EAMI8C,UANJ;IAOH;IACJ;;IACD,MAAA,KAAI,CAAC6G,MAAL,CAAY/E,8BAAZ,CAA2C,KAA3C,EAzC4B;;IA2C/B,KA3CD,CADY;;;IA+CZ,QAAIf,QAAQ,CAAC+F,UAAT,IAAuB,SAA3B,EAAqC;IACjCb,MAAAA,mBAAmB;IACtB,KAFD,MAEO;IACH,UAAIc,0BAA0B,GAAG,SAA7BA,0BAA6B,GAAU;IACvCd,QAAAA,mBAAmB;IACnBlF,QAAAA,QAAQ,CAACzG,mBAAT,CAA6B,kBAA7B,EAAiDyM,0BAAjD;IACH,OAHD;;IAIAhG,MAAAA,QAAQ,CAACjH,gBAAT,CAA0B,kBAA1B,EAA8CiN,0BAA9C,EALG;IAMN;IACJ,GAjOL;;IAAA,SAmOIC,OAnOJ,GAmOI,mBAAS;IACL,QAAI,KAAKnC,SAAT,EACI,KAAKA,SAAL,GAFC;IAIL;IACA;;IACA,SAAKG,YAAL,CAAkB1J,YAAlB;IACA,QAAI,KAAK+I,cAAL,CAAoBhK,OAAxB,EACI,KAAKgK,cAAL,CAAoBhK,OAApB;IACJ,SAAK0L,UAAL,CAAgB1L,OAAhB;IACA,SAAK+K,WAAL,CAAiB/K,OAAjB;IAEA,SAAKoK,YAAL,CAAkBpK,OAAlB;IAEA,SAAKwM,MAAL,CAAYxM,OAAZ;IAEA,SAAKiK,gBAAL,CAAsBjK,OAAtB;;IAEA,SAAI,IAAI5D,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKkN,mBAAL,CAAyBhN,MAAxC,EAAgDF,CAAC,EAAjD,EACA;IACI,UAAImN,eAAe,GAAG,KAAKD,mBAAL,CAAyBlN,CAAzB,CAAtB;IACAmN,MAAAA,eAAe,CAACvH,MAAhB,GAAyB,IAAzB;IACAuH,MAAAA,eAAe,CAAC1M,MAAhB,GAAyB,IAAzB;IACA0M,MAAAA,eAAe,CAAC4C,6BAAhB,GAAgD,IAAhD;IACA,UAAI5C,eAAe,CAACnG,8BAApB,EACImG,eAAe,CAACnG,8BAAhB;IAEJ,UAAImG,eAAe,CAAC/D,WAApB,EACI+D,eAAe,CAAC/D,WAAhB,CAA4BxF,OAA5B;IACJ,UAAIuJ,eAAe,CAAC/H,mBAApB,EACI+H,eAAe,CAAC/H,mBAAhB,CAAoCxB,OAApC;IACP;IACJ,GAnQL;;IAAA,SAqQIqL,cArQJ,GAqQI,0BAAgB;IACZ,QAAIhH,mBAAmB,GAAG,KAAK2F,cAAL,CAAoB4C,WAApB,EAA1B;;IACA,QAAI,KAAKvI,mBAAL,KAA2BA,mBAA/B,EAAmD;IAC/C,UAAIA,mBAAJ,EAAyB;IACrB,aAAKqH,UAAL,CAAgBnI,OAAhB;IACA,aAAK0H,iBAAL,CAAuBjC,WAAvB,CAAmC,IAAnC;IACA,aAAKkB,OAAL,CAAa2C,OAAb,CAAqB,KAAKjC,gBAA1B;IACH,OAJD,MAIO;IACH,aAAKc,UAAL,CAAgB1F,MAAhB;IACA,aAAKiF,iBAAL,CAAuBjC,WAAvB,CAAmC,KAAnC;IACA,aAAKkB,OAAL,CAAa4C,MAAb,CAAoB,KAAKlC,gBAAzB;IACH;;IACD,WAAKvG,mBAAL,GAAyBA,mBAAzB;IACH;IACJ,GAnRL;;IAAA,SAqRI0I,KArRJ,GAqRI,eAAMxN,gBAAN,EAAwByN,WAAxB,EAAoC;IAChC,QAAItD,IAAI,GAAGnK,gBAAgB,CAAC2M,IAAjB,GAAwBD,WAAxB,EAAX;IACA,QAAItM,OAAO,GAAC,KAAZ;IACA,QAAI+J,IAAI,IAAI,EAAZ,EACI/J,OAAO,GAAC,IAAR,CADJ,KAGA;IACI;IACA,WAAKmL,2BAAL,GAAmCrB,yBAAyB,CAAC,KAAKH,mBAAN,EAA2BI,IAA3B,CAA5D;;IACA,UAAI,KAAKoB,2BAAL,CAAiCxO,MAAjC,IAA2C,CAA/C,EACA;IACI,YAAI2Q,wBAAwB,GAAI,KAAKnC,2BAAL,CAAiC,CAAjC,CAAhC;;IACA,YAAImC,wBAAwB,CAACpD,UAAzB,IAAuCH,IAA3C,EACA;IACIuD,UAAAA,wBAAwB,CAACjL,MAAzB;IACA,eAAK+I,WAAL,CAAiBrL,QAAjB,GAFJ;;IAGIC,UAAAA,OAAO,GAAC,IAAR;IACH;IACJ;IACJ;IACD,QAAIA,OAAJ,EACI,KAAKqL,iBAAL,GADJ,KAGIgC,WAAW;IAGf,SAAKrC,YAAL,CAAkB9G,6BAAlB;;IACA,QAAI,KAAKnD,6BAAL,GAAqCpE,MAArC,IAA+C,CAAnD,EAAsD;IAClD,WAAKqO,YAAL,CAAkBrJ,eAAlB,CAAkC,CAAlC;IACH;;IAED,QAAI,KAAKZ,6BAAL,GAAqCpE,MAArC,GAA8C,CAAlD,EAAqD;IACjD,WAAKkQ,MAAL,CAAY/E,8BAAZ,CAA2C,IAA3C,EADiD;;IAEjD,WAAKkD,YAAL,CAAkBvJ,YAAlB;IACH,KAHD,MAGO;IACH,WAAKuJ,YAAL,CAAkB1J,YAAlB;IACH;IACJ,GA1TL;;IAAA,SA4TIkD,IA5TJ,GA4TI,gBAAO;IAAA;;IACH,QAAIuC,QAAQ,GAAG,KAAKN,MAAL,CAAYM,QAA3B;;IACA,QAAIzI,aAAa,GAAG,SAAhBA,aAAgB,CAACiP,IAAD;IAAA,aAAUxG,QAAQ,CAACzI,aAAT,CAAuBiP,IAAvB,CAAV;IAAA,KAApB;;IAEA,QAAIC,+BAA+B,GAAC,IAApC;IAEA,SAAKpC,WAAL,GAAmB/M,WAAW,CAC1BC,aAD0B,EAE1B,UAACmP,sBAAD,EAA4B;IACxBD,MAAAA,+BAA+B,GAAG,yCAACE,iBAAD,EAAqB;IACnDA,QAAAA,iBAAiB,CAACpK,WAAlB,CAA8BmK,sBAA9B;;IACA,QAAA,MAAI,CAAChD,YAAL,CAAkBjG,IAAlB,CAAuBiJ,sBAAvB;IACH,OAHD;IAIH,KAPyB,EAQ1B,YAAM;IACF,MAAA,MAAI,CAAClD,OAAL,CAAaoD,OAAb,CAAqB,MAAI,CAAC1C,gBAA1B;IACH,KAVyB;IAW1B,gBAAM;IACF,UAAI,CAAC,MAAI,CAAC4B,MAAL,CAAYrE,eAAZ,EAAL;IACA;IACI,UAAA,MAAI,CAACxH,WAAL,GADJ;;;IAEI,UAAA,MAAI,CAACuJ,OAAL,CAAaqD,QAAb,CAAsB,MAAI,CAAC3C,gBAA3B;IACH;;IACD,MAAA,MAAI,CAAC4B,MAAL,CAAYpE,iBAAZ;IACH,KAlByB;IAmB1B;IAAA,aAAM,MAAI,CAACuC,YAAL,CAAkB1I,YAAlB,CAA+B,KAA/B,CAAN;IAAA,KAnB0B;IAoB1B;IAAA,aAAM,MAAI,CAAC0I,YAAL,CAAkB1I,YAAlB,CAA+B,IAA/B,CAAN;IAAA,KApB0B;IAqB1B;IAAA,aAAM,MAAI,CAAC0I,YAAL,CAAkB1J,YAAlB,EAAN;IAAA,KArB0B;IAsB1B,gBAAM;IACF,MAAA,MAAI,CAACyK,UAAL,CAAgB1G,eAAhB;;IACA,MAAA,MAAI,CAACwH,MAAL,CAAY/E,8BAAZ,CAA2C,KAA3C;IACH,KAzByB;IA0B1B,gBAAM;IACF,UAAI,MAAI,CAACkD,YAAL,CAAkB7G,WAAlB,EAAJ,EACI,MAAI,CAAC6G,YAAL,CAAkB5I,aAAlB;IAAmC,KA5BjB;IA6B1B,cAACpC,OAAD,EAAUV,KAAV,EAAoB;IAChB,UAAI,CAACU,OAAD,IAAY,MAAI,CAACgL,YAAL,CAAkB7G,WAAlB,EAAhB;IACI7E,QAAAA,KAAK,CAACuO,eAAN;IACP,KAhCyB;IAiC1B,gBAAM;IACF,MAAA,MAAI,CAAC7C,YAAL,CAAkB1J,YAAlB,GADE;;;IAEF,MAAA,MAAI,CAACN,WAAL;IACH,KApCyB;IAqC1B,cAACpB,gBAAD,EAAmByN,WAAnB,EACA;IACI,MAAA,MAAI,CAAC/B,iBAAL,CAAuBnC,2BAAvB;;IACA,MAAA,MAAI,CAACiE,KAAL,CAAWxN,gBAAX,EAA6ByN,WAA7B;IACH,KAzCyB;IA0C1B,gBAAM;IACF,MAAA,MAAI,CAAC/B,iBAAL,CAAuBlC,qBAAvB;IACH,KA5CyB,CAA9B;IA+CA,SAAK2C,UAAL,GAAmBzH,UAAU,CACzB,KAAKtB,WADoB,EAEzB1E,aAFyB,EAGzB,KAAKgM,gBAAL,CAAsB/F,YAHG,EAIzB,UAACmJ,iBAAD,EAAuB;IACnBF,MAAAA,+BAA+B,CAACE,iBAAD,CAA/B;IACH,KANwB,EAOzB,KAAKjJ,oBAPoB,EAQzB,KAAKC,mBARoB,EASzB;IAAA,aAAM,MAAI,CAAC2F,cAAL,CAAoBpH,aAApB,EAAN;IAAA,KATyB,EAUzB,YAAM;IACF,MAAA,MAAI,CAAC+H,YAAL,CAAkB1J,YAAlB,GADE;;;IAEF,MAAA,MAAI,CAACN,WAAL;IACH,KAbwB,EAczB,UAAC1B,KAAD,EAAW;IACP,UAAI,CAAC,MAAI,CAAC8L,WAAL,CAAiBjL,aAAjB,CAA+Bb,KAA/B,CAAL,EACK,MAAI,CAAC8L,WAAL,CAAiBnL,QAAjB;;IACL,MAAA,MAAI,CAAC4M,MAAL,CAAYhF,oBAAZ,CAAiCvI,KAAjC;IACH,KAlBwB,EAmBzB;IAAA,aAAK,MAAI,CAACgM,iBAAL,CAAuBnC,2BAAvB,EAAL;IAAA,KAnByB,EAoBzB,UAAC2E,SAAD,EAAYxO,KAAZ,EAAsB;IAClB,MAAA,MAAI,CAACuN,MAAL,CAAY1E,cAAZ,CAA2B2F,SAA3B,EAAsCxO,KAAtC;IACH,KAtBwB,CAA7B;IAyBA,SAAK0L,YAAL,GAAoBvK,YAAY,CAC5BnC,aAD4B,EAE5B,KAAKgM,gBAAL,CAAsB5J,cAFM,EAG5B;IAAA,aAAM,MAAI,CAACmM,MAAL,CAAYvE,cAAZ,EAAN;IAAA,KAH4B,EAI5B;IAAA,aAAM,MAAI,CAACuE,MAAL,CAAYtE,cAAZ,EAAN;IAAA,KAJ4B,EAK5BgB,YAAY,CAAC,KAAK9C,MAAN,CALgB,EAM5B,KAAK+D,sBANuB,EAO5B;IAAA,aAAM,MAAI,CAACzJ,6BAAL,EAAN;IAAA,KAP4B,EAQ5B;IAAA,aAAM,MAAI,CAACC,WAAL,EAAN;IAAA,KAR4B,EAS5B;IAAA,aAAM,MAAI,CAAC6L,MAAL,CAAY/E,8BAAZ,CAA2C,IAA3C,CAAN;IAAA,KAT4B,EAU5B;IAAA,aAAM,MAAI,CAACsD,WAAL,CAAiBnL,QAAjB,EAAN;IAAA,KAV4B,CAAhC;IAaA,SAAKqL,iBAAL,GAAyB5C,iBAAiB,CACtC,KAAKC,eADiC,EAEtC;IAAA,aAAM,MAAI,CAACoD,UAAL,CAAgB/L,OAAhB,EAAN;IAAA,KAFsC,EAGtC;IAAA,aAAM,MAAI,CAACoL,WAAL,CAAiBpL,OAAjB,EAAN;IAAA,KAHsC,EAItC,KAAKsK,gBAAL,CAAsB/F,YAJgB,EAKtC,KAAK6G,WAAL,CAAiBjM,kBALqB,CAA1C;IAQA,SAAKmM,iBAAL,CAAuB9G,IAAvB;IACA,SAAK8G,iBAAL,CAAuBlC,qBAAvB;IAGA,SAAKyD,MAAL,GAAerG,sBAAsB,CACjC,KAAKC,MAD4B,EAEjC;IAAA,aAAI,MAAI,CAAC6D,gBAAL,CAAsB5D,iBAAtB,EAAJ;IAAA,KAFiC,EAGjC,KAAKqF,UAAL,CAAgB5G,iBAHiB,EAIjC,KAAKmF,gBAAL,CAAsB/F,YAJW,EAKjC,KAAK+F,gBAAL,CAAsB5J,cALW,EAMjC;IAAA,aAAM,MAAI,CAACsK,YAAL,CAAkBvJ,YAAlB,EAAN;IAAA,KANiC,EAOjC,YAAM;IACF,MAAA,MAAI,CAACuJ,YAAL,CAAkB1J,YAAlB;;IACA,MAAA,MAAI,CAACN,WAAL;IACH,KAVgC,EAWjC;IAAA,aAAM,MAAI,CAACD,6BAAL,GAAqCpE,MAArC,IAA6C,CAAnD;IAAA,KAXiC,EAYjCmK,MAZiC,CAArC;IAeA,SAAKmE,gBAAL,GAAwB,KAAKP,sBAAL,CACpB,KAAKqB,UAAL,CAAgB5G,iBADI,EAEpB,KAAKiG,WAAL,CAAiBjM,kBAFG,EAGpB,KAAKmL,gBAAL,CAAsB5J,cAHF,CAAxB;IAKA,SAAK6J,OAAL,CAAawD,IAAb,CAAkB,KAAK9C,gBAAvB;IAEA,SAAKX,gBAAL,CAAsB0D,eAAtB;IAEA,SAAKpD,QAAL;IACA,SAAKc,cAAL,GAhIG;;IAiIH,SAAKM,cAAL;IAEA,QAAI,KAAK3B,cAAL,CAAoB4D,gBAAxB,EACI,KAAK5D,cAAL,CAAoB4D,gBAApB,CAAqC;IAAA,aAAK,MAAI,CAACxH,MAAL,CAAY4B,UAAZ,CAAwB;IAAA,eAAI,MAAI,CAACsD,UAAL,EAAJ;IAAA,OAAxB,CAAL;IAAA,KAArC;IACP,GAjcL;;IAAA;IAAA;;ICjDO,SAASuC,YAAT,CAAsBC,YAAtB,EAAoCC,aAApC,EAAkD;IACrD,MAAIC,oBAAoB,GAAG,IAA3B,CADqD;;IAErD,SAAO;IACH7J,IAAAA,IADG,gBACErF,kBADF,EACsB;IACrB,UAAIgP,YAAJ,EAAkB;IACdE,QAAAA,oBAAoB,GAAGF,YAAY,CAACG,YAAb,CAA0B,KAA1B,CAAvB;IACA,YAAIC,KAAK,GAAGH,aAAa,EAAzB;IACAjP,QAAAA,kBAAkB,CAACC,YAAnB,CAAgC,IAAhC,EAAsCmP,KAAtC;IACAJ,QAAAA,YAAY,CAAC/O,YAAb,CAA0B,KAA1B,EAAgCmP,KAAhC;IACH;IACJ,KARE;IASHlO,IAAAA,OATG,qBASM;IACL,UAAGgO,oBAAH,EACIF,YAAY,CAAC/O,YAAb,CAA0B,KAA1B,EAAgCiP,oBAAhC;IACP;IAZE,GAAP;IAcH;;IChBM,SAASG,oBAAT,CAA8BC,UAA9B,EAA0CC,YAA1C,EAAwDC,QAAxD,EAAkEC,CAAlE,EAAoE;IACvE,MAAMC,SAAS,GAAGJ,UAAU,CAACK,MAAX,CAAkB,CAAlB,CAAlB;IACA,MAAMC,cAAc,GAAGF,SAAS,CAACvC,WAAV,EAAvB;;IACA,MAAIyC,cAAc,IAAIF,SAAtB,EAAiC;IAC7B,UAAM,IAAI/D,SAAJ,mBAA8B2D,UAA9B,8CAAN;IACH;;IACD,MAAMO,gBAAgB,GAAGD,cAAc,GAAGN,UAAU,CAACQ,KAAX,CAAiB,CAAjB,CAA1C;IACA,MAAMC,sBAAsB,GAAGN,CAAC,CAACO,EAAF,CAAKH,gBAAL,CAA/B;IACA,MAAMI,OAAO,sBAAoBX,UAAjC;;IAEA,WAASY,YAAT,CAAsBnD,OAAtB,EAA+B;IAC3B,WAAO,KAAKoD,IAAL,CAAW,YAAY;IAC1B,UAAIC,EAAE,GAAGX,CAAC,CAAC,IAAD,CAAV;IACA,UAAIY,QAAQ,GAAGD,EAAE,CAACE,IAAH,CAAQL,OAAR,CAAf;IACA,UAAIM,YAAY,GAAG,OAAOxD,OAAP,KAAmB,QAAtC;;IACA,UAAI,CAACsD,QAAL,EAAe;IACX,YAAIE,YAAY,IAAI,UAAUC,IAAV,CAAezD,OAAf,CAApB,EAA6C;IACzC;IACH;;IACD,YAAM0D,aAAa,GAAI,OAAO1D,OAAP,KAAmB,QAApB,GAA8BA,OAA9B,GAAsC,IAA5D;IAEAsD,QAAAA,QAAQ,GAAGd,YAAY,CAAC,IAAD,EAAOkB,aAAP,EACnB,YAAM;IACFL,UAAAA,EAAE,CAACM,UAAH,CAAcT,OAAd;IACH,SAHkB,CAAvB;IAIAG,QAAAA,EAAE,CAACE,IAAH,CAAQL,OAAR,EAAiBI,QAAjB;IACH;;IAED,UAAIE,YAAJ,EAAkB;IACd,YAAII,UAAU,GAAG5D,OAAjB;;IACA,YAAI,OAAOsD,QAAQ,CAACM,UAAD,CAAf,KAAgC,WAApC,EAAiD;IAC7C,gBAAM,IAAIhF,SAAJ,uBAAkCgF,UAAlC,OAAN;IACH;;IACDN,QAAAA,QAAQ,CAACM,UAAD,CAAR;IACH;IACJ,KAxBM,CAAP;IAyBH;;IAEDlB,EAAAA,CAAC,CAACO,EAAF,CAAKH,gBAAL,IAAyBK,YAAzB,CAtCuE;;IAyCvET,EAAAA,CAAC,CAACO,EAAF,CAAKV,UAAL,IAAmB,YAAY;IAC3B,WAAOG,CAAC,CAAC,IAAD,CAAD,CAAQa,IAAR,CAAaL,OAAb,CAAP;IACH,GAFD;;IAIAR,EAAAA,CAAC,CAACO,EAAF,CAAKH,gBAAL,EAAuBe,UAAvB,GAAoC,YAAY;IAC5CnB,IAAAA,CAAC,CAACO,EAAF,CAAKH,gBAAL,IAAyBE,sBAAzB;IACA,WAAOG,YAAP;IACH,GAHD;;IAKAT,EAAAA,CAAC,CAACO,EAAF,CAAKH,gBAAL,EAAuBL,QAAvB,GAAkCA,QAAlC;IACH;;ICnDD,SAASqB,qBAAT,CAA+BC,aAA/B,EAA8ChD,WAA9C,EAA2DiD,OAA3D,EAAoEC,UAApE,EAAgFC,YAAhF,EAA8FC,OAA9F,EAAuGC,IAAvG,EAA6G;IACzG,MAAIC,MAAJ;IACA,SAAO;IACHpE,IAAAA,UADG,wBACS;IACR,aAAO8D,aAAa,CAACO,oBAAd,CAAmC,QAAnC,CAAP;IACH,KAHE;IAIHvN,IAAAA,aAJG,2BAIY;IACXoN,MAAAA,OAAO,CAAC,QAAD,CAAP;IACAA,MAAAA,OAAO,CAAC,oBAAD,CAAP;IACH,KAPE;IAQHpD,IAAAA,WAAW,EAAXA,WARG;IASHiD,IAAAA,OAAO,EAAPA,OATG;IAUHC,IAAAA,UAAU,EAAVA,UAVG;IAWHC,IAAAA,YAAY,EAAZA,YAXG;IAYHnC,IAAAA,gBAZG,4BAYcwC,OAZd,EAYsB;IACrBF,MAAAA,MAAM,GAAGE,OAAT;IACA,UAAIH,IAAJ,EACIA,IAAI,CAACxQ,gBAAL,CAAsB,OAAtB,EAA+ByQ,MAA/B;IACP,KAhBE;IAiBHlQ,IAAAA,OAjBG,qBAiBM;IACL,UAAIiQ,IAAI,IAAIC,MAAZ,EACID,IAAI,CAAChQ,mBAAL,CAAyB,OAAzB,EAAkCiQ,MAAlC;IACP;IApBE,GAAP;IAsBH;;IAED,SAASG,kBAAT,CAA4BxE,OAA5B,EAAqCe,YAArC,EAAkDiD,QAAlD,EAA2DC,WAA3D,EAAuEC,aAAvE,EAAqFC,OAArF,EAA8F;IAC1F,SAAO;IACHlE,IAAAA,UADG,wBACS;IACR,aAAOD,OAAP;IACH,KAHE;IAIHjJ,IAAAA,aAJG,2BAIY;IACXoN,MAAAA,OAAO,CAAC,oBAAD,CAAP;IACH,KANE;IAOHpD,IAAAA,WAPG,yBAOU;IACT,aAAOA,YAAW,GAACA,YAAW,EAAZ,GAAe,KAAjC;IACH,KATE;IAUHiD,IAAAA,OAVG,qBAUM;IACL,aAAOA,QAAO,GAACA,QAAO,EAAR,GAAW,IAAzB;IACH,KAZE;IAaHC,IAAAA,UAbG,wBAaS;IACR,aAAOA,WAAU,GAACA,WAAU,EAAX,GAAc,KAA/B;IACH,KAfE;IAgBHC,IAAAA,YAhBG,0BAgBW;IACV,aAAOA,aAAY,GAACA,aAAY,EAAb,GAAgB,KAAnC;IACH;IAlBE,GAAP;IAoBH;;IC5CM,SAASO,gBAAT,CAA0BhG,aAA1B,EAAwC;IAC3C,MAAIiG,YAAY,GAAG7U,WAAW,CAAC4O,aAAa,CAACkG,kBAAf,EAAmC,EAAnC,CAA9B;IACA,MAAIC,UAAU,GAAG/U,WAAW,CAAC4O,aAAa,CAACoG,eAAf,EAAgC,EAAhC,CAA5B;IACA,SAAO;IACHvM,IAAAA,IADG,gBACEwM,QADF,EACW;IACVzT,MAAAA,SAAS,CAACyT,QAAQ,CAACC,KAAV,EAAiBtG,aAAa,CAACvG,UAA/B,CAAT;IACA7G,MAAAA,SAAS,CAACyT,QAAQ,CAAC5D,KAAV,EAAiBzC,aAAa,CAAC3M,gBAA/B,CAAT;IACH,KAJE;IAMHqI,IAAAA,MANG,kBAMI9B,YANJ,EAMiB;IAChBhH,MAAAA,SAAS,CAACgH,YAAD,EAAeqM,YAAf,CAAT;IACH,KARE;IAUHhN,IAAAA,OAVG,mBAUKW,YAVL,EAUkB;IACjBhH,MAAAA,SAAS,CAACgH,YAAD,EAAeoG,aAAa,CAACkG,kBAA7B,CAAT;IACH,KAZE;IAcHK,IAAAA,OAdG,mBAcK3M,YAdL,EAckB;IACjBhH,MAAAA,SAAS,CAACgH,YAAD,EAAeoG,aAAa,CAACoG,eAA7B,CAAT;IACH,KAhBE;IAkBHI,IAAAA,QAlBG,oBAkBM5M,YAlBN,EAkBmB;IAClBhH,MAAAA,SAAS,CAACgH,YAAD,EAAeuM,UAAf,CAAT;IACH;IApBE,GAAP;IAsBH;;IC1BM,SAASM,OAAT,CAAiBzG,aAAjB,EAAgC0G,gBAAhC,EAAkD;IACrD,SAAO;IACHtD,IAAAA,IADG,gBACEiD,QADF,EACW;IACV7T,MAAAA,UAAU,CAAC6T,QAAQ,CAACM,SAAV,EAAqB3G,aAAa,CAAC4G,cAAnC,CAAV;IACApU,MAAAA,UAAU,CAAC6T,QAAQ,CAACC,KAAV,EAAiBtG,aAAa,CAAC6G,UAA/B,CAAV;IACArU,MAAAA,UAAU,CAAC6T,QAAQ,CAACS,OAAV,EAAmB9G,aAAa,CAAC+G,YAAjC,CAAV;IACAvU,MAAAA,UAAU,CAAC6T,QAAQ,CAACW,UAAV,EAAsBhH,aAAa,CAACiH,eAApC,CAAV;IACAzU,MAAAA,UAAU,CAAC6T,QAAQ,CAAC5D,KAAV,EAAiBzC,aAAa,CAACkH,gBAA/B,CAAV;IACA,UAAIR,gBAAgB,IAAIA,gBAAgB,CAAC7M,IAAzC,EACI6M,gBAAgB,CAAC7M,IAAjB,CAAsBwM,QAAtB;IACP,KATE;IAWH7D,IAAAA,MAXG,kBAWI6D,QAXJ,EAWa;IACZ1T,MAAAA,aAAa,CAAC0T,QAAQ,CAACC,KAAV,EAAiBtG,aAAa,CAACmH,kBAA/B,CAAb;IACA,UAAIT,gBAAgB,IAAIA,gBAAgB,CAAChL,MAAzC,EACIgL,gBAAgB,CAAChL,MAAjB,CAAwB2K,QAAQ,CAACC,KAAjC;IACP,KAfE;IAiBH/D,IAAAA,OAjBG,mBAiBK8D,QAjBL,EAiBc;IACb7T,MAAAA,UAAU,CAAC6T,QAAQ,CAACC,KAAV,EAAiBtG,aAAa,CAACmH,kBAA/B,CAAV;IACA,UAAIT,gBAAgB,IAAIA,gBAAgB,CAACzN,OAAzC,EACIyN,gBAAgB,CAACzN,OAAjB,CAAyBoN,QAAQ,CAACC,KAAlC;IACP,KArBE;IAuBHtD,IAAAA,OAvBG,mBAuBKqD,QAvBL,EAuBc;IACb7T,MAAAA,UAAU,CAAC6T,QAAQ,CAACC,KAAV,EAAiBtG,aAAa,CAACoH,eAA/B,CAAV;IACA,UAAIV,gBAAgB,IAAIA,gBAAgB,CAACH,OAAzC,EACIG,gBAAgB,CAACH,OAAjB,CAAyBF,QAAQ,CAACC,KAAlC;IACP,KA3BE;IA6BHrD,IAAAA,QA7BG,oBA6BMoD,QA7BN,EA6Be;IACd1T,MAAAA,aAAa,CAAC0T,QAAQ,CAACC,KAAV,EAAiBtG,aAAa,CAACoH,eAA/B,CAAb;IACA,UAAIV,gBAAgB,IAAIA,gBAAgB,CAACF,QAAzC,EACIE,gBAAgB,CAACF,QAAjB,CAA0BH,QAAQ,CAACC,KAAnC;IACP;IAjCE,GAAP;IAmCH;;ICpCM,SAASe,6BAAT,CAAuCrH,aAAvC,EAAsD;IACzD,SAAO;IACHsH,IAAAA,kBADG,8BACgB1O,OADhB,EACwB;IACvBhG,MAAAA,SAAS,CAACgG,OAAD,EAAUoH,aAAa,CAACuH,wBAAxB,CAAT;IACH,KAHE;IAKHC,IAAAA,iBALG,6BAKeC,YALf,EAK6BC,MAL7B,EAKoC;IACnC9U,MAAAA,SAAS,CAAC6U,YAAD,EAAezH,aAAa,CAAC2H,SAA7B,CAAT;IACA/U,MAAAA,SAAS,CAAC8U,MAAD,EAAS1H,aAAa,CAAC4H,eAAvB,CAAT;IACH;IARE,GAAP;IAUH;AAED,IAAO,SAASC,sBAAT,CAAgC7H,aAAhC,EAA+C0G,gBAA/C,EAAiEzC,CAAjE,EAAoE;IACvE,SAAO,UAAUwD,YAAV,EAAwBK,UAAxB,EAAoC9M,kBAApC,EAAuD;IACtD,QAAI+M,aAAa,GAAG9D,CAAC,CAACwD,YAAD,CAArB;IACAjV,IAAAA,UAAU,CAACiV,YAAD,EAAezH,aAAa,CAACgI,SAA7B,CAAV;IACA,QAAIC,QAAQ,GAAGhE,CAAC,WAAD,CAAa7E,IAAb,CAAkB0I,UAAU,CAAC1I,IAA7B,CAAf;IACA,QAAIxG,OAAO,GAAGqP,QAAQ,CAACC,GAAT,CAAa,CAAb,CAAd;IACAD,IAAAA,QAAQ,CAACE,QAAT,CAAkBJ,aAAlB;;IACA,QAAID,UAAU,CAACnJ,QAAf,EAAyB;IACrBnM,MAAAA,UAAU,CAACoG,OAAD,EAAUoH,aAAa,CAACoI,wBAAxB,CAAV;IACA,UAAI1B,gBAAgB,IAAIA,gBAAgB,CAACY,kBAAzC,EACIZ,gBAAgB,CAACY,kBAAjB,CAAoC1O,OAApC;IACP;;IAED,QAAIyP,OAAO,GAAGpE,CAAC,CAAC,yGAAD,CAAD;IAEV;IAFU,KAGTqE,GAHS,CAGL,OAHK,EAGI,MAHJ,EAGYH,QAHZ,CAGqBJ,aAHrB,EAIT7V,QAJS,CAIA8N,aAAa,CAACuI,qBAJd;IAAA,KAKTC,EALS,CAKN,OALM,EAMN,UAAAC,OAAO;IAAA,aACHzN,kBAAkB,CAACyN,OAAO,CAACC,aAAT,CADf;IAAA,KAND,CAAd;IASA,QAAIhC,gBAAgB,IAAIA,gBAAgB,CAACc,iBAAzC,EACId,gBAAgB,CAACc,iBAAjB,CAAmCC,YAAnC,EAAiDY,OAAO,CAACH,GAAR,CAAY,CAAZ,CAAjD;IACJ,WAAO;IACHjP,MAAAA,OADG,mBACKoC,UADL,EACgB;IACfgN,QAAAA,OAAO,CAACM,IAAR,CAAa,UAAb,EAAyBtN,UAAzB;IACH,OAHE;IAIH3F,MAAAA,OAJG,qBAIM;IACL2S,QAAAA,OAAO,CAACO,MAAR;IACH;IANE,KAAP;IAQH,GA/BL;IAgCH;;IC7CM,SAASC,+BAAT,CAAyC7I,aAAzC,EAAwD;IAC3D,MAAI8I,UAAU,GAAG1X,WAAW,CAAC0X,UAAD,EAAa9I,aAAa,CAAC+I,wBAA3B,AAAA,CAA5B;IACA,SAAM;IACF/P,IAAAA,aADE,yBACYgQ,QADZ,EACsBC,aADtB,EACqCC,UADrC,EACgD;IAC9CtW,MAAAA,SAAS,CAACqW,aAAD,EAAgBC,UAAU,GAAElJ,aAAa,CAAC+I,wBAAhB,GAA2CD,UAArE,CAAT;IACH;IAHC,GAAN;IAKH;AAED,IAAO,SAASK,wBAAT,CAAkCnJ,aAAlC,EAAiD0G,gBAAjD,EAAmEzC,CAAnE,EAAsE;IAEzE,SAAO,UAASmF,aAAT,EAAwBvQ,MAAxB,EAA+B;IAClC,QAAIwQ,cAAc,GAAGpF,CAAC,CAACmF,aAAD,CAAtB;IACAC,IAAAA,cAAc,CAACnX,QAAf,CAAwB8N,aAAa,CAACsJ,WAAtC;IACA,QAAIC,cAAc,GAAEtF,CAAC,0NAArB;IAIAsF,IAAAA,cAAc,CAACpB,QAAf,CAAwBiB,aAAxB;IACA,QAAII,SAAS,GAAGD,cAAc,CAACE,IAAf,4BAAhB;IACA,QAAIC,cAAc,GAAGH,cAAc,CAACE,IAAf,SAArB;IACAC,IAAAA,cAAc,CAACtK,IAAf,CAAoBvG,MAAM,CAACuG,IAA3B;IAEA,QAAInN,GAAG,GAAG;IACNgJ,MAAAA,MADM,kBACC1C,UADD,EACY;IAAEiR,QAAAA,SAAS,CAACb,IAAV,CAAe,SAAf,EAA0BpQ,UAA1B;IAAwC,OADtD;IAEN;IACAU,MAAAA,OAHM,mBAGEoC,UAHF,EAGa;IAAEmO,QAAAA,SAAS,CAACb,IAAV,CAAe,UAAf,EAA2BtN,UAA3B;IAAyC,OAHxD;IAINrC,MAAAA,aAJM,yBAIQkQ,UAJR,EAImB;IACrB,YAAIA,UAAJ,EACIM,SAAS,CAACtX,QAAV,CAAmB8N,aAAa,CAAC2J,2BAAjC,EADJ,KAGIH,SAAS,CAAClX,WAAV,CAAsB0N,aAAa,CAAC2J,2BAApC;IACJ,YAAIjD,gBAAgB,IAAIA,gBAAgB,CAAC1N,aAAzC,EACI0N,gBAAgB,CAAC1N,aAAjB,CAA+BwQ,SAAS,CAACtB,GAAV,CAAc,CAAd,CAA/B,EAAiDwB,cAAc,CAACxB,GAAf,CAAmB,CAAnB,CAAjD,EAAwEgB,UAAxE;IACP,OAXK;IAYN/R,MAAAA,OAZM,qBAYG;IACL3E,QAAAA,UAAU,CAAC4W,aAAD,EAAgBpJ,aAAa,CAAC4J,gBAA9B,CAAV;IACH,OAdK;IAeNvS,MAAAA,QAfM,sBAeI;IACN1E,QAAAA,aAAa,CAACyW,aAAD,EAAgBpJ,aAAa,CAAC4J,gBAA9B,CAAb;IACH,OAjBK;IAkBN1Q,MAAAA,UAlBM,sBAkBKxB,MAlBL,EAkBa;IACf8R,QAAAA,SAAS,CAAChB,EAAV,CAAa,QAAb,EAAuB9Q,MAAvB;IACA2R,QAAAA,cAAc,CAACb,EAAf,CAAkB,OAAlB,EAA2B,UAAA7T,KAAK,EAAI;IAChC,cAAIyU,aAAa,KAAKzU,KAAK,CAACc,MAAxB,IAAkCwO,CAAC,CAACzH,QAAF,CAAW4M,aAAX,EAA0BzU,KAAK,CAACc,MAAhC,CAAtC,EAA+E;IAC3EiC,YAAAA,MAAM;IACT;IACJ,SAJD;IAKH,OAzBK;IA0BNhC,MAAAA,OA1BM,qBA0BG;IACL8T,QAAAA,SAAS,CAACZ,MAAV;IACAS,QAAAA,cAAc,CAACT,MAAf;IACH;IA7BK,KAAV;IAgCA,WAAO3W,GAAP;IACH,GA7CD;IA8CH;;IC5DM,SAAS4X,gBAAT,CAA0BlW,aAA1B,EAAyC2R,aAAzC,EAAwDzE,gBAAxD,EAA0EjH,YAA1E,EAAwF;IAAE;IAC7F,MAAIkQ,mBAAmB,GAAG,KAA1B;IACA,MAAIC,eAAe,GAAG,KAAtB;;IAEA,MAAI,CAAClJ,gBAAL,EAAsB;IAClBA,IAAAA,gBAAgB,GAAGlN,aAAa,CAAC,KAAD,CAAhC;IACAmW,IAAAA,mBAAmB,GAAE,IAArB;IACH;;IACD,MAAI,CAAClQ,YAAL,EAAkB;IACdA,IAAAA,YAAY,GAAGjG,aAAa,CAAC,IAAD,CAA5B;IACAoW,IAAAA,eAAe,GAAG,IAAlB;IACH;;IAED,MAAIhU,cAAc,GAAGpC,aAAa,CAAC,IAAD,CAAlC;IACAoC,EAAAA,cAAc,CAACjD,KAAf,CAAqB+D,OAArB,GAA6B,MAA7B;IAEA,MAAImT,aAAa,GAAG,IAApB;;IACA,MAAI1E,aAAJ,EACA;IACI0E,IAAAA,aAAa,GAAG1E,aAAa,CAACxS,KAAd,CAAoB+D,OAApC;IACAyO,IAAAA,aAAa,CAACxS,KAAd,CAAoB+D,OAApB,GAA4B,MAA5B;IACH;;IAED,SAAO;IACHgK,IAAAA,gBAAgB,EAAhBA,gBADG;IAEHjH,IAAAA,YAAY,EAAZA,YAFG;IAGH7D,IAAAA,cAAc,EAAdA,cAHG;IAIH8D,IAAAA,IAJG,kBAIG;IACF,UAAIkQ,eAAJ,EACIlJ,gBAAgB,CAAClI,WAAjB,CAA6BiB,YAA7B;IACP,KAPE;IAQHmC,IAAAA,iBARG,+BAQgB;IACf,UAAI+N,mBAAmB,IAAI,CAACxE,aAA5B,EACA;IACI,YAAIyE,eAAJ,EACIlJ,gBAAgB,CAAClI,WAAjB,CAA6BiB,YAA7B;IACJiH,QAAAA,gBAAgB,CAAClI,WAAjB,CAA6B5C,cAA7B;IACH,OALD,MAOA;IACI,YAAIuP,aAAJ,EACA;IACIA,UAAAA,aAAa,CAAC9T,UAAd,CAAyB8J,YAAzB,CAAsCvF,cAAtC,EAAsDuP,aAAa,CAAC2E,WAApE;IACA,cAAIF,eAAJ,EACIzE,aAAa,CAAC9T,UAAd,CAAyB8J,YAAzB,CAAsC1B,YAAtC,EAAoD7D,cAApD;IACP;IACJ;IACJ,KAxBE;IAyBHsN,IAAAA,eAzBG,6BAyBc;IACb,UAAIyG,mBAAJ,EACIxE,aAAa,CAAC9T,UAAd,CAAyB8J,YAAzB,CAAsCuF,gBAAtC,EAAwDyE,aAAa,CAAC2E,WAAtE;IACP,KA5BE;IA6BHvU,IAAAA,OA7BG,qBA6BM;IACL,UAAIoU,mBAAJ,EACIjJ,gBAAgB,CAACrP,UAAjB,CAA4BC,WAA5B,CAAwCoP,gBAAxC;IACJ,UAAIkJ,eAAJ,EACInQ,YAAY,CAACpI,UAAb,CAAwBC,WAAxB,CAAoCmI,YAApC;IACJ7D,MAAAA,cAAc,CAACvE,UAAf,CAA0BC,WAA1B,CAAsCsE,cAAtC;IACA,UAAIuP,aAAJ,EACIA,aAAa,CAACxS,KAAd,CAAoB+D,OAApB,GAA8BmT,aAA9B;IACP;IArCE,GAAP;IAuCH;;IC5DD,SAASE,aAAT,CAAuBtQ,YAAvB,EAAqCuQ,OAArC,EAA8CC,SAA9C,EAAwD;IACpD,MAAID,OAAJ,EACIjY,QAAQ,CAAC0H,YAAD,EAAc,UAAd,CAAR,CADJ,KAGItH,WAAW,CAACsH,YAAD,EAAc,UAAd,CAAX;IAEJ,MAAIwQ,SAAJ,EACIlY,QAAQ,CAAC0H,YAAD,EAAc,YAAd,CAAR,CADJ,KAGItH,WAAW,CAACsH,YAAD,EAAc,YAAd,CAAX;IACP;;IAGD,SAASyQ,UAAT,CAAoBzQ,YAApB,EAAkC0Q,IAAlC,EAAuC;IACnC,MAAIA,IAAI,IAAE,kBAAV,EAA6B;IACzBpY,IAAAA,QAAQ,CAAC0H,YAAD,EAAc,iBAAd,CAAR;IACAtH,IAAAA,WAAW,CAACsH,YAAD,EAAc,iBAAd,CAAX;IACH,GAHD,MAIK,IAAI0Q,IAAI,IAAE,kBAAV,EAA6B;IAC9BhY,IAAAA,WAAW,CAACsH,YAAD,EAAc,iBAAd,CAAX;IACA1H,IAAAA,QAAQ,CAAC0H,YAAD,EAAc,iBAAd,CAAR;IACH,GAHI,MAID;IACAtH,IAAAA,WAAW,CAACsH,YAAD,EAAc,iBAAd,CAAX;IACAtH,IAAAA,WAAW,CAACsH,YAAD,EAAc,iBAAd,CAAX;IACH;IACJ;;IAED,SAAS2Q,YAAT,CAAsB3Q,YAAtB,EAAoC4Q,YAApC,EAAkDC,YAAlD,EAAgEC,aAAhE,EAA+EJ,IAA/E,EAAoF;IAChFD,EAAAA,UAAU,CAACzQ,YAAD,EAAe0Q,IAAf,CAAV;;IACA,MAAIA,IAAI,IAAE,kBAAN,IAA4BA,IAAI,IAAE,gBAAtC,EAAuD;IACnD1X,IAAAA,SAAS,CAACgH,YAAD,EAAe4Q,YAAf,CAAT;IACH,GAFD,MAEO,IAAIF,IAAI,IAAE,kBAAN,IAA4BA,IAAI,IAAE,gBAAtC,EAAuD;IAC1D1X,IAAAA,SAAS,CAACgH,YAAD,EAAe6Q,YAAf,CAAT;IACH,GAFM,MAEA;IACH7X,IAAAA,SAAS,CAACgH,YAAD,EAAe8Q,aAAf,CAAT;IACH;IACJ;;IAED,SAASC,uBAAT,CAAiC/Q,YAAjC,EAA+C8F,cAA/C,EAA8D;IAC1DwK,EAAAA,aAAa,CAACtQ,YAAD,EAAe8F,cAAc,CAAC8F,UAAf,EAAf,EAA4C9F,cAAc,CAAC+F,YAAf,EAA5C,CAAb;IACH;;IAED,SAASmF,oBAAT,CAA8BhR,YAA9B,EAA4C8F,cAA5C,EAA2D;IACvD2K,EAAAA,UAAU,CAACzQ,YAAD,EAAe8F,cAAc,CAAC6F,OAAf,EAAf,CAAV;IACH;;IAED,SAASsF,sBAAT,CAAgCjR,YAAhC,EAA8C4Q,YAA9C,EAA4DC,YAA5D,EAA0EC,aAA1E,EAAyFhL,cAAzF,EAAwG;IACpG6K,EAAAA,YAAY,CAAC3Q,YAAD,EAAe4Q,YAAf,EAA6BC,YAA7B,EAA2CC,aAA3C,EAA2DhL,cAAc,CAAC6F,OAAf,EAA3D,CAAZ;IACH;;AAED,IAAO,SAASuF,kBAAT,CAA4BlR,YAA5B,EAA0CoG,aAA1C,EAAyDN,cAAzD,EAAwE;IAC3E,MAAIwK,aAAa,GAAG,SAAhBA,aAAgB;IAAA,WAAMS,uBAAuB,CAAC/Q,YAAD,EAAe8F,cAAf,CAA7B;IAAA,GAApB;;IACA,MAAIM,aAAa,CAAC+K,MAAlB,EAAyB;IACrB,WAAOC,MAAM,CAACC,MAAP,CAAc;IACjBf,MAAAA,aAAa,EAAbA,aADiB;IAEjBG,MAAAA,UAAU,EAAE;IAAA,eAAMO,oBAAoB,CAAChR,YAAD,EAAe8F,cAAf,CAA1B;IAAA;IAFK,KAAd,CAAP;IAIH,GALD,MAKK;IAAA,QACM8K,YADN,GACmDxK,aADnD,CACMwK,YADN;IAAA,QACoBC,YADpB,GACmDzK,aADnD,CACoByK,YADpB;IAAA,QACkCC,aADlC,GACmD1K,aADnD,CACkC0K,aADlC;IAED,WAAOM,MAAM,CAACC,MAAP,CAAc;IACjBf,MAAAA,aAAa,EAAbA,aADiB;IAEjBG,MAAAA,UAAU,EAAE;IAAA,eAAMQ,sBAAsB,CAACjR,YAAD,EACpC4Q,YADoC,EACtBC,YADsB,EACRC,aADQ,EACOhL,cADP,CAA5B;IAAA;IAFK,KAAd,CAAP;IAKH;IACJ;;ICjDD,IAAMwL,eAAe,GAAG;IACpBtE,EAAAA,cAAc,EAAE,6BADI;IAEpBG,EAAAA,YAAY,EAAE,eAFM;IAIpB6C,EAAAA,gBAAgB,EAAE,uBAJE;IAIuB;IAC3CuB,EAAAA,mBAAmB,EAAE,EALD;IAKK;IACzBC,EAAAA,mBAAmB,EAAE,EAND;IAMK;IAEzBvE,EAAAA,UAAU,EAAE,cARQ;IASpBO,EAAAA,eAAe,EAAE,OATG;IASM;IAC1BD,EAAAA,kBAAkB,EAAE,UAVA;IAUY;IAEhCkE,EAAAA,iBAAiB,EAAE,EAZC;IAYG;IAEvBpE,EAAAA,eAAe,EAAE,EAdG;IAepBC,EAAAA,gBAAgB,EAAE,EAfE;IAiBpB;IACAc,EAAAA,SAAS,EAAE,OAlBS;IAmBpBO,EAAAA,qBAAqB,EAAE,OAnBH;IAoBpBH,EAAAA,wBAAwB,EAAE,UApBN;IAoBkB;IAEtC;IACAkB,EAAAA,WAAW,EAAG,MAvBM;IAwBpBK,EAAAA,2BAA2B,EAAE,UAxBT;;IAAA,CAAxB;IA4BA,IAAM2B,eAAe,GAAG;IACpB;IACA7R,EAAAA,UAAU,EAAE;IAAC8R,IAAAA,YAAY,EAAE,CAAf;IAAkBC,IAAAA,MAAM,EAAE;IAA1B,GAFQ;IAGpBtF,EAAAA,kBAAkB,EAAE;IAACzS,IAAAA,eAAe,EAAE;IAAlB,GAHA;IAKpB2S,EAAAA,eAAe,EAAE;IAACqF,IAAAA,WAAW,EAAE,SAAd;IAAyBC,IAAAA,SAAS,EAAE;IAApC,GALG;IAMpBC,EAAAA,oBAAoB,EAAE;IAACD,IAAAA,SAAS,EAAE;IAAZ,GANF;IAOpBE,EAAAA,sBAAsB,EAAE;IAACF,IAAAA,SAAS,EAAE;IAAZ,GAPJ;IASpBrY,EAAAA,gBAAgB,EAAE;IAACwY,IAAAA,KAAK,EAAE;IAAU;IAAlB;IAA8CC,IAAAA,UAAU,EAAG;IAA3D,GATE;IAWpB;IACApB,EAAAA,aAAa,EAAE;IAACqB,IAAAA,SAAS,EAAE;IAAZ,GAZK;IAapBvB,EAAAA,YAAY,EAAG;IAACuB,IAAAA,SAAS,EAAE;IAAZ,GAbK;IAcpBtB,EAAAA,YAAY,EAAG;IAACsB,IAAAA,SAAS,EAAE;IAAZ,GAdK;IAgBpB;IACApE,EAAAA,SAAS,EAAE;IAACqE,IAAAA,WAAW,EAAE,KAAd;IAAqBC,IAAAA,UAAU,EAAE;IAAjC,GAjBS;IAkBpBrE,EAAAA,eAAe,EAAE;IAACsE,IAAAA,QAAQ,EAAC,OAAV;IAAmBD,IAAAA,UAAU,EAAE;IAA/B,GAlBG;IAmBpB1E,EAAAA,wBAAwB,EAAE;IAAC4E,IAAAA,OAAO,EAAE;IAAV,GAnBN;IAqBpB;IACApD,EAAAA,wBAAwB,EAAE;IAAC8C,IAAAA,KAAK,EAAE;IAAR;IAtBN,CAAxB;;IAyBA,CACI,UAAC/P,MAAD,EAASmI,CAAT,EAAe;IACX,WAASF,YAAT,CAAsBpS,OAAtB,EAA+Bya,QAA/B,EAAyClM,SAAzC,EAAmD;IAC/C,QAAIF,aAAa,GAAGiE,CAAC,CAACoI,MAAF,CAAS,EAAT,EAAaD,QAAb,CAApB,CAD+C;;IAE/C,QAAIpM,aAAa,CAACsM,kBAAlB,EACItM,aAAa,CAACsM,kBAAd,CAAiC3a,OAAjC,EAA0CqO,aAA1C;IAEJ,QAAI+K,MAAM,GAAG/K,aAAa,CAAC+K,MAA3B;IACA,QAAInL,OAAO,GAAGI,aAAa,CAACJ,OAA5B;;IACA,QAAI,CAACI,aAAa,CAACuM,OAAnB,EACA;IACI,UAAI7F,gBAAgB,GAAG1G,aAAa,CAAC0G,gBAArC;;IACA,UAAI,CAACA,gBAAL,EACA;IACI,YAAI,CAACqE,MAAL,EACA;IACIha,UAAAA,iBAAiB,CAACiP,aAAD,EAAgBsL,eAAhB,CAAjB;IACA5E,UAAAA,gBAAgB,GAAGV,gBAAgB,CAAChG,aAAD,CAAnC;IACA,cAAIwM,UAAU,GAAG9F,gBAAgB,CAACH,OAAlC;;IACAG,UAAAA,gBAAgB,CAACH,OAAjB,GAA2B,UAAC3M,YAAD,EAAkB;IACzC,gBAAIA,YAAY,CAACxH,SAAb,CAAuBoK,QAAvB,CAAgC,UAAhC,CAAJ,EAAgD;IAC5C5J,cAAAA,SAAS,CAACgH,YAAD,EAAeoG,aAAa,CAAC2L,oBAA7B,CAAT;IACH,aAFD,MAEO,IAAI/R,YAAY,CAACxH,SAAb,CAAuBoK,QAAvB,CAAgC,YAAhC,CAAJ,EAAkD;IACrD5J,cAAAA,SAAS,CAACgH,YAAD,EAAeoG,aAAa,CAAC4L,sBAA7B,CAAT;IACH,aAFM,MAEA;IACHY,cAAAA,UAAU,CAAC5S,YAAD,CAAV;IACH;IACJ,WARD;IASH;IACJ;;IACD7I,MAAAA,iBAAiB,CAACiP,aAAD,EAAgBkL,eAAhB,CAAjB;IACAtL,MAAAA,OAAO,GAAG6G,OAAO,CAACzG,aAAD,EAAgB0G,gBAAhB,CAAjB;IACH;;IAED,QAAIhH,cAAc,GAAG,IAArB;IACA,QAAIC,gBAAgB,GAAG,IAAvB;IACA,QAAIK,aAAa,CAACN,cAAlB,EACIA,cAAc,GAAGM,aAAa,CAACN,cAA/B,CADJ,KAGA;IACI,UAAI/L,aAAa,GAAG,SAAhBA,aAAgB,CAASiP,IAAT,EAAc;IAC9B,eAAO9G,MAAM,CAACM,QAAP,CAAgBzI,aAAhB,CAA8BiP,IAA9B,CAAP;IACH,OAFD;;IAGA,UAAI8C,OAAO,GAAG,SAAVA,OAAU,CAAS+G,SAAT,EAAmB;IAC7BxI,QAAAA,CAAC,CAACtS,OAAD,CAAD,CAAW+T,OAAX,CAAmB+G,SAAnB;IACH,OAFD;;IAGA,UAAIzM,aAAa,CAACuB,OAAlB,EAA0B;IACtB7B,QAAAA,cAAc,GAAGqG,kBAAkB,CAC/B/F,aAAa,CAACuB,OADiB,EAE/BvB,aAAa,CAACsC,WAFiB,EAG/BtC,aAAa,CAACuF,OAHiB,EAI/BvF,aAAa,CAACwF,UAJiB,EAK/BxF,aAAa,CAACyF,YALiB,EAM/BC,OAN+B,CAAnC;IAOA,YAAI,CAAC1F,aAAa,CAACyD,aAAnB,EACIzD,aAAa,CAACyD,aAAd,GAA8B;IAAA,iBAASzD,aAAa,CAAC4G,cAAvB,0BAA0DjV,OAAO,CAAC+a,EAAlE;IAAA,SAA9B,CATkB;;IAWtB,YAAI9S,YAAY,GAAGlI,wBAAwB,CAACC,OAAD,EAAU,IAAV,CAA3C;IACAgO,QAAAA,gBAAgB,GAAGkK,gBAAgB,CAAClW,aAAD,EAAgB,IAAhB,EAAsBhC,OAAtB,EAA+BiI,YAA/B,CAAnC;IACH,OAbD,MAeA;IACI,YAAI0L,aAAa,GAAG,IAApB;IACA,YAAIzE,gBAAgB,GAAG,IAAvB;IACA,YAAIlP,OAAO,CAACC,OAAR,IAAiB,QAArB,EACI0T,aAAa,GAAG3T,OAAhB,CADJ,KAGA;IACI2T,UAAAA,aAAa,GAAG5T,wBAAwB,CAACC,OAAD,EAAU,QAAV,CAAxC;IACA,cAAI,CAAC2T,aAAL,EACI,MAAM,4DAAN;IACJzE,UAAAA,gBAAgB,GAAGlP,OAAnB;IACH;;IAED,YAAI,CAACkP,gBAAD,IAAqBb,aAAa,CAAC4G,cAAvC,EACA;IACI,cAAI+F,UAAU,GAAG1I,CAAC,CAACqB,aAAD,CAAD,CAAiBsH,OAAjB,CAAyB,MAAI5M,aAAa,CAAC4G,cAA3C,CAAjB;IACA,cAAI+F,UAAU,CAAC3a,MAAX,GAAkB,CAAtB,EACI6O,gBAAgB,GAAI8L,UAAU,CAACzE,GAAX,CAAe,CAAf,CAApB;IACP;;IAED,YAAI,CAAClI,aAAa,CAAC6M,KAAnB,EACA;IACI,cAAIC,UAAU,GAAG7I,CAAC,CAACqB,aAAD,CAAD,CAAiBsH,OAAjB,CAAyB,aAAzB,CAAjB;;IACA,cAAIE,UAAU,CAAC9a,MAAX,IAAqB,CAAzB,EAA4B;IACxB,gBAAI+a,MAAM,GAAGD,UAAU,CAACrD,IAAX,kBAA8BnE,aAAa,CAACoH,EAA5C,SAAb;;IACA,gBAAIK,MAAM,CAAC/a,MAAP,GAAc,CAAlB,EACA;IACI,kBAAI6a,KAAK,GAAGE,MAAM,CAAC7E,GAAP,CAAW,CAAX,CAAZ;IACA,kBAAI8E,KAAK,GAAGH,KAAK,CAAClJ,YAAN,CAAmB,KAAnB,CAAZ;;IACA,kBAAIqJ,KAAK,IAAI1H,aAAa,CAACoH,EAA3B,EAA+B;IAC3B1M,gBAAAA,aAAa,CAAC6M,KAAd,GAAsBA,KAAtB;IACH;IACJ;IACJ;IACJ;;IACD,YAAII,KAAK,GAAGhJ,CAAC,CAACqB,aAAD,CAAD,CAAiBsH,OAAjB,CAAyB,MAAzB,CAAZ;IACA,YAAIjH,IAAI,GAAG,IAAX;;IACA,YAAIsH,KAAK,CAACjb,MAAN,IAAgB,CAApB,EAAuB;IACnB2T,UAAAA,IAAI,GAAGsH,KAAK,CAAC/E,GAAN,CAAU,CAAV,CAAP;IACH;;IAED,YAAI,CAAClI,aAAa,CAACsC,WAAnB,EAAgC;IAC5B,cAAI4K,SAAS,GAAGjJ,CAAC,CAACqB,aAAD,CAAD,CAAiBsH,OAAjB,CAAyB,UAAzB,CAAhB;;IAEA,cAAIM,SAAS,CAAClb,MAAV,IAAoB,CAAxB,EAA2B;IACvB,gBAAImb,QAAQ,GAAGD,SAAS,CAAChF,GAAV,CAAc,CAAd,CAAf;;IACAlI,YAAAA,aAAa,CAACsC,WAAd,GAA4B;IAAA,qBAAMgD,aAAa,CAAC3G,QAAd,IAA0BwO,QAAQ,CAACxO,QAAzC;IAAA,aAA5B;IACH,WAHD,MAGK;IACDqB,YAAAA,aAAa,CAACsC,WAAd,GAA4B;IAAA,qBAAMgD,aAAa,CAAC3G,QAApB;IAAA,aAA5B;IACH;IACJ;;IAED,YAAI,CAACqB,aAAa,CAACuF,OAAnB,EAA4B;IACxBvF,UAAAA,aAAa,CAACuF,OAAd,GAAwB,YAAU;IAC9B,gBAAIlU,KAAK,GAAC,IAAV;IACA,gBAAIiU,aAAa,CAAClT,SAAd,CAAwBoK,QAAxB,CAAiC,kBAAjC,KAAwD8I,aAAa,CAAClT,SAAd,CAAwBoK,QAAxB,CAAiC,iBAAjC,CAA5D,EACInL,KAAK,GAAC,kBAAN,CADJ,KAEK,IAAIiU,aAAa,CAAClT,SAAd,CAAwBoK,QAAxB,CAAiC,kBAAjC,KAAyD8I,aAAa,CAAClT,SAAd,CAAwBoK,QAAxB,CAAiC,iBAAjC,CAA7D,EACDnL,KAAK,GAAC,kBAAN,CADC,KAEA,IAAIwP,gBAAgB,IAAIA,gBAAgB,CAACzO,SAAjB,CAA2BoK,QAA3B,CAAoC,gBAApC,CAAxB,EACDnL,KAAK,GAAC,gBAAN,CADC,KAEA,IAAIwP,gBAAgB,IAAIA,gBAAgB,CAACzO,SAAjB,CAA2BoK,QAA3B,CAAoC,gBAApC,CAAxB,EACDnL,KAAK,GAAC,gBAAN;IACJ,mBAAOA,KAAP;IACH,WAXD;IAYH;;IACD,YAAI,CAAC2O,aAAa,CAACwF,UAAnB,EAA+B;IAC3BxF,UAAAA,aAAa,CAACwF,UAAd,GAA2B,YAC3B;IAAE,mBAAOF,aAAa,CAAClT,SAAd,CAAwBoK,QAAxB,CAAiC,UAAjC,CAAP;IAAoD,WADtD;IAEH;;IACD,YAAI,CAACwD,aAAa,CAACyF,YAAnB,EAAiC;IAC7BzF,UAAAA,aAAa,CAACyF,YAAd,GAA6B,YAC7B;IAAE,mBAAOH,aAAa,CAAClT,SAAd,CAAwBoK,QAAxB,CAAiC,YAAjC,CAAP;IAAsD,WADxD;IAEH;;IACDkD,QAAAA,cAAc,GAAG2F,qBAAqB,CAACC,aAAD,EAAgBtF,aAAa,CAACsC,WAA9B,EAClCtC,aAAa,CAACuF,OADoB,EAElCvF,aAAa,CAACwF,UAFoB,EAERxF,aAAa,CAACyF,YAFN,EAGlCC,OAHkC,EAGzBC,IAHyB,CAAtC;IAKA,YAAI,CAAC3F,aAAa,CAACyD,aAAnB,EACIzD,aAAa,CAACyD,aAAd,GAA8B;IAAA,iBAASzD,aAAa,CAAC4G,cAAvB,yBAAyD,CAAEtB,aAAa,CAACoH,EAAf,GAAmBpH,aAAa,CAACoH,EAAjC,GAAoCpH,aAAa,CAAC1C,IAAnD,EAAyDjB,WAAzD,EAAzD;IAAA,SAA9B;IAGJ,YAAI/H,YAAY,GAAG,IAAnB;IACA,YAAIiH,gBAAJ,EACIjH,YAAY,GAAGlI,wBAAwB,CAACmP,gBAAD,EAAmB,IAAnB,CAAvC;IACJlB,QAAAA,gBAAgB,GAAGkK,gBAAgB,CAAClW,aAAD,EAAgB2R,aAAhB,EAA+BzE,gBAA/B,EAAiDjH,YAAjD,CAAnC;IAEH;IACJ;IACD,QAAIkG,YAAY,GAAGyD,YAAY,CAACvD,aAAa,CAAC6M,KAAf,EAAsB7M,aAAa,CAACyD,aAApC,CAA/B;IAEA,QAAI3J,oBAAoB,GAAGkG,aAAa,CAAClG,oBAAzC;;IACA,QAAI,CAACA,oBAAL,EAA0B;IACtB,UAAIsT,2BAA2B,GAAGpN,aAAa,CAACoN,2BAAhD;;IACA,UAAI,CAACA,2BAAL,EACA;IACI,YAAI,CAACrC,MAAL,EAAY;IAAA,cACFpD,SADE,GACsD2D,eADtD,CACF3D,SADE;IAAA,cACSC,eADT,GACsD0D,eADtD,CACS1D,eADT;IAAA,cAC0BL,wBAD1B,GACsD+D,eADtD,CAC0B/D,wBAD1B;IAERxW,UAAAA,iBAAiB,CAACiP,aAAD,EAAiB;IAAC2H,YAAAA,SAAS,EAATA,SAAD;IAAYC,YAAAA,eAAe,EAAfA,eAAZ;IAA6BL,YAAAA,wBAAwB,EAAxBA;IAA7B,WAAjB,CAAjB;IACA6F,UAAAA,2BAA2B,GAAC/F,6BAA6B,CAACrH,aAAD,AAAA,CAAzD;IACH;IACJ;;IATqB,UAWhBgI,SAXgB,GAW8CkD,eAX9C,CAWhBlD,SAXgB;IAAA,UAWLO,qBAXK,GAW8C2C,eAX9C,CAWL3C,qBAXK;IAAA,UAWkBH,wBAXlB,GAW8C8C,eAX9C,CAWkB9C,wBAXlB;IAYtBrX,MAAAA,iBAAiB,CAACiP,aAAD,EAAgB;IAACgI,QAAAA,SAAS,EAATA,SAAD;IAAYO,QAAAA,qBAAqB,EAArBA,qBAAZ;IAAmCH,QAAAA,wBAAwB,EAAxBA;IAAnC,OAAhB,CAAjB;IACAtO,MAAAA,oBAAoB,GAAG+N,sBAAsB,CAAC7H,aAAD,EAAgBoN,2BAAhB,EAA6CnJ,CAA7C,CAA7C;IACH;;IAED,QAAIpE,sBAAsB,GAAGG,aAAa,CAACH,sBAA3C;;IACA,QAAI,CAACA,sBAAL,EAA4B;IACxB,UAAIwN,6BAA6B,GAAGrN,aAAa,CAACqN,6BAAlD;;IACA,UAAI,CAACtC,MAAL,EAAY;IAAA,YACHhC,wBADG,GACyBuC,eADzB,CACHvC,wBADG;IAERhY,QAAAA,iBAAiB,CAACiP,aAAD,EAAgB;IAAC+I,UAAAA,wBAAwB,EAAxBA;IAAD,SAAhB,CAAjB;IACAsE,QAAAA,6BAA6B,GAACxE,+BAA+B,CAAC7I,aAAD,AAAA,CAA7D;IACH;;IANuB,UAQlBsJ,WARkB,GAQ0B4B,eAR1B,CAQlB5B,WARkB;IAAA,UAQLK,2BARK,GAQ0BuB,eAR1B,CAQLvB,2BARK;IASxB5Y,MAAAA,iBAAiB,CAACiP,aAAD,EAAgB;IAACsJ,QAAAA,WAAW,EAAXA,WAAD;IAAcK,QAAAA,2BAA2B,EAA3BA;IAAd,OAAhB,CAAjB;IACA9J,MAAAA,sBAAsB,GAAGsJ,wBAAwB,CAACnJ,aAAD,EAAgBqN,6BAAhB,EAA+CpJ,CAA/C,CAAjD;IACH;;IAED,QAAIlE,sBAAsB,GAAG,SAAzBA,sBAAyB,CAASvF,iBAAT,EAA4B2D,YAA5B,EAA0CpI,cAA1C,EAAyD;IAClF,aAAO;IACH4Q,QAAAA,SAAS,EAAEhH,gBAAgB,CAACkB,gBADzB;IAEHyF,QAAAA,KAAK,EAAE3G,gBAAgB,CAAC/F,YAFrB;IAGHoN,QAAAA,UAAU,EAAExM,iBAHT;IAIHiI,QAAAA,KAAK,EAAEtE,YAJJ;IAKH2I,QAAAA,OAAO,EAAE/Q;IALN,OAAP;IAOH,KARD;;IASA,QAAIiI,eAAe,GAAGgC,aAAa,CAACzB,WAApC;;IACA,QAAI,CAACP,eAAL,EACA;IACI,UAAIsH,aAAJ,EACA;IACItH,QAAAA,eAAe,GAAGiG,CAAC,CAACqB,aAAD,CAAD,CAAiBR,IAAjB,CAAsB,2BAAtB,CAAlB;IACA,YAAI,CAAC9G,eAAL,EACIA,eAAe,GAAGiG,CAAC,CAACqB,aAAD,CAAD,CAAiBR,IAAjB,CAAsB,aAAtB,CAAlB;IACP,OALD,MAMK,IAAIjE,gBAAJ,EACL;IACI7C,QAAAA,eAAe,GAAGiG,CAAC,CAACpD,gBAAD,CAAD,CAAoBiE,IAApB,CAAyB,2BAAzB,CAAlB;IACA,YAAI,CAAC9G,eAAL,EACIA,eAAe,GAAGiG,CAAC,CAACpD,gBAAD,CAAD,CAAoBiE,IAApB,CAAyB,aAAzB,CAAlB;IACP;IACJ;;IAED,QAAIzM,WAAW,GAAG2H,aAAa,CAAC3H,WAAhC;;IACA,QAAI,CAACA,WAAL,EAAiB;IACbA,MAAAA,WAAW,GAAG,qBAACQ,MAAD,EAASxH,KAAT,EAAkB;IAAEwH,QAAAA,MAAM,CAAC4I,QAAP,GAAkBpQ,KAAlB;IAAyB,OAA3D;IACH;;IAED,QAAIic,YAAY,GAAIxC,kBAAkB,CAACnL,gBAAgB,CAAC/F,YAAlB,EAAgCoG,aAAhC,EAA+CN,cAA/C,CAAtC;;IAEA,QAAIO,QAAQ,GAAG,SAAXA,QAAW,GAAM;IACjBqN,MAAAA,YAAY,CAACjD,UAAb;IACAiD,MAAAA,YAAY,CAACpD,aAAb;IACH,KAHD;;IAKA,QAAIqD,WAAW,GAAG,IAAI9N,WAAJ,CACdC,cADc,EAEdrH,WAFc,EAGdsH,gBAHc,EAIdC,OAJc,EAKd9F,oBALc,EAMd+F,sBANc,EAOdC,YAPc,EAQdC,sBARc,EASd/B,eATc,EAUdgC,aAVc,EAWdC,QAXc,EAYdC,SAZc,EAadpE,MAbc,CAAlB;IAeAyR,IAAAA,WAAW,CAACC,UAAZ,GAAyBF,YAAY,CAACjD,UAAtC;IACAkD,IAAAA,WAAW,CAACE,aAAZ,GAA4BH,YAAY,CAACpD,aAAzC;IAEA,QAAIlK,aAAa,CAACnG,IAAlB,EACImG,aAAa,CAACnG,IAAd,CAAmBlI,OAAnB,EAA4B4b,WAA5B;IAEJA,IAAAA,WAAW,CAAC1T,IAAZ;IAEA,WAAO0T,WAAP;IACH;IACD,MAAIvJ,QAAQ,GAAG;IACXvR,IAAAA,OAAO,EAAEyY,eADE;IAEXtL,IAAAA,OAAO,EAAE0L;IAFE,GAAf;IAIAzH,EAAAA,oBAAoB,CAAC,eAAD,EAAkBE,YAAlB,EAAgCC,QAAhC,EAA0CC,CAA1C,CAApB;IACH,CA5PL,EA6PEnI,MA7PF,EA6PUmI,CA7PV;;;;"}